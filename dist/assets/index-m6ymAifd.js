(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const t of c.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&r(t)}).observe(document,{childList:!0,subtree:!0});function i(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(s){if(s.ep)return;s.ep=!0;const c=i(s);fetch(s.href,c)}})();function qt(u,a){fetch(u).then(i=>i.text()).then(i=>{content.innerHTML=i,a&&a()})}const _u=u=>{const a=document.querySelector(".hangUpButton"),i=document.querySelector(".contactNumber");i.innerHTML=u,a.addEventListener("click",()=>{qt("/dialer.html",aa)})},aa=()=>{const u=document.querySelectorAll(".numberButton"),a=document.getElementById("numberInput"),i=document.querySelector(".dialerCallButton");u.forEach(r=>{r.addEventListener("click",()=>{a.value+=r.innerHTML})}),i.addEventListener("click",()=>{a.value&&qt("/currentCall.html",()=>{_u(a.value)})}),chrome.commands.onCommand.addListener(r=>{console.log(`Command: ${r}`)})},pu=()=>{document.getElementById("callList"),[{number:"1234567890",date:"2024-02-19 09:30:00"},{number:"9876543210",date:"2024-02-18 15:45:00"},{number:"5555555555",date:"2024-02-17 11:20:00"}].forEach(a=>{const i=document.createElement("li");i.classList.add("callItem"),i.innerHTML=`
    <div class="number">${a.number}</div>
    <div class="date">${a.date}</div>
  `,i.addEventListener("click",()=>{const r=window.opener.document.getElementById("number");r.value=a.number})})};function vu(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}const mu="jssip",gu="JsSIP",yu="the Javascript SIP library",Tu="3.10.1",Su="https://jssip.net",Eu=["José Luis Millán <jmillan@aliax.net> (https://github.com/jmillan)","Iñaki Baz Castillo <ibc@aliax.net> (https://inakibaz.me)"],Cu="lib/JsSIP.d.ts",bu="lib-es5/JsSIP.js",Au=["sip","websocket","webrtc","node","browser","library"],Ru="MIT",wu={type:"git",url:"https://github.com/versatica/JsSIP.git"},Iu={url:"https://github.com/versatica/JsSIP/issues"},Ou={"@types/events":"^3.0.0","@types/debug":"^4.1.7",debug:"^4.3.1",events:"^3.3.0","sdp-transform":"^2.14.1"},Nu={"@babel/core":"^7.19.6","@babel/preset-env":"^7.19.4","ansi-colors":"^3.2.4",browserify:"^16.5.1",eslint:"^5.16.0","fancy-log":"^1.3.3",gulp:"^4.0.2","gulp-babel":"^8.0.0","gulp-eslint":"^5.0.0","gulp-expect-file":"^1.0.2","gulp-header":"^2.0.9","gulp-nodeunit-runner":"^0.2.2","gulp-plumber":"^1.2.1","gulp-rename":"^1.4.0","gulp-uglify-es":"^1.0.4",pegjs:"^0.7.0","vinyl-buffer":"^1.0.1","vinyl-source-stream":"^2.0.0"},ku={lint:"node npm-scripts.js lint",test:"node npm-scripts.js test",prepublish:"node npm-scripts.js prepublish",release:"node npm-scripts.js release"},ua={name:mu,title:gu,description:yu,version:Tu,homepage:Su,contributors:Eu,types:Cu,main:bu,keywords:Au,license:Ru,repository:wu,bugs:Iu,dependencies:Ou,devDependencies:Nu,scripts:ku};var Zl=ua,he={USER_AGENT:"".concat(Zl.title," ").concat(Zl.version),SIP:"sip",SIPS:"sips",causes:{CONNECTION_ERROR:"Connection Error",REQUEST_TIMEOUT:"Request Timeout",SIP_FAILURE_CODE:"SIP Failure Code",INTERNAL_ERROR:"Internal Error",BUSY:"Busy",REJECTED:"Rejected",REDIRECTED:"Redirected",UNAVAILABLE:"Unavailable",NOT_FOUND:"Not Found",ADDRESS_INCOMPLETE:"Address Incomplete",INCOMPATIBLE_SDP:"Incompatible SDP",MISSING_SDP:"Missing SDP",AUTHENTICATION_ERROR:"Authentication Error",BYE:"Terminated",WEBRTC_ERROR:"WebRTC Error",CANCELED:"Canceled",NO_ANSWER:"No Answer",EXPIRES:"Expires",NO_ACK:"No ACK",DIALOG_ERROR:"Dialog Error",USER_DENIED_MEDIA_ACCESS:"User Denied Media Access",BAD_MEDIA_DESCRIPTION:"Bad Media Description",RTP_TIMEOUT:"RTP Timeout"},SIP_ERROR_CAUSES:{REDIRECTED:[300,301,302,305,380],BUSY:[486,600],REJECTED:[403,603],NOT_FOUND:[404,604],UNAVAILABLE:[480,410,408,430],ADDRESS_INCOMPLETE:[484,424],INCOMPATIBLE_SDP:[488,606],AUTHENTICATION_ERROR:[401,407]},ACK:"ACK",BYE:"BYE",CANCEL:"CANCEL",INFO:"INFO",INVITE:"INVITE",MESSAGE:"MESSAGE",NOTIFY:"NOTIFY",OPTIONS:"OPTIONS",REGISTER:"REGISTER",REFER:"REFER",UPDATE:"UPDATE",SUBSCRIBE:"SUBSCRIBE",DTMF_TRANSPORT:{INFO:"INFO",RFC2833:"RFC2833"},REASON_PHRASE:{100:"Trying",180:"Ringing",181:"Call Is Being Forwarded",182:"Queued",183:"Session Progress",199:"Early Dialog Terminated",200:"OK",202:"Accepted",204:"No Notification",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",305:"Use Proxy",380:"Alternative Service",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",410:"Gone",412:"Conditional Request Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Unsupported URI Scheme",417:"Unknown Resource-Priority",420:"Bad Extension",421:"Extension Required",422:"Session Interval Too Small",423:"Interval Too Brief",424:"Bad Location Information",428:"Use Identity Header",429:"Provide Referrer Identity",430:"Flow Failed",433:"Anonymity Disallowed",436:"Bad Identity-Info",437:"Unsupported Certificate",438:"Invalid Identity Header",439:"First Hop Lacks Outbound Support",440:"Max-Breadth Exceeded",469:"Bad Info Package",470:"Consent Needed",478:"Unresolvable Destination",480:"Temporarily Unavailable",481:"Call/Transaction Does Not Exist",482:"Loop Detected",483:"Too Many Hops",484:"Address Incomplete",485:"Ambiguous",486:"Busy Here",487:"Request Terminated",488:"Not Acceptable Here",489:"Bad Event",491:"Request Pending",493:"Undecipherable",494:"Security Agreement Required",500:"JsSIP Internal Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Server Time-out",505:"Version Not Supported",513:"Message Too Large",580:"Precondition Failure",600:"Busy Everywhere",603:"Decline",604:"Does Not Exist Anywhere",606:"Not Acceptable"},ALLOWED_METHODS:"INVITE,ACK,CANCEL,BYE,UPDATE,MESSAGE,OPTIONS,REFER,INFO,NOTIFY",ACCEPTED_BODY_TYPES:"application/sdp, application/dtmf-relay",MAX_FORWARDS:69,SESSION_EXPIRES:90,MIN_SESSION_EXPIRES:60,CONNECTION_RECOVERY_MAX_INTERVAL:30,CONNECTION_RECOVERY_MIN_INTERVAL:2};function bn(u){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?bn=function(i){return typeof i}:bn=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},bn(u)}function Vn(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function Kn(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&Ht(u,a)}function zn(u){var a=oa();return function(){var r=Ft(u),s;if(a){var c=Ft(this).constructor;s=Reflect.construct(r,arguments,c)}else s=r.apply(this,arguments);return Du(this,s)}}function Du(u,a){return a&&(bn(a)==="object"||typeof a=="function")?a:xu(u)}function xu(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}function yt(u){var a=typeof Map=="function"?new Map:void 0;return yt=function(r){if(r===null||!Pu(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof a<"u"){if(a.has(r))return a.get(r);a.set(r,s)}function s(){return An(r,arguments,Ft(this).constructor)}return s.prototype=Object.create(r.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),Ht(s,r)},yt(u)}function An(u,a,i){return oa()?An=Reflect.construct:An=function(s,c,t){var d=[null];d.push.apply(d,c);var m=Function.bind.apply(s,d),f=new m;return t&&Ht(f,t.prototype),f},An.apply(null,arguments)}function oa(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Pu(u){return Function.toString.call(u).indexOf("[native code]")!==-1}function Ht(u,a){return Ht=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},Ht(u,a)}function Ft(u){return Ft=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},Ft(u)}var Uu=function(u){Kn(i,u);var a=zn(i);function i(r,s){var c;return Vn(this,i),c=a.call(this),c.code=1,c.name="CONFIGURATION_ERROR",c.parameter=r,c.value=s,c.message=c.value?"Invalid value ".concat(JSON.stringify(c.value),' for parameter "').concat(c.parameter,'"'):"Missing parameter: ".concat(c.parameter),c}return i}(yt(Error)),Mu=function(u){Kn(i,u);var a=zn(i);function i(r){var s;return Vn(this,i),s=a.call(this),s.code=2,s.name="INVALID_STATE_ERROR",s.status=r,s.message="Invalid status: ".concat(r),s}return i}(yt(Error)),Lu=function(u){Kn(i,u);var a=zn(i);function i(r){var s;return Vn(this,i),s=a.call(this),s.code=3,s.name="NOT_SUPPORTED_ERROR",s.message=r,s}return i}(yt(Error)),Hu=function(u){Kn(i,u);var a=zn(i);function i(r){var s;return Vn(this,i),s=a.call(this),s.code=4,s.name="NOT_READY_ERROR",s.message=r,s}return i}(yt(Error)),Xe={ConfigurationError:Uu,InvalidStateError:Mu,NotSupportedError:Lu,NotReadyError:Hu},oe={},Sr,ei;function rs(){if(ei)return Sr;ei=1;function u(c,t){if(!(c instanceof t))throw new TypeError("Cannot call a class as a function")}function a(c,t){for(var d=0;d<t.length;d++){var m=t[d];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(c,m.key,m)}}function i(c,t,d){return t&&a(c.prototype,t),d&&a(c,d),c}var r=Qe(),s=xe();return Sr=function(){i(c,null,[{key:"parse",value:function(d){if(d=s.parse(d,"Name_Addr_Header"),d!==-1)return d}}]);function c(t,d,m){if(u(this,c),!t||!(t instanceof r))throw new TypeError('missing or invalid "uri" parameter');this._uri=t,this._parameters={},this.display_name=d;for(var f in m)Object.prototype.hasOwnProperty.call(m,f)&&this.setParam(f,m[f])}return i(c,[{key:"setParam",value:function(d,m){d&&(this._parameters[d.toLowerCase()]=typeof m>"u"||m===null?null:m.toString())}},{key:"getParam",value:function(d){if(d)return this._parameters[d.toLowerCase()]}},{key:"hasParam",value:function(d){if(d)return this._parameters.hasOwnProperty(d.toLowerCase())&&!0||!1}},{key:"deleteParam",value:function(d){if(d=d.toLowerCase(),this._parameters.hasOwnProperty(d)){var m=this._parameters[d];return delete this._parameters[d],m}}},{key:"clearParams",value:function(){this._parameters={}}},{key:"clone",value:function(){return new c(this._uri.clone(),this._display_name,JSON.parse(JSON.stringify(this._parameters)))}},{key:"_quote",value:function(d){return d.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}},{key:"toString",value:function(){var d=this._display_name?'"'.concat(this._quote(this._display_name),'" '):"";d+="<".concat(this._uri.toString(),">");for(var m in this._parameters)Object.prototype.hasOwnProperty.call(this._parameters,m)&&(d+=";".concat(m),this._parameters[m]!==null&&(d+="=".concat(this._parameters[m])));return d}},{key:"uri",get:function(){return this._uri}},{key:"display_name",get:function(){return this._display_name},set:function(d){this._display_name=d===0?"0":d}}]),c}(),Sr}var Er,ti;function xe(){return ti||(ti=1,Er=function(){function u(i){return'"'+i.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var a={parse:function(r,s){var c={CRLF:p,DIGIT:v,ALPHA:g,HEXDIG:S,WSP:E,OCTET:N,DQUOTE:H,SP:U,HTAB:q,alphanum:G,reserved:z,unreserved:Y,mark:ue,escaped:Z,LWS:D,SWS:O,HCOLON:Ie,TEXT_UTF8_TRIM:qe,TEXT_UTF8char:be,UTF8_NONASCII:Q,UTF8_CONT:k,LHEX:x,token:A,token_nodot:P,separators:ht,word:Oe,STAR:et,SLASH:Ue,EQUAL:X,LPAREN:tt,RPAREN:nt,RAQUOT:je,LAQUOT:Be,COMMA:ee,SEMI:K,COLON:rt,LDQUOT:Ge,RDQUOT:We,comment:Ve,ctext:Ke,quoted_string:dt,quoted_string_clean:W,qdtext:B,quoted_pair:V,SIP_URI_noparams:J,SIP_URI:ae,uri_scheme:de,uri_scheme_sips:le,uri_scheme_sip:st,userinfo:Se,user:ds,user_unreserved:Xn,password:_s,hostport:Xt,host:Tt,hostname:Qn,domainlabel:Zn,toplabel:ps,IPv6reference:er,IPv6address:tr,h16:F,ls32:Ee,IPv4address:St,dec_octet:Et,port:vs,uri_parameters:ms,uri_parameter:nr,transport_param:gs,user_param:ys,method_param:Ts,ttl_param:Ss,maddr_param:Es,lr_param:Cs,other_param:bs,pname:As,pvalue:Rs,paramchar:Ct,param_unreserved:ws,headers:Is,header:Qt,hname:Os,hvalue:Ns,hnv_unreserved:bt,Request_Response:Na,Request_Line:ks,Request_URI:Ds,absoluteURI:rr,hier_part:xs,net_path:Ps,abs_path:Zt,opaque_part:Us,uric:At,uric_no_slash:Ms,path_segments:Ls,segment:en,param:sr,pchar:Rt,scheme:Hs,authority:Fs,srvr:$s,reg_name:qs,query:js,SIP_Version:lr,INVITEm:Bs,ACKm:Gs,OPTIONSm:Ws,BYEm:Vs,CANCELm:Ks,REGISTERm:zs,SUBSCRIBEm:Ys,NOTIFYm:Js,REFERm:Xs,Method:tn,Status_Line:Qs,Status_Code:Zs,extension_code:el,Reason_Phrase:tl,Allow_Events:ka,Call_ID:Da,Contact:xa,contact_param:nn,name_addr:lt,display_name:rn,contact_params:ir,c_p_q:nl,c_p_expires:rl,delta_seconds:it,qvalue:sl,generic_param:fe,gen_value:ll,Content_Disposition:Pa,disp_type:il,disp_param:ar,handling_param:al,Content_Encoding:Ua,Content_Length:Ma,Content_Type:La,media_type:ul,m_type:ol,discrete_type:fl,composite_type:cl,extension_token:sn,x_token:hl,m_subtype:dl,m_parameter:ur,m_value:_l,CSeq:Ha,CSeq_value:pl,Expires:Fa,Event:$a,event_type:wt,From:qa,from_param:or,tag_param:fr,Max_Forwards:ja,Min_Expires:Ba,Name_Addr_Header:Ga,Proxy_Authenticate:Wa,challenge:cr,other_challenge:vl,auth_param:It,digest_cln:ln,realm:ml,realm_value:gl,domain:yl,URI:an,nonce:Tl,nonce_value:Sl,opaque:El,stale:Cl,algorithm:bl,qop_options:Al,qop_value:un,Proxy_Require:Va,Record_Route:Ka,rec_route:on,Reason:za,reason_param:hr,reason_cause:Rl,Require:Ya,Route:Ja,route_param:fn,Subscription_State:Xa,substate_value:wl,subexp_params:dr,event_reason_value:Il,Subject:Qa,Supported:Za,To:eu,to_param:_r,Via:tu,via_param:cn,via_params:pr,via_ttl:Ol,via_maddr:Nl,via_received:kl,via_branch:Dl,response_port:xl,rport:Pl,sent_protocol:Ul,protocol_name:Ml,transport:Ll,sent_by:Hl,via_host:Fl,via_port:$l,ttl:vr,WWW_Authenticate:nu,Session_Expires:ru,s_e_expires:ql,s_e_params:mr,s_e_refresher:jl,extension_header:su,header_value:Bl,message_body:lu,uuid_URI:iu,uuid:Gl,hex4:Me,hex8:Wl,hex12:Vl,Refer_To:au,Replaces:uu,call_id:Kl,replaces_param:gr,to_tag:zl,from_tag:Yl,early_flag:Jl};if(s!==void 0){if(c[s]===void 0)throw new Error("Invalid rule name: "+u(s)+".")}else s="CRLF";var t=0,d=0,m=[];function f(e){t<d||(t>d&&(d=t,m=[]),m.push(e))}function p(){var e;return r.substr(t,2)===`\r
`?(e=`\r
`,t+=2):(e=null,f('"\\r\\n"')),e}function v(){var e;return/^[0-9]/.test(r.charAt(t))?(e=r.charAt(t),t++):(e=null,f("[0-9]")),e}function g(){var e;return/^[a-zA-Z]/.test(r.charAt(t))?(e=r.charAt(t),t++):(e=null,f("[a-zA-Z]")),e}function S(){var e;return/^[0-9a-fA-F]/.test(r.charAt(t))?(e=r.charAt(t),t++):(e=null,f("[0-9a-fA-F]")),e}function E(){var e;return e=U(),e===null&&(e=q()),e}function N(){var e;return/^[\0-\xFF]/.test(r.charAt(t))?(e=r.charAt(t),t++):(e=null,f("[\\0-\\xFF]")),e}function H(){var e;return/^["]/.test(r.charAt(t))?(e=r.charAt(t),t++):(e=null,f('["]')),e}function U(){var e;return r.charCodeAt(t)===32?(e=" ",t++):(e=null,f('" "')),e}function q(){var e;return r.charCodeAt(t)===9?(e="	",t++):(e=null,f('"\\t"')),e}function G(){var e;return/^[a-zA-Z0-9]/.test(r.charAt(t))?(e=r.charAt(t),t++):(e=null,f("[a-zA-Z0-9]")),e}function z(){var e;return r.charCodeAt(t)===59?(e=";",t++):(e=null,f('";"')),e===null&&(r.charCodeAt(t)===47?(e="/",t++):(e=null,f('"/"')),e===null&&(r.charCodeAt(t)===63?(e="?",t++):(e=null,f('"?"')),e===null&&(r.charCodeAt(t)===58?(e=":",t++):(e=null,f('":"')),e===null&&(r.charCodeAt(t)===64?(e="@",t++):(e=null,f('"@"')),e===null&&(r.charCodeAt(t)===38?(e="&",t++):(e=null,f('"&"')),e===null&&(r.charCodeAt(t)===61?(e="=",t++):(e=null,f('"="')),e===null&&(r.charCodeAt(t)===43?(e="+",t++):(e=null,f('"+"')),e===null&&(r.charCodeAt(t)===36?(e="$",t++):(e=null,f('"$"')),e===null&&(r.charCodeAt(t)===44?(e=",",t++):(e=null,f('","'))))))))))),e}function Y(){var e;return e=G(),e===null&&(e=ue()),e}function ue(){var e;return r.charCodeAt(t)===45?(e="-",t++):(e=null,f('"-"')),e===null&&(r.charCodeAt(t)===95?(e="_",t++):(e=null,f('"_"')),e===null&&(r.charCodeAt(t)===46?(e=".",t++):(e=null,f('"."')),e===null&&(r.charCodeAt(t)===33?(e="!",t++):(e=null,f('"!"')),e===null&&(r.charCodeAt(t)===126?(e="~",t++):(e=null,f('"~"')),e===null&&(r.charCodeAt(t)===42?(e="*",t++):(e=null,f('"*"')),e===null&&(r.charCodeAt(t)===39?(e="'",t++):(e=null,f(`"'"`)),e===null&&(r.charCodeAt(t)===40?(e="(",t++):(e=null,f('"("')),e===null&&(r.charCodeAt(t)===41?(e=")",t++):(e=null,f('")"')))))))))),e}function Z(){var e,n,l,o,h;return o=t,h=t,r.charCodeAt(t)===37?(e="%",t++):(e=null,f('"%"')),e!==null?(n=S(),n!==null?(l=S(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_,y){return y.join("")}(o,e)),e===null&&(t=o),e}function D(){var e,n,l,o,h,_;for(o=t,h=t,_=t,e=[],n=E();n!==null;)e.push(n),n=E();if(e!==null?(n=p(),n!==null?e=[e,n]:(e=null,t=_)):(e=null,t=_),e=e!==null?e:"",e!==null){if(l=E(),l!==null)for(n=[];l!==null;)n.push(l),l=E();else n=null;n!==null?e=[e,n]:(e=null,t=h)}else e=null,t=h;return e!==null&&(e=function(y){return" "}()),e===null&&(t=o),e}function O(){var e;return e=D(),e=e!==null?e:"",e}function Ie(){var e,n,l,o,h;for(o=t,h=t,e=[],n=U(),n===null&&(n=q());n!==null;)e.push(n),n=U(),n===null&&(n=q());return e!==null?(r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n!==null?(l=O(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_){return":"}()),e===null&&(t=o),e}function qe(){var e,n,l,o,h,_,y;if(h=t,_=t,n=be(),n!==null)for(e=[];n!==null;)e.push(n),n=be();else e=null;if(e!==null){for(n=[],y=t,l=[],o=D();o!==null;)l.push(o),o=D();for(l!==null?(o=be(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);l!==null;){for(n.push(l),y=t,l=[],o=D();o!==null;)l.push(o),o=D();l!==null?(o=be(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y)}n!==null?e=[e,n]:(e=null,t=_)}else e=null,t=_;return e!==null&&(e=function(C){return r.substring(t,C)}(h)),e===null&&(t=h),e}function be(){var e;return/^[!-~]/.test(r.charAt(t))?(e=r.charAt(t),t++):(e=null,f("[!-~]")),e===null&&(e=Q()),e}function Q(){var e;return/^[\x80-\uFFFF]/.test(r.charAt(t))?(e=r.charAt(t),t++):(e=null,f("[\\x80-\\uFFFF]")),e}function k(){var e;return/^[\x80-\xBF]/.test(r.charAt(t))?(e=r.charAt(t),t++):(e=null,f("[\\x80-\\xBF]")),e}function x(){var e;return e=v(),e===null&&(/^[a-f]/.test(r.charAt(t))?(e=r.charAt(t),t++):(e=null,f("[a-f]"))),e}function A(){var e,n,l;if(l=t,n=G(),n===null&&(r.charCodeAt(t)===45?(n="-",t++):(n=null,f('"-"')),n===null&&(r.charCodeAt(t)===46?(n=".",t++):(n=null,f('"."')),n===null&&(r.charCodeAt(t)===33?(n="!",t++):(n=null,f('"!"')),n===null&&(r.charCodeAt(t)===37?(n="%",t++):(n=null,f('"%"')),n===null&&(r.charCodeAt(t)===42?(n="*",t++):(n=null,f('"*"')),n===null&&(r.charCodeAt(t)===95?(n="_",t++):(n=null,f('"_"')),n===null&&(r.charCodeAt(t)===43?(n="+",t++):(n=null,f('"+"')),n===null&&(r.charCodeAt(t)===96?(n="`",t++):(n=null,f('"`"')),n===null&&(r.charCodeAt(t)===39?(n="'",t++):(n=null,f(`"'"`)),n===null&&(r.charCodeAt(t)===126?(n="~",t++):(n=null,f('"~"')))))))))))),n!==null)for(e=[];n!==null;)e.push(n),n=G(),n===null&&(r.charCodeAt(t)===45?(n="-",t++):(n=null,f('"-"')),n===null&&(r.charCodeAt(t)===46?(n=".",t++):(n=null,f('"."')),n===null&&(r.charCodeAt(t)===33?(n="!",t++):(n=null,f('"!"')),n===null&&(r.charCodeAt(t)===37?(n="%",t++):(n=null,f('"%"')),n===null&&(r.charCodeAt(t)===42?(n="*",t++):(n=null,f('"*"')),n===null&&(r.charCodeAt(t)===95?(n="_",t++):(n=null,f('"_"')),n===null&&(r.charCodeAt(t)===43?(n="+",t++):(n=null,f('"+"')),n===null&&(r.charCodeAt(t)===96?(n="`",t++):(n=null,f('"`"')),n===null&&(r.charCodeAt(t)===39?(n="'",t++):(n=null,f(`"'"`)),n===null&&(r.charCodeAt(t)===126?(n="~",t++):(n=null,f('"~"'))))))))))));else e=null;return e!==null&&(e=function(o){return r.substring(t,o)}(l)),e===null&&(t=l),e}function P(){var e,n,l;if(l=t,n=G(),n===null&&(r.charCodeAt(t)===45?(n="-",t++):(n=null,f('"-"')),n===null&&(r.charCodeAt(t)===33?(n="!",t++):(n=null,f('"!"')),n===null&&(r.charCodeAt(t)===37?(n="%",t++):(n=null,f('"%"')),n===null&&(r.charCodeAt(t)===42?(n="*",t++):(n=null,f('"*"')),n===null&&(r.charCodeAt(t)===95?(n="_",t++):(n=null,f('"_"')),n===null&&(r.charCodeAt(t)===43?(n="+",t++):(n=null,f('"+"')),n===null&&(r.charCodeAt(t)===96?(n="`",t++):(n=null,f('"`"')),n===null&&(r.charCodeAt(t)===39?(n="'",t++):(n=null,f(`"'"`)),n===null&&(r.charCodeAt(t)===126?(n="~",t++):(n=null,f('"~"'))))))))))),n!==null)for(e=[];n!==null;)e.push(n),n=G(),n===null&&(r.charCodeAt(t)===45?(n="-",t++):(n=null,f('"-"')),n===null&&(r.charCodeAt(t)===33?(n="!",t++):(n=null,f('"!"')),n===null&&(r.charCodeAt(t)===37?(n="%",t++):(n=null,f('"%"')),n===null&&(r.charCodeAt(t)===42?(n="*",t++):(n=null,f('"*"')),n===null&&(r.charCodeAt(t)===95?(n="_",t++):(n=null,f('"_"')),n===null&&(r.charCodeAt(t)===43?(n="+",t++):(n=null,f('"+"')),n===null&&(r.charCodeAt(t)===96?(n="`",t++):(n=null,f('"`"')),n===null&&(r.charCodeAt(t)===39?(n="'",t++):(n=null,f(`"'"`)),n===null&&(r.charCodeAt(t)===126?(n="~",t++):(n=null,f('"~"')))))))))));else e=null;return e!==null&&(e=function(o){return r.substring(t,o)}(l)),e===null&&(t=l),e}function ht(){var e;return r.charCodeAt(t)===40?(e="(",t++):(e=null,f('"("')),e===null&&(r.charCodeAt(t)===41?(e=")",t++):(e=null,f('")"')),e===null&&(r.charCodeAt(t)===60?(e="<",t++):(e=null,f('"<"')),e===null&&(r.charCodeAt(t)===62?(e=">",t++):(e=null,f('">"')),e===null&&(r.charCodeAt(t)===64?(e="@",t++):(e=null,f('"@"')),e===null&&(r.charCodeAt(t)===44?(e=",",t++):(e=null,f('","')),e===null&&(r.charCodeAt(t)===59?(e=";",t++):(e=null,f('";"')),e===null&&(r.charCodeAt(t)===58?(e=":",t++):(e=null,f('":"')),e===null&&(r.charCodeAt(t)===92?(e="\\",t++):(e=null,f('"\\\\"')),e===null&&(e=H(),e===null&&(r.charCodeAt(t)===47?(e="/",t++):(e=null,f('"/"')),e===null&&(r.charCodeAt(t)===91?(e="[",t++):(e=null,f('"["')),e===null&&(r.charCodeAt(t)===93?(e="]",t++):(e=null,f('"]"')),e===null&&(r.charCodeAt(t)===63?(e="?",t++):(e=null,f('"?"')),e===null&&(r.charCodeAt(t)===61?(e="=",t++):(e=null,f('"="')),e===null&&(r.charCodeAt(t)===123?(e="{",t++):(e=null,f('"{"')),e===null&&(r.charCodeAt(t)===125?(e="}",t++):(e=null,f('"}"')),e===null&&(e=U(),e===null&&(e=q())))))))))))))))))),e}function Oe(){var e,n,l;if(l=t,n=G(),n===null&&(r.charCodeAt(t)===45?(n="-",t++):(n=null,f('"-"')),n===null&&(r.charCodeAt(t)===46?(n=".",t++):(n=null,f('"."')),n===null&&(r.charCodeAt(t)===33?(n="!",t++):(n=null,f('"!"')),n===null&&(r.charCodeAt(t)===37?(n="%",t++):(n=null,f('"%"')),n===null&&(r.charCodeAt(t)===42?(n="*",t++):(n=null,f('"*"')),n===null&&(r.charCodeAt(t)===95?(n="_",t++):(n=null,f('"_"')),n===null&&(r.charCodeAt(t)===43?(n="+",t++):(n=null,f('"+"')),n===null&&(r.charCodeAt(t)===96?(n="`",t++):(n=null,f('"`"')),n===null&&(r.charCodeAt(t)===39?(n="'",t++):(n=null,f(`"'"`)),n===null&&(r.charCodeAt(t)===126?(n="~",t++):(n=null,f('"~"')),n===null&&(r.charCodeAt(t)===40?(n="(",t++):(n=null,f('"("')),n===null&&(r.charCodeAt(t)===41?(n=")",t++):(n=null,f('")"')),n===null&&(r.charCodeAt(t)===60?(n="<",t++):(n=null,f('"<"')),n===null&&(r.charCodeAt(t)===62?(n=">",t++):(n=null,f('">"')),n===null&&(r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n===null&&(r.charCodeAt(t)===92?(n="\\",t++):(n=null,f('"\\\\"')),n===null&&(n=H(),n===null&&(r.charCodeAt(t)===47?(n="/",t++):(n=null,f('"/"')),n===null&&(r.charCodeAt(t)===91?(n="[",t++):(n=null,f('"["')),n===null&&(r.charCodeAt(t)===93?(n="]",t++):(n=null,f('"]"')),n===null&&(r.charCodeAt(t)===63?(n="?",t++):(n=null,f('"?"')),n===null&&(r.charCodeAt(t)===123?(n="{",t++):(n=null,f('"{"')),n===null&&(r.charCodeAt(t)===125?(n="}",t++):(n=null,f('"}"'))))))))))))))))))))))))),n!==null)for(e=[];n!==null;)e.push(n),n=G(),n===null&&(r.charCodeAt(t)===45?(n="-",t++):(n=null,f('"-"')),n===null&&(r.charCodeAt(t)===46?(n=".",t++):(n=null,f('"."')),n===null&&(r.charCodeAt(t)===33?(n="!",t++):(n=null,f('"!"')),n===null&&(r.charCodeAt(t)===37?(n="%",t++):(n=null,f('"%"')),n===null&&(r.charCodeAt(t)===42?(n="*",t++):(n=null,f('"*"')),n===null&&(r.charCodeAt(t)===95?(n="_",t++):(n=null,f('"_"')),n===null&&(r.charCodeAt(t)===43?(n="+",t++):(n=null,f('"+"')),n===null&&(r.charCodeAt(t)===96?(n="`",t++):(n=null,f('"`"')),n===null&&(r.charCodeAt(t)===39?(n="'",t++):(n=null,f(`"'"`)),n===null&&(r.charCodeAt(t)===126?(n="~",t++):(n=null,f('"~"')),n===null&&(r.charCodeAt(t)===40?(n="(",t++):(n=null,f('"("')),n===null&&(r.charCodeAt(t)===41?(n=")",t++):(n=null,f('")"')),n===null&&(r.charCodeAt(t)===60?(n="<",t++):(n=null,f('"<"')),n===null&&(r.charCodeAt(t)===62?(n=">",t++):(n=null,f('">"')),n===null&&(r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n===null&&(r.charCodeAt(t)===92?(n="\\",t++):(n=null,f('"\\\\"')),n===null&&(n=H(),n===null&&(r.charCodeAt(t)===47?(n="/",t++):(n=null,f('"/"')),n===null&&(r.charCodeAt(t)===91?(n="[",t++):(n=null,f('"["')),n===null&&(r.charCodeAt(t)===93?(n="]",t++):(n=null,f('"]"')),n===null&&(r.charCodeAt(t)===63?(n="?",t++):(n=null,f('"?"')),n===null&&(r.charCodeAt(t)===123?(n="{",t++):(n=null,f('"{"')),n===null&&(r.charCodeAt(t)===125?(n="}",t++):(n=null,f('"}"')))))))))))))))))))))))));else e=null;return e!==null&&(e=function(o){return r.substring(t,o)}(l)),e===null&&(t=l),e}function et(){var e,n,l,o,h;return o=t,h=t,e=O(),e!==null?(r.charCodeAt(t)===42?(n="*",t++):(n=null,f('"*"')),n!==null?(l=O(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_){return"*"}()),e===null&&(t=o),e}function Ue(){var e,n,l,o,h;return o=t,h=t,e=O(),e!==null?(r.charCodeAt(t)===47?(n="/",t++):(n=null,f('"/"')),n!==null?(l=O(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_){return"/"}()),e===null&&(t=o),e}function X(){var e,n,l,o,h;return o=t,h=t,e=O(),e!==null?(r.charCodeAt(t)===61?(n="=",t++):(n=null,f('"="')),n!==null?(l=O(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_){return"="}()),e===null&&(t=o),e}function tt(){var e,n,l,o,h;return o=t,h=t,e=O(),e!==null?(r.charCodeAt(t)===40?(n="(",t++):(n=null,f('"("')),n!==null?(l=O(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_){return"("}()),e===null&&(t=o),e}function nt(){var e,n,l,o,h;return o=t,h=t,e=O(),e!==null?(r.charCodeAt(t)===41?(n=")",t++):(n=null,f('")"')),n!==null?(l=O(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_){return")"}()),e===null&&(t=o),e}function je(){var e,n,l,o;return l=t,o=t,r.charCodeAt(t)===62?(e=">",t++):(e=null,f('">"')),e!==null?(n=O(),n!==null?e=[e,n]:(e=null,t=o)):(e=null,t=o),e!==null&&(e=function(h){return">"}()),e===null&&(t=l),e}function Be(){var e,n,l,o;return l=t,o=t,e=O(),e!==null?(r.charCodeAt(t)===60?(n="<",t++):(n=null,f('"<"')),n!==null?e=[e,n]:(e=null,t=o)):(e=null,t=o),e!==null&&(e=function(h){return"<"}()),e===null&&(t=l),e}function ee(){var e,n,l,o,h;return o=t,h=t,e=O(),e!==null?(r.charCodeAt(t)===44?(n=",",t++):(n=null,f('","')),n!==null?(l=O(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_){return","}()),e===null&&(t=o),e}function K(){var e,n,l,o,h;return o=t,h=t,e=O(),e!==null?(r.charCodeAt(t)===59?(n=";",t++):(n=null,f('";"')),n!==null?(l=O(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_){return";"}()),e===null&&(t=o),e}function rt(){var e,n,l,o,h;return o=t,h=t,e=O(),e!==null?(r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n!==null?(l=O(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_){return":"}()),e===null&&(t=o),e}function Ge(){var e,n,l,o;return l=t,o=t,e=O(),e!==null?(n=H(),n!==null?e=[e,n]:(e=null,t=o)):(e=null,t=o),e!==null&&(e=function(h){return'"'}()),e===null&&(t=l),e}function We(){var e,n,l,o;return l=t,o=t,e=H(),e!==null?(n=O(),n!==null?e=[e,n]:(e=null,t=o)):(e=null,t=o),e!==null&&(e=function(h){return'"'}()),e===null&&(t=l),e}function Ve(){var e,n,l,o;if(o=t,e=tt(),e!==null){for(n=[],l=Ke(),l===null&&(l=V(),l===null&&(l=Ve()));l!==null;)n.push(l),l=Ke(),l===null&&(l=V(),l===null&&(l=Ve()));n!==null?(l=nt(),l!==null?e=[e,n,l]:(e=null,t=o)):(e=null,t=o)}else e=null,t=o;return e}function Ke(){var e;return/^[!-']/.test(r.charAt(t))?(e=r.charAt(t),t++):(e=null,f("[!-']")),e===null&&(/^[*-[]/.test(r.charAt(t))?(e=r.charAt(t),t++):(e=null,f("[*-[]")),e===null&&(/^[\]-~]/.test(r.charAt(t))?(e=r.charAt(t),t++):(e=null,f("[\\]-~]")),e===null&&(e=Q(),e===null&&(e=D())))),e}function dt(){var e,n,l,o,h,_;if(h=t,_=t,e=O(),e!==null)if(n=H(),n!==null){for(l=[],o=B(),o===null&&(o=V());o!==null;)l.push(o),o=B(),o===null&&(o=V());l!==null?(o=H(),o!==null?e=[e,n,l,o]:(e=null,t=_)):(e=null,t=_)}else e=null,t=_;else e=null,t=_;return e!==null&&(e=function(y){return r.substring(t,y)}(h)),e===null&&(t=h),e}function W(){var e,n,l,o,h,_;if(h=t,_=t,e=O(),e!==null)if(n=H(),n!==null){for(l=[],o=B(),o===null&&(o=V());o!==null;)l.push(o),o=B(),o===null&&(o=V());l!==null?(o=H(),o!==null?e=[e,n,l,o]:(e=null,t=_)):(e=null,t=_)}else e=null,t=_;else e=null,t=_;return e!==null&&(e=function(y){var C=r.substring(t,y).trim();return C.substring(1,C.length-1).replace(/\\([\x00-\x09\x0b-\x0c\x0e-\x7f])/g,"$1")}(h)),e===null&&(t=h),e}function B(){var e;return e=D(),e===null&&(r.charCodeAt(t)===33?(e="!",t++):(e=null,f('"!"')),e===null&&(/^[#-[]/.test(r.charAt(t))?(e=r.charAt(t),t++):(e=null,f("[#-[]")),e===null&&(/^[\]-~]/.test(r.charAt(t))?(e=r.charAt(t),t++):(e=null,f("[\\]-~]")),e===null&&(e=Q())))),e}function V(){var e,n,l;return l=t,r.charCodeAt(t)===92?(e="\\",t++):(e=null,f('"\\\\"')),e!==null?(/^[\0-\t]/.test(r.charAt(t))?(n=r.charAt(t),t++):(n=null,f("[\\0-\\t]")),n===null&&(/^[\x0B-\f]/.test(r.charAt(t))?(n=r.charAt(t),t++):(n=null,f("[\\x0B-\\f]")),n===null&&(/^[\x0E-]/.test(r.charAt(t))?(n=r.charAt(t),t++):(n=null,f("[\\x0E-]")))),n!==null?e=[e,n]:(e=null,t=l)):(e=null,t=l),e}function J(){var e,n,l,o,h,_;return h=t,_=t,e=de(),e!==null?(r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n!==null?(l=Se(),l=l!==null?l:"",l!==null?(o=Xt(),o!==null?e=[e,n,l,o]:(e=null,t=_)):(e=null,t=_)):(e=null,t=_)):(e=null,t=_),e!==null&&(e=function(y){try{T.uri=new Xl(T.scheme,T.user,T.host,T.port),delete T.scheme,delete T.user,delete T.host,delete T.host_type,delete T.port}catch{T=-1}}()),e===null&&(t=h),e}function ae(){var e,n,l,o,h,_,y,C;return y=t,C=t,e=de(),e!==null?(r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n!==null?(l=Se(),l=l!==null?l:"",l!==null?(o=Xt(),o!==null?(h=ms(),h!==null?(_=Is(),_=_!==null?_:"",_!==null?e=[e,n,l,o,h,_]:(e=null,t=C)):(e=null,t=C)):(e=null,t=C)):(e=null,t=C)):(e=null,t=C)):(e=null,t=C),e!==null&&(e=function(w){try{T.uri=new Xl(T.scheme,T.user,T.host,T.port,T.uri_params,T.uri_headers),delete T.scheme,delete T.user,delete T.host,delete T.host_type,delete T.port,delete T.uri_params,s==="SIP_URI"&&(T=T.uri)}catch{T=-1}}()),e===null&&(t=y),e}function de(){var e;return e=le(),e===null&&(e=st()),e}function le(){var e,n;return n=t,r.substr(t,4).toLowerCase()==="sips"?(e=r.substr(t,4),t+=4):(e=null,f('"sips"')),e!==null&&(e=function(l,o){T.scheme=o.toLowerCase()}(n,e)),e===null&&(t=n),e}function st(){var e,n;return n=t,r.substr(t,3).toLowerCase()==="sip"?(e=r.substr(t,3),t+=3):(e=null,f('"sip"')),e!==null&&(e=function(l,o){T.scheme=o.toLowerCase()}(n,e)),e===null&&(t=n),e}function Se(){var e,n,l,o,h,_;return o=t,h=t,e=ds(),e!==null?(_=t,r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n!==null?(l=_s(),l!==null?n=[n,l]:(n=null,t=_)):(n=null,t=_),n=n!==null?n:"",n!==null?(r.charCodeAt(t)===64?(l="@",t++):(l=null,f('"@"')),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(y){T.user=decodeURIComponent(r.substring(t-1,y))}(o)),e===null&&(t=o),e}function ds(){var e,n;if(n=Y(),n===null&&(n=Z(),n===null&&(n=Xn())),n!==null)for(e=[];n!==null;)e.push(n),n=Y(),n===null&&(n=Z(),n===null&&(n=Xn()));else e=null;return e}function Xn(){var e;return r.charCodeAt(t)===38?(e="&",t++):(e=null,f('"&"')),e===null&&(r.charCodeAt(t)===61?(e="=",t++):(e=null,f('"="')),e===null&&(r.charCodeAt(t)===43?(e="+",t++):(e=null,f('"+"')),e===null&&(r.charCodeAt(t)===36?(e="$",t++):(e=null,f('"$"')),e===null&&(r.charCodeAt(t)===44?(e=",",t++):(e=null,f('","')),e===null&&(r.charCodeAt(t)===59?(e=";",t++):(e=null,f('";"')),e===null&&(r.charCodeAt(t)===63?(e="?",t++):(e=null,f('"?"')),e===null&&(r.charCodeAt(t)===47?(e="/",t++):(e=null,f('"/"'))))))))),e}function _s(){var e,n,l;for(l=t,e=[],n=Y(),n===null&&(n=Z(),n===null&&(r.charCodeAt(t)===38?(n="&",t++):(n=null,f('"&"')),n===null&&(r.charCodeAt(t)===61?(n="=",t++):(n=null,f('"="')),n===null&&(r.charCodeAt(t)===43?(n="+",t++):(n=null,f('"+"')),n===null&&(r.charCodeAt(t)===36?(n="$",t++):(n=null,f('"$"')),n===null&&(r.charCodeAt(t)===44?(n=",",t++):(n=null,f('","'))))))));n!==null;)e.push(n),n=Y(),n===null&&(n=Z(),n===null&&(r.charCodeAt(t)===38?(n="&",t++):(n=null,f('"&"')),n===null&&(r.charCodeAt(t)===61?(n="=",t++):(n=null,f('"="')),n===null&&(r.charCodeAt(t)===43?(n="+",t++):(n=null,f('"+"')),n===null&&(r.charCodeAt(t)===36?(n="$",t++):(n=null,f('"$"')),n===null&&(r.charCodeAt(t)===44?(n=",",t++):(n=null,f('","'))))))));return e!==null&&(e=function(o){T.password=r.substring(t,o)}(l)),e===null&&(t=l),e}function Xt(){var e,n,l,o,h;return o=t,e=Tt(),e!==null?(h=t,r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n!==null?(l=vs(),l!==null?n=[n,l]:(n=null,t=h)):(n=null,t=h),n=n!==null?n:"",n!==null?e=[e,n]:(e=null,t=o)):(e=null,t=o),e}function Tt(){var e,n;return n=t,e=Qn(),e===null&&(e=St(),e===null&&(e=er())),e!==null&&(e=function(l){return T.host=r.substring(t,l).toLowerCase(),T.host}(n)),e===null&&(t=n),e}function Qn(){var e,n,l,o,h,_;for(o=t,h=t,e=[],_=t,n=Zn(),n!==null?(r.charCodeAt(t)===46?(l=".",t++):(l=null,f('"."')),l!==null?n=[n,l]:(n=null,t=_)):(n=null,t=_);n!==null;)e.push(n),_=t,n=Zn(),n!==null?(r.charCodeAt(t)===46?(l=".",t++):(l=null,f('"."')),l!==null?n=[n,l]:(n=null,t=_)):(n=null,t=_);return e!==null?(n=ps(),n!==null?(r.charCodeAt(t)===46?(l=".",t++):(l=null,f('"."')),l=l!==null?l:"",l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(y){return T.host_type="domain",r.substring(t,y)}(o)),e===null&&(t=o),e}function Zn(){var e,n,l,o;if(o=t,e=G(),e!==null){for(n=[],l=G(),l===null&&(r.charCodeAt(t)===45?(l="-",t++):(l=null,f('"-"')),l===null&&(r.charCodeAt(t)===95?(l="_",t++):(l=null,f('"_"'))));l!==null;)n.push(l),l=G(),l===null&&(r.charCodeAt(t)===45?(l="-",t++):(l=null,f('"-"')),l===null&&(r.charCodeAt(t)===95?(l="_",t++):(l=null,f('"_"'))));n!==null?e=[e,n]:(e=null,t=o)}else e=null,t=o;return e}function ps(){var e,n,l,o;if(o=t,e=g(),e!==null){for(n=[],l=G(),l===null&&(r.charCodeAt(t)===45?(l="-",t++):(l=null,f('"-"')),l===null&&(r.charCodeAt(t)===95?(l="_",t++):(l=null,f('"_"'))));l!==null;)n.push(l),l=G(),l===null&&(r.charCodeAt(t)===45?(l="-",t++):(l=null,f('"-"')),l===null&&(r.charCodeAt(t)===95?(l="_",t++):(l=null,f('"_"'))));n!==null?e=[e,n]:(e=null,t=o)}else e=null,t=o;return e}function er(){var e,n,l,o,h;return o=t,h=t,r.charCodeAt(t)===91?(e="[",t++):(e=null,f('"["')),e!==null?(n=tr(),n!==null?(r.charCodeAt(t)===93?(l="]",t++):(l=null,f('"]"')),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_){return T.host_type="IPv6",r.substring(t,_)}(o)),e===null&&(t=o),e}function tr(){var e,n,l,o,h,_,y,C,w,j,re,Ne,hn,Tr,b,$;return Tr=t,b=t,e=F(),e!==null?(r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n!==null?(l=F(),l!==null?(r.charCodeAt(t)===58?(o=":",t++):(o=null,f('":"')),o!==null?(h=F(),h!==null?(r.charCodeAt(t)===58?(_=":",t++):(_=null,f('":"')),_!==null?(y=F(),y!==null?(r.charCodeAt(t)===58?(C=":",t++):(C=null,f('":"')),C!==null?(w=F(),w!==null?(r.charCodeAt(t)===58?(j=":",t++):(j=null,f('":"')),j!==null?(re=F(),re!==null?(r.charCodeAt(t)===58?(Ne=":",t++):(Ne=null,f('":"')),Ne!==null?(hn=Ee(),hn!==null?e=[e,n,l,o,h,_,y,C,w,j,re,Ne,hn]:(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b),e===null&&(b=t,r.substr(t,2)==="::"?(e="::",t+=2):(e=null,f('"::"')),e!==null?(n=F(),n!==null?(r.charCodeAt(t)===58?(l=":",t++):(l=null,f('":"')),l!==null?(o=F(),o!==null?(r.charCodeAt(t)===58?(h=":",t++):(h=null,f('":"')),h!==null?(_=F(),_!==null?(r.charCodeAt(t)===58?(y=":",t++):(y=null,f('":"')),y!==null?(C=F(),C!==null?(r.charCodeAt(t)===58?(w=":",t++):(w=null,f('":"')),w!==null?(j=F(),j!==null?(r.charCodeAt(t)===58?(re=":",t++):(re=null,f('":"')),re!==null?(Ne=Ee(),Ne!==null?e=[e,n,l,o,h,_,y,C,w,j,re,Ne]:(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b),e===null&&(b=t,r.substr(t,2)==="::"?(e="::",t+=2):(e=null,f('"::"')),e!==null?(n=F(),n!==null?(r.charCodeAt(t)===58?(l=":",t++):(l=null,f('":"')),l!==null?(o=F(),o!==null?(r.charCodeAt(t)===58?(h=":",t++):(h=null,f('":"')),h!==null?(_=F(),_!==null?(r.charCodeAt(t)===58?(y=":",t++):(y=null,f('":"')),y!==null?(C=F(),C!==null?(r.charCodeAt(t)===58?(w=":",t++):(w=null,f('":"')),w!==null?(j=Ee(),j!==null?e=[e,n,l,o,h,_,y,C,w,j]:(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b),e===null&&(b=t,r.substr(t,2)==="::"?(e="::",t+=2):(e=null,f('"::"')),e!==null?(n=F(),n!==null?(r.charCodeAt(t)===58?(l=":",t++):(l=null,f('":"')),l!==null?(o=F(),o!==null?(r.charCodeAt(t)===58?(h=":",t++):(h=null,f('":"')),h!==null?(_=F(),_!==null?(r.charCodeAt(t)===58?(y=":",t++):(y=null,f('":"')),y!==null?(C=Ee(),C!==null?e=[e,n,l,o,h,_,y,C]:(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b),e===null&&(b=t,r.substr(t,2)==="::"?(e="::",t+=2):(e=null,f('"::"')),e!==null?(n=F(),n!==null?(r.charCodeAt(t)===58?(l=":",t++):(l=null,f('":"')),l!==null?(o=F(),o!==null?(r.charCodeAt(t)===58?(h=":",t++):(h=null,f('":"')),h!==null?(_=Ee(),_!==null?e=[e,n,l,o,h,_]:(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b),e===null&&(b=t,r.substr(t,2)==="::"?(e="::",t+=2):(e=null,f('"::"')),e!==null?(n=F(),n!==null?(r.charCodeAt(t)===58?(l=":",t++):(l=null,f('":"')),l!==null?(o=Ee(),o!==null?e=[e,n,l,o]:(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b),e===null&&(b=t,r.substr(t,2)==="::"?(e="::",t+=2):(e=null,f('"::"')),e!==null?(n=Ee(),n!==null?e=[e,n]:(e=null,t=b)):(e=null,t=b),e===null&&(b=t,r.substr(t,2)==="::"?(e="::",t+=2):(e=null,f('"::"')),e!==null?(n=F(),n!==null?e=[e,n]:(e=null,t=b)):(e=null,t=b),e===null&&(b=t,e=F(),e!==null?(r.substr(t,2)==="::"?(n="::",t+=2):(n=null,f('"::"')),n!==null?(l=F(),l!==null?(r.charCodeAt(t)===58?(o=":",t++):(o=null,f('":"')),o!==null?(h=F(),h!==null?(r.charCodeAt(t)===58?(_=":",t++):(_=null,f('":"')),_!==null?(y=F(),y!==null?(r.charCodeAt(t)===58?(C=":",t++):(C=null,f('":"')),C!==null?(w=F(),w!==null?(r.charCodeAt(t)===58?(j=":",t++):(j=null,f('":"')),j!==null?(re=Ee(),re!==null?e=[e,n,l,o,h,_,y,C,w,j,re]:(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b),e===null&&(b=t,e=F(),e!==null?($=t,r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n!==null?(l=F(),l!==null?n=[n,l]:(n=null,t=$)):(n=null,t=$),n=n!==null?n:"",n!==null?(r.substr(t,2)==="::"?(l="::",t+=2):(l=null,f('"::"')),l!==null?(o=F(),o!==null?(r.charCodeAt(t)===58?(h=":",t++):(h=null,f('":"')),h!==null?(_=F(),_!==null?(r.charCodeAt(t)===58?(y=":",t++):(y=null,f('":"')),y!==null?(C=F(),C!==null?(r.charCodeAt(t)===58?(w=":",t++):(w=null,f('":"')),w!==null?(j=Ee(),j!==null?e=[e,n,l,o,h,_,y,C,w,j]:(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b),e===null&&(b=t,e=F(),e!==null?($=t,r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n!==null?(l=F(),l!==null?n=[n,l]:(n=null,t=$)):(n=null,t=$),n=n!==null?n:"",n!==null?($=t,r.charCodeAt(t)===58?(l=":",t++):(l=null,f('":"')),l!==null?(o=F(),o!==null?l=[l,o]:(l=null,t=$)):(l=null,t=$),l=l!==null?l:"",l!==null?(r.substr(t,2)==="::"?(o="::",t+=2):(o=null,f('"::"')),o!==null?(h=F(),h!==null?(r.charCodeAt(t)===58?(_=":",t++):(_=null,f('":"')),_!==null?(y=F(),y!==null?(r.charCodeAt(t)===58?(C=":",t++):(C=null,f('":"')),C!==null?(w=Ee(),w!==null?e=[e,n,l,o,h,_,y,C,w]:(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b),e===null&&(b=t,e=F(),e!==null?($=t,r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n!==null?(l=F(),l!==null?n=[n,l]:(n=null,t=$)):(n=null,t=$),n=n!==null?n:"",n!==null?($=t,r.charCodeAt(t)===58?(l=":",t++):(l=null,f('":"')),l!==null?(o=F(),o!==null?l=[l,o]:(l=null,t=$)):(l=null,t=$),l=l!==null?l:"",l!==null?($=t,r.charCodeAt(t)===58?(o=":",t++):(o=null,f('":"')),o!==null?(h=F(),h!==null?o=[o,h]:(o=null,t=$)):(o=null,t=$),o=o!==null?o:"",o!==null?(r.substr(t,2)==="::"?(h="::",t+=2):(h=null,f('"::"')),h!==null?(_=F(),_!==null?(r.charCodeAt(t)===58?(y=":",t++):(y=null,f('":"')),y!==null?(C=Ee(),C!==null?e=[e,n,l,o,h,_,y,C]:(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b),e===null&&(b=t,e=F(),e!==null?($=t,r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n!==null?(l=F(),l!==null?n=[n,l]:(n=null,t=$)):(n=null,t=$),n=n!==null?n:"",n!==null?($=t,r.charCodeAt(t)===58?(l=":",t++):(l=null,f('":"')),l!==null?(o=F(),o!==null?l=[l,o]:(l=null,t=$)):(l=null,t=$),l=l!==null?l:"",l!==null?($=t,r.charCodeAt(t)===58?(o=":",t++):(o=null,f('":"')),o!==null?(h=F(),h!==null?o=[o,h]:(o=null,t=$)):(o=null,t=$),o=o!==null?o:"",o!==null?($=t,r.charCodeAt(t)===58?(h=":",t++):(h=null,f('":"')),h!==null?(_=F(),_!==null?h=[h,_]:(h=null,t=$)):(h=null,t=$),h=h!==null?h:"",h!==null?(r.substr(t,2)==="::"?(_="::",t+=2):(_=null,f('"::"')),_!==null?(y=Ee(),y!==null?e=[e,n,l,o,h,_,y]:(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b),e===null&&(b=t,e=F(),e!==null?($=t,r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n!==null?(l=F(),l!==null?n=[n,l]:(n=null,t=$)):(n=null,t=$),n=n!==null?n:"",n!==null?($=t,r.charCodeAt(t)===58?(l=":",t++):(l=null,f('":"')),l!==null?(o=F(),o!==null?l=[l,o]:(l=null,t=$)):(l=null,t=$),l=l!==null?l:"",l!==null?($=t,r.charCodeAt(t)===58?(o=":",t++):(o=null,f('":"')),o!==null?(h=F(),h!==null?o=[o,h]:(o=null,t=$)):(o=null,t=$),o=o!==null?o:"",o!==null?($=t,r.charCodeAt(t)===58?(h=":",t++):(h=null,f('":"')),h!==null?(_=F(),_!==null?h=[h,_]:(h=null,t=$)):(h=null,t=$),h=h!==null?h:"",h!==null?($=t,r.charCodeAt(t)===58?(_=":",t++):(_=null,f('":"')),_!==null?(y=F(),y!==null?_=[_,y]:(_=null,t=$)):(_=null,t=$),_=_!==null?_:"",_!==null?(r.substr(t,2)==="::"?(y="::",t+=2):(y=null,f('"::"')),y!==null?(C=F(),C!==null?e=[e,n,l,o,h,_,y,C]:(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b),e===null&&(b=t,e=F(),e!==null?($=t,r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n!==null?(l=F(),l!==null?n=[n,l]:(n=null,t=$)):(n=null,t=$),n=n!==null?n:"",n!==null?($=t,r.charCodeAt(t)===58?(l=":",t++):(l=null,f('":"')),l!==null?(o=F(),o!==null?l=[l,o]:(l=null,t=$)):(l=null,t=$),l=l!==null?l:"",l!==null?($=t,r.charCodeAt(t)===58?(o=":",t++):(o=null,f('":"')),o!==null?(h=F(),h!==null?o=[o,h]:(o=null,t=$)):(o=null,t=$),o=o!==null?o:"",o!==null?($=t,r.charCodeAt(t)===58?(h=":",t++):(h=null,f('":"')),h!==null?(_=F(),_!==null?h=[h,_]:(h=null,t=$)):(h=null,t=$),h=h!==null?h:"",h!==null?($=t,r.charCodeAt(t)===58?(_=":",t++):(_=null,f('":"')),_!==null?(y=F(),y!==null?_=[_,y]:(_=null,t=$)):(_=null,t=$),_=_!==null?_:"",_!==null?($=t,r.charCodeAt(t)===58?(y=":",t++):(y=null,f('":"')),y!==null?(C=F(),C!==null?y=[y,C]:(y=null,t=$)):(y=null,t=$),y=y!==null?y:"",y!==null?(r.substr(t,2)==="::"?(C="::",t+=2):(C=null,f('"::"')),C!==null?e=[e,n,l,o,h,_,y,C]:(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b)):(e=null,t=b))))))))))))))),e!==null&&(e=function(du){return T.host_type="IPv6",r.substring(t,du)}(Tr)),e===null&&(t=Tr),e}function F(){var e,n,l,o,h;return h=t,e=S(),e!==null?(n=S(),n=n!==null?n:"",n!==null?(l=S(),l=l!==null?l:"",l!==null?(o=S(),o=o!==null?o:"",o!==null?e=[e,n,l,o]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e}function Ee(){var e,n,l,o;return o=t,e=F(),e!==null?(r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n!==null?(l=F(),l!==null?e=[e,n,l]:(e=null,t=o)):(e=null,t=o)):(e=null,t=o),e===null&&(e=St()),e}function St(){var e,n,l,o,h,_,y,C,w;return C=t,w=t,e=Et(),e!==null?(r.charCodeAt(t)===46?(n=".",t++):(n=null,f('"."')),n!==null?(l=Et(),l!==null?(r.charCodeAt(t)===46?(o=".",t++):(o=null,f('"."')),o!==null?(h=Et(),h!==null?(r.charCodeAt(t)===46?(_=".",t++):(_=null,f('"."')),_!==null?(y=Et(),y!==null?e=[e,n,l,o,h,_,y]:(e=null,t=w)):(e=null,t=w)):(e=null,t=w)):(e=null,t=w)):(e=null,t=w)):(e=null,t=w)):(e=null,t=w),e!==null&&(e=function(j){return T.host_type="IPv4",r.substring(t,j)}(C)),e===null&&(t=C),e}function Et(){var e,n,l,o;return o=t,r.substr(t,2)==="25"?(e="25",t+=2):(e=null,f('"25"')),e!==null?(/^[0-5]/.test(r.charAt(t))?(n=r.charAt(t),t++):(n=null,f("[0-5]")),n!==null?e=[e,n]:(e=null,t=o)):(e=null,t=o),e===null&&(o=t,r.charCodeAt(t)===50?(e="2",t++):(e=null,f('"2"')),e!==null?(/^[0-4]/.test(r.charAt(t))?(n=r.charAt(t),t++):(n=null,f("[0-4]")),n!==null?(l=v(),l!==null?e=[e,n,l]:(e=null,t=o)):(e=null,t=o)):(e=null,t=o),e===null&&(o=t,r.charCodeAt(t)===49?(e="1",t++):(e=null,f('"1"')),e!==null?(n=v(),n!==null?(l=v(),l!==null?e=[e,n,l]:(e=null,t=o)):(e=null,t=o)):(e=null,t=o),e===null&&(o=t,/^[1-9]/.test(r.charAt(t))?(e=r.charAt(t),t++):(e=null,f("[1-9]")),e!==null?(n=v(),n!==null?e=[e,n]:(e=null,t=o)):(e=null,t=o),e===null&&(e=v())))),e}function vs(){var e,n,l,o,h,_,y;return _=t,y=t,e=v(),e=e!==null?e:"",e!==null?(n=v(),n=n!==null?n:"",n!==null?(l=v(),l=l!==null?l:"",l!==null?(o=v(),o=o!==null?o:"",o!==null?(h=v(),h=h!==null?h:"",h!==null?e=[e,n,l,o,h]:(e=null,t=y)):(e=null,t=y)):(e=null,t=y)):(e=null,t=y)):(e=null,t=y),e!==null&&(e=function(C,w){return w=parseInt(w.join("")),T.port=w,w}(_,e)),e===null&&(t=_),e}function ms(){var e,n,l,o;for(e=[],o=t,r.charCodeAt(t)===59?(n=";",t++):(n=null,f('";"')),n!==null?(l=nr(),l!==null?n=[n,l]:(n=null,t=o)):(n=null,t=o);n!==null;)e.push(n),o=t,r.charCodeAt(t)===59?(n=";",t++):(n=null,f('";"')),n!==null?(l=nr(),l!==null?n=[n,l]:(n=null,t=o)):(n=null,t=o);return e}function nr(){var e;return e=gs(),e===null&&(e=ys(),e===null&&(e=Ts(),e===null&&(e=Ss(),e===null&&(e=Es(),e===null&&(e=Cs(),e===null&&(e=bs())))))),e}function gs(){var e,n,l,o;return l=t,o=t,r.substr(t,10).toLowerCase()==="transport="?(e=r.substr(t,10),t+=10):(e=null,f('"transport="')),e!==null?(r.substr(t,3).toLowerCase()==="udp"?(n=r.substr(t,3),t+=3):(n=null,f('"udp"')),n===null&&(r.substr(t,3).toLowerCase()==="tcp"?(n=r.substr(t,3),t+=3):(n=null,f('"tcp"')),n===null&&(r.substr(t,4).toLowerCase()==="sctp"?(n=r.substr(t,4),t+=4):(n=null,f('"sctp"')),n===null&&(r.substr(t,3).toLowerCase()==="tls"?(n=r.substr(t,3),t+=3):(n=null,f('"tls"')),n===null&&(n=A())))),n!==null?e=[e,n]:(e=null,t=o)):(e=null,t=o),e!==null&&(e=function(h,_){T.uri_params||(T.uri_params={}),T.uri_params.transport=_.toLowerCase()}(l,e[1])),e===null&&(t=l),e}function ys(){var e,n,l,o;return l=t,o=t,r.substr(t,5).toLowerCase()==="user="?(e=r.substr(t,5),t+=5):(e=null,f('"user="')),e!==null?(r.substr(t,5).toLowerCase()==="phone"?(n=r.substr(t,5),t+=5):(n=null,f('"phone"')),n===null&&(r.substr(t,2).toLowerCase()==="ip"?(n=r.substr(t,2),t+=2):(n=null,f('"ip"')),n===null&&(n=A())),n!==null?e=[e,n]:(e=null,t=o)):(e=null,t=o),e!==null&&(e=function(h,_){T.uri_params||(T.uri_params={}),T.uri_params.user=_.toLowerCase()}(l,e[1])),e===null&&(t=l),e}function Ts(){var e,n,l,o;return l=t,o=t,r.substr(t,7).toLowerCase()==="method="?(e=r.substr(t,7),t+=7):(e=null,f('"method="')),e!==null?(n=tn(),n!==null?e=[e,n]:(e=null,t=o)):(e=null,t=o),e!==null&&(e=function(h,_){T.uri_params||(T.uri_params={}),T.uri_params.method=_}(l,e[1])),e===null&&(t=l),e}function Ss(){var e,n,l,o;return l=t,o=t,r.substr(t,4).toLowerCase()==="ttl="?(e=r.substr(t,4),t+=4):(e=null,f('"ttl="')),e!==null?(n=vr(),n!==null?e=[e,n]:(e=null,t=o)):(e=null,t=o),e!==null&&(e=function(h,_){T.params||(T.params={}),T.params.ttl=_}(l,e[1])),e===null&&(t=l),e}function Es(){var e,n,l,o;return l=t,o=t,r.substr(t,6).toLowerCase()==="maddr="?(e=r.substr(t,6),t+=6):(e=null,f('"maddr="')),e!==null?(n=Tt(),n!==null?e=[e,n]:(e=null,t=o)):(e=null,t=o),e!==null&&(e=function(h,_){T.uri_params||(T.uri_params={}),T.uri_params.maddr=_}(l,e[1])),e===null&&(t=l),e}function Cs(){var e,n,l,o,h,_;return o=t,h=t,r.substr(t,2).toLowerCase()==="lr"?(e=r.substr(t,2),t+=2):(e=null,f('"lr"')),e!==null?(_=t,r.charCodeAt(t)===61?(n="=",t++):(n=null,f('"="')),n!==null?(l=A(),l!==null?n=[n,l]:(n=null,t=_)):(n=null,t=_),n=n!==null?n:"",n!==null?e=[e,n]:(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(y){T.uri_params||(T.uri_params={}),T.uri_params.lr=void 0}()),e===null&&(t=o),e}function bs(){var e,n,l,o,h,_;return o=t,h=t,e=As(),e!==null?(_=t,r.charCodeAt(t)===61?(n="=",t++):(n=null,f('"="')),n!==null?(l=Rs(),l!==null?n=[n,l]:(n=null,t=_)):(n=null,t=_),n=n!==null?n:"",n!==null?e=[e,n]:(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(y,C,w){T.uri_params||(T.uri_params={}),typeof w>"u"?w=void 0:w=w[1],T.uri_params[C.toLowerCase()]=w}(o,e[0],e[1])),e===null&&(t=o),e}function As(){var e,n,l;if(l=t,n=Ct(),n!==null)for(e=[];n!==null;)e.push(n),n=Ct();else e=null;return e!==null&&(e=function(o,h){return h.join("")}(l,e)),e===null&&(t=l),e}function Rs(){var e,n,l;if(l=t,n=Ct(),n!==null)for(e=[];n!==null;)e.push(n),n=Ct();else e=null;return e!==null&&(e=function(o,h){return h.join("")}(l,e)),e===null&&(t=l),e}function Ct(){var e;return e=ws(),e===null&&(e=Y(),e===null&&(e=Z())),e}function ws(){var e;return r.charCodeAt(t)===91?(e="[",t++):(e=null,f('"["')),e===null&&(r.charCodeAt(t)===93?(e="]",t++):(e=null,f('"]"')),e===null&&(r.charCodeAt(t)===47?(e="/",t++):(e=null,f('"/"')),e===null&&(r.charCodeAt(t)===58?(e=":",t++):(e=null,f('":"')),e===null&&(r.charCodeAt(t)===38?(e="&",t++):(e=null,f('"&"')),e===null&&(r.charCodeAt(t)===43?(e="+",t++):(e=null,f('"+"')),e===null&&(r.charCodeAt(t)===36?(e="$",t++):(e=null,f('"$"')))))))),e}function Is(){var e,n,l,o,h,_,y;if(_=t,r.charCodeAt(t)===63?(e="?",t++):(e=null,f('"?"')),e!==null)if(n=Qt(),n!==null){for(l=[],y=t,r.charCodeAt(t)===38?(o="&",t++):(o=null,f('"&"')),o!==null?(h=Qt(),h!==null?o=[o,h]:(o=null,t=y)):(o=null,t=y);o!==null;)l.push(o),y=t,r.charCodeAt(t)===38?(o="&",t++):(o=null,f('"&"')),o!==null?(h=Qt(),h!==null?o=[o,h]:(o=null,t=y)):(o=null,t=y);l!==null?e=[e,n,l]:(e=null,t=_)}else e=null,t=_;else e=null,t=_;return e}function Qt(){var e,n,l,o,h;return o=t,h=t,e=Os(),e!==null?(r.charCodeAt(t)===61?(n="=",t++):(n=null,f('"="')),n!==null?(l=Ns(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_,y,C){y=y.join("").toLowerCase(),C=C.join(""),T.uri_headers||(T.uri_headers={}),T.uri_headers[y]?T.uri_headers[y].push(C):T.uri_headers[y]=[C]}(o,e[0],e[2])),e===null&&(t=o),e}function Os(){var e,n;if(n=bt(),n===null&&(n=Y(),n===null&&(n=Z())),n!==null)for(e=[];n!==null;)e.push(n),n=bt(),n===null&&(n=Y(),n===null&&(n=Z()));else e=null;return e}function Ns(){var e,n;for(e=[],n=bt(),n===null&&(n=Y(),n===null&&(n=Z()));n!==null;)e.push(n),n=bt(),n===null&&(n=Y(),n===null&&(n=Z()));return e}function bt(){var e;return r.charCodeAt(t)===91?(e="[",t++):(e=null,f('"["')),e===null&&(r.charCodeAt(t)===93?(e="]",t++):(e=null,f('"]"')),e===null&&(r.charCodeAt(t)===47?(e="/",t++):(e=null,f('"/"')),e===null&&(r.charCodeAt(t)===63?(e="?",t++):(e=null,f('"?"')),e===null&&(r.charCodeAt(t)===58?(e=":",t++):(e=null,f('":"')),e===null&&(r.charCodeAt(t)===43?(e="+",t++):(e=null,f('"+"')),e===null&&(r.charCodeAt(t)===36?(e="$",t++):(e=null,f('"$"')))))))),e}function Na(){var e;return e=Qs(),e===null&&(e=ks()),e}function ks(){var e,n,l,o,h,_;return _=t,e=tn(),e!==null?(n=U(),n!==null?(l=Ds(),l!==null?(o=U(),o!==null?(h=lr(),h!==null?e=[e,n,l,o,h]:(e=null,t=_)):(e=null,t=_)):(e=null,t=_)):(e=null,t=_)):(e=null,t=_),e}function Ds(){var e;return e=ae(),e===null&&(e=rr()),e}function rr(){var e,n,l,o;return o=t,e=Hs(),e!==null?(r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n!==null?(l=xs(),l===null&&(l=Us()),l!==null?e=[e,n,l]:(e=null,t=o)):(e=null,t=o)):(e=null,t=o),e}function xs(){var e,n,l,o,h;return o=t,e=Ps(),e===null&&(e=Zt()),e!==null?(h=t,r.charCodeAt(t)===63?(n="?",t++):(n=null,f('"?"')),n!==null?(l=js(),l!==null?n=[n,l]:(n=null,t=h)):(n=null,t=h),n=n!==null?n:"",n!==null?e=[e,n]:(e=null,t=o)):(e=null,t=o),e}function Ps(){var e,n,l,o;return o=t,r.substr(t,2)==="//"?(e="//",t+=2):(e=null,f('"//"')),e!==null?(n=Fs(),n!==null?(l=Zt(),l=l!==null?l:"",l!==null?e=[e,n,l]:(e=null,t=o)):(e=null,t=o)):(e=null,t=o),e}function Zt(){var e,n,l;return l=t,r.charCodeAt(t)===47?(e="/",t++):(e=null,f('"/"')),e!==null?(n=Ls(),n!==null?e=[e,n]:(e=null,t=l)):(e=null,t=l),e}function Us(){var e,n,l,o;if(o=t,e=Ms(),e!==null){for(n=[],l=At();l!==null;)n.push(l),l=At();n!==null?e=[e,n]:(e=null,t=o)}else e=null,t=o;return e}function At(){var e;return e=z(),e===null&&(e=Y(),e===null&&(e=Z())),e}function Ms(){var e;return e=Y(),e===null&&(e=Z(),e===null&&(r.charCodeAt(t)===59?(e=";",t++):(e=null,f('";"')),e===null&&(r.charCodeAt(t)===63?(e="?",t++):(e=null,f('"?"')),e===null&&(r.charCodeAt(t)===58?(e=":",t++):(e=null,f('":"')),e===null&&(r.charCodeAt(t)===64?(e="@",t++):(e=null,f('"@"')),e===null&&(r.charCodeAt(t)===38?(e="&",t++):(e=null,f('"&"')),e===null&&(r.charCodeAt(t)===61?(e="=",t++):(e=null,f('"="')),e===null&&(r.charCodeAt(t)===43?(e="+",t++):(e=null,f('"+"')),e===null&&(r.charCodeAt(t)===36?(e="$",t++):(e=null,f('"$"')),e===null&&(r.charCodeAt(t)===44?(e=",",t++):(e=null,f('","')))))))))))),e}function Ls(){var e,n,l,o,h,_;if(h=t,e=en(),e!==null){for(n=[],_=t,r.charCodeAt(t)===47?(l="/",t++):(l=null,f('"/"')),l!==null?(o=en(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);l!==null;)n.push(l),_=t,r.charCodeAt(t)===47?(l="/",t++):(l=null,f('"/"')),l!==null?(o=en(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);n!==null?e=[e,n]:(e=null,t=h)}else e=null,t=h;return e}function en(){var e,n,l,o,h,_;for(h=t,e=[],n=Rt();n!==null;)e.push(n),n=Rt();if(e!==null){for(n=[],_=t,r.charCodeAt(t)===59?(l=";",t++):(l=null,f('";"')),l!==null?(o=sr(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);l!==null;)n.push(l),_=t,r.charCodeAt(t)===59?(l=";",t++):(l=null,f('";"')),l!==null?(o=sr(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);n!==null?e=[e,n]:(e=null,t=h)}else e=null,t=h;return e}function sr(){var e,n;for(e=[],n=Rt();n!==null;)e.push(n),n=Rt();return e}function Rt(){var e;return e=Y(),e===null&&(e=Z(),e===null&&(r.charCodeAt(t)===58?(e=":",t++):(e=null,f('":"')),e===null&&(r.charCodeAt(t)===64?(e="@",t++):(e=null,f('"@"')),e===null&&(r.charCodeAt(t)===38?(e="&",t++):(e=null,f('"&"')),e===null&&(r.charCodeAt(t)===61?(e="=",t++):(e=null,f('"="')),e===null&&(r.charCodeAt(t)===43?(e="+",t++):(e=null,f('"+"')),e===null&&(r.charCodeAt(t)===36?(e="$",t++):(e=null,f('"$"')),e===null&&(r.charCodeAt(t)===44?(e=",",t++):(e=null,f('","')))))))))),e}function Hs(){var e,n,l,o,h;if(o=t,h=t,e=g(),e!==null){for(n=[],l=g(),l===null&&(l=v(),l===null&&(r.charCodeAt(t)===43?(l="+",t++):(l=null,f('"+"')),l===null&&(r.charCodeAt(t)===45?(l="-",t++):(l=null,f('"-"')),l===null&&(r.charCodeAt(t)===46?(l=".",t++):(l=null,f('"."'))))));l!==null;)n.push(l),l=g(),l===null&&(l=v(),l===null&&(r.charCodeAt(t)===43?(l="+",t++):(l=null,f('"+"')),l===null&&(r.charCodeAt(t)===45?(l="-",t++):(l=null,f('"-"')),l===null&&(r.charCodeAt(t)===46?(l=".",t++):(l=null,f('"."'))))));n!==null?e=[e,n]:(e=null,t=h)}else e=null,t=h;return e!==null&&(e=function(_){T.scheme=r.substring(t,_)}(o)),e===null&&(t=o),e}function Fs(){var e;return e=$s(),e===null&&(e=qs()),e}function $s(){var e,n,l,o;return l=t,o=t,e=Se(),e!==null?(r.charCodeAt(t)===64?(n="@",t++):(n=null,f('"@"')),n!==null?e=[e,n]:(e=null,t=o)):(e=null,t=o),e=e!==null?e:"",e!==null?(n=Xt(),n!==null?e=[e,n]:(e=null,t=l)):(e=null,t=l),e=e!==null?e:"",e}function qs(){var e,n;if(n=Y(),n===null&&(n=Z(),n===null&&(r.charCodeAt(t)===36?(n="$",t++):(n=null,f('"$"')),n===null&&(r.charCodeAt(t)===44?(n=",",t++):(n=null,f('","')),n===null&&(r.charCodeAt(t)===59?(n=";",t++):(n=null,f('";"')),n===null&&(r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n===null&&(r.charCodeAt(t)===64?(n="@",t++):(n=null,f('"@"')),n===null&&(r.charCodeAt(t)===38?(n="&",t++):(n=null,f('"&"')),n===null&&(r.charCodeAt(t)===61?(n="=",t++):(n=null,f('"="')),n===null&&(r.charCodeAt(t)===43?(n="+",t++):(n=null,f('"+"'))))))))))),n!==null)for(e=[];n!==null;)e.push(n),n=Y(),n===null&&(n=Z(),n===null&&(r.charCodeAt(t)===36?(n="$",t++):(n=null,f('"$"')),n===null&&(r.charCodeAt(t)===44?(n=",",t++):(n=null,f('","')),n===null&&(r.charCodeAt(t)===59?(n=";",t++):(n=null,f('";"')),n===null&&(r.charCodeAt(t)===58?(n=":",t++):(n=null,f('":"')),n===null&&(r.charCodeAt(t)===64?(n="@",t++):(n=null,f('"@"')),n===null&&(r.charCodeAt(t)===38?(n="&",t++):(n=null,f('"&"')),n===null&&(r.charCodeAt(t)===61?(n="=",t++):(n=null,f('"="')),n===null&&(r.charCodeAt(t)===43?(n="+",t++):(n=null,f('"+"')))))))))));else e=null;return e}function js(){var e,n;for(e=[],n=At();n!==null;)e.push(n),n=At();return e}function lr(){var e,n,l,o,h,_,y,C;if(y=t,C=t,r.substr(t,3).toLowerCase()==="sip"?(e=r.substr(t,3),t+=3):(e=null,f('"SIP"')),e!==null)if(r.charCodeAt(t)===47?(n="/",t++):(n=null,f('"/"')),n!==null){if(o=v(),o!==null)for(l=[];o!==null;)l.push(o),o=v();else l=null;if(l!==null)if(r.charCodeAt(t)===46?(o=".",t++):(o=null,f('"."')),o!==null){if(_=v(),_!==null)for(h=[];_!==null;)h.push(_),_=v();else h=null;h!==null?e=[e,n,l,o,h]:(e=null,t=C)}else e=null,t=C;else e=null,t=C}else e=null,t=C;else e=null,t=C;return e!==null&&(e=function(w){T.sip_version=r.substring(t,w)}(y)),e===null&&(t=y),e}function Bs(){var e;return r.substr(t,6)==="INVITE"?(e="INVITE",t+=6):(e=null,f('"INVITE"')),e}function Gs(){var e;return r.substr(t,3)==="ACK"?(e="ACK",t+=3):(e=null,f('"ACK"')),e}function Ws(){var e;return r.substr(t,7)==="OPTIONS"?(e="OPTIONS",t+=7):(e=null,f('"OPTIONS"')),e}function Vs(){var e;return r.substr(t,3)==="BYE"?(e="BYE",t+=3):(e=null,f('"BYE"')),e}function Ks(){var e;return r.substr(t,6)==="CANCEL"?(e="CANCEL",t+=6):(e=null,f('"CANCEL"')),e}function zs(){var e;return r.substr(t,8)==="REGISTER"?(e="REGISTER",t+=8):(e=null,f('"REGISTER"')),e}function Ys(){var e;return r.substr(t,9)==="SUBSCRIBE"?(e="SUBSCRIBE",t+=9):(e=null,f('"SUBSCRIBE"')),e}function Js(){var e;return r.substr(t,6)==="NOTIFY"?(e="NOTIFY",t+=6):(e=null,f('"NOTIFY"')),e}function Xs(){var e;return r.substr(t,5)==="REFER"?(e="REFER",t+=5):(e=null,f('"REFER"')),e}function tn(){var e,n;return n=t,e=Bs(),e===null&&(e=Gs(),e===null&&(e=Ws(),e===null&&(e=Vs(),e===null&&(e=Ks(),e===null&&(e=zs(),e===null&&(e=Ys(),e===null&&(e=Js(),e===null&&(e=Xs(),e===null&&(e=A()))))))))),e!==null&&(e=function(l){return T.method=r.substring(t,l),T.method}(n)),e===null&&(t=n),e}function Qs(){var e,n,l,o,h,_;return _=t,e=lr(),e!==null?(n=U(),n!==null?(l=Zs(),l!==null?(o=U(),o!==null?(h=tl(),h!==null?e=[e,n,l,o,h]:(e=null,t=_)):(e=null,t=_)):(e=null,t=_)):(e=null,t=_)):(e=null,t=_),e}function Zs(){var e,n;return n=t,e=el(),e!==null&&(e=function(l,o){T.status_code=parseInt(o.join(""))}(n,e)),e===null&&(t=n),e}function el(){var e,n,l,o;return o=t,e=v(),e!==null?(n=v(),n!==null?(l=v(),l!==null?e=[e,n,l]:(e=null,t=o)):(e=null,t=o)):(e=null,t=o),e}function tl(){var e,n,l;for(l=t,e=[],n=z(),n===null&&(n=Y(),n===null&&(n=Z(),n===null&&(n=Q(),n===null&&(n=k(),n===null&&(n=U(),n===null&&(n=q()))))));n!==null;)e.push(n),n=z(),n===null&&(n=Y(),n===null&&(n=Z(),n===null&&(n=Q(),n===null&&(n=k(),n===null&&(n=U(),n===null&&(n=q()))))));return e!==null&&(e=function(o){T.reason_phrase=r.substring(t,o)}(l)),e===null&&(t=l),e}function ka(){var e,n,l,o,h,_;if(h=t,e=wt(),e!==null){for(n=[],_=t,l=ee(),l!==null?(o=wt(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);l!==null;)n.push(l),_=t,l=ee(),l!==null?(o=wt(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);n!==null?e=[e,n]:(e=null,t=h)}else e=null,t=h;return e}function Da(){var e,n,l,o,h,_;return o=t,h=t,e=Oe(),e!==null?(_=t,r.charCodeAt(t)===64?(n="@",t++):(n=null,f('"@"')),n!==null?(l=Oe(),l!==null?n=[n,l]:(n=null,t=_)):(n=null,t=_),n=n!==null?n:"",n!==null?e=[e,n]:(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(y){T=r.substring(t,y)}(o)),e===null&&(t=o),e}function xa(){var e,n,l,o,h,_,y;if(h=t,e=et(),e===null)if(_=t,e=nn(),e!==null){for(n=[],y=t,l=ee(),l!==null?(o=nn(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);l!==null;)n.push(l),y=t,l=ee(),l!==null?(o=nn(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);n!==null?e=[e,n]:(e=null,t=_)}else e=null,t=_;return e!==null&&(e=function(C){var w,j;for(j=T.multi_header.length,w=0;w<j;w++)if(T.multi_header[w].parsed===null){T=null;break}T!==null?T=T.multi_header:T=-1}()),e===null&&(t=h),e}function nn(){var e,n,l,o,h,_,y;if(h=t,_=t,e=J(),e===null&&(e=lt()),e!==null){for(n=[],y=t,l=K(),l!==null?(o=ir(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);l!==null;)n.push(l),y=t,l=K(),l!==null?(o=ir(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);n!==null?e=[e,n]:(e=null,t=_)}else e=null,t=_;return e!==null&&(e=function(C){var w;T.multi_header||(T.multi_header=[]);try{w=new _t(T.uri,T.display_name,T.params),delete T.uri,delete T.display_name,delete T.params}catch{w=null}T.multi_header.push({possition:t,offset:C,parsed:w})}(h)),e===null&&(t=h),e}function lt(){var e,n,l,o,h;return h=t,e=rn(),e=e!==null?e:"",e!==null?(n=Be(),n!==null?(l=ae(),l!==null?(o=je(),o!==null?e=[e,n,l,o]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e}function rn(){var e,n,l,o,h,_,y;if(h=t,_=t,e=A(),e!==null){for(n=[],y=t,l=D(),l!==null?(o=A(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);l!==null;)n.push(l),y=t,l=D(),l!==null?(o=A(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);n!==null?e=[e,n]:(e=null,t=_)}else e=null,t=_;return e===null&&(e=W()),e!==null&&(e=function(C,w){typeof w=="string"?T.display_name=w:T.display_name=w[1].reduce(function(j,re){return j+re[0]+re[1]},w[0])}(h,e)),e===null&&(t=h),e}function ir(){var e;return e=nl(),e===null&&(e=rl(),e===null&&(e=fe())),e}function nl(){var e,n,l,o,h;return o=t,h=t,r.substr(t,1).toLowerCase()==="q"?(e=r.substr(t,1),t++):(e=null,f('"q"')),e!==null?(n=X(),n!==null?(l=sl(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_,y){T.params||(T.params={}),T.params.q=y}(o,e[2])),e===null&&(t=o),e}function rl(){var e,n,l,o,h;return o=t,h=t,r.substr(t,7).toLowerCase()==="expires"?(e=r.substr(t,7),t+=7):(e=null,f('"expires"')),e!==null?(n=X(),n!==null?(l=it(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_,y){T.params||(T.params={}),T.params.expires=y}(o,e[2])),e===null&&(t=o),e}function it(){var e,n,l;if(l=t,n=v(),n!==null)for(e=[];n!==null;)e.push(n),n=v();else e=null;return e!==null&&(e=function(o,h){return parseInt(h.join(""))}(l,e)),e===null&&(t=l),e}function sl(){var e,n,l,o,h,_,y,C;return _=t,y=t,r.charCodeAt(t)===48?(e="0",t++):(e=null,f('"0"')),e!==null?(C=t,r.charCodeAt(t)===46?(n=".",t++):(n=null,f('"."')),n!==null?(l=v(),l=l!==null?l:"",l!==null?(o=v(),o=o!==null?o:"",o!==null?(h=v(),h=h!==null?h:"",h!==null?n=[n,l,o,h]:(n=null,t=C)):(n=null,t=C)):(n=null,t=C)):(n=null,t=C),n=n!==null?n:"",n!==null?e=[e,n]:(e=null,t=y)):(e=null,t=y),e!==null&&(e=function(w){return parseFloat(r.substring(t,w))}(_)),e===null&&(t=_),e}function fe(){var e,n,l,o,h,_;return o=t,h=t,e=A(),e!==null?(_=t,n=X(),n!==null?(l=ll(),l!==null?n=[n,l]:(n=null,t=_)):(n=null,t=_),n=n!==null?n:"",n!==null?e=[e,n]:(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(y,C,w){T.params||(T.params={}),typeof w>"u"?w=void 0:w=w[1],T.params[C.toLowerCase()]=w}(o,e[0],e[1])),e===null&&(t=o),e}function ll(){var e;return e=A(),e===null&&(e=Tt(),e===null&&(e=dt())),e}function Pa(){var e,n,l,o,h,_;if(h=t,e=il(),e!==null){for(n=[],_=t,l=K(),l!==null?(o=ar(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);l!==null;)n.push(l),_=t,l=K(),l!==null?(o=ar(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);n!==null?e=[e,n]:(e=null,t=h)}else e=null,t=h;return e}function il(){var e;return r.substr(t,6).toLowerCase()==="render"?(e=r.substr(t,6),t+=6):(e=null,f('"render"')),e===null&&(r.substr(t,7).toLowerCase()==="session"?(e=r.substr(t,7),t+=7):(e=null,f('"session"')),e===null&&(r.substr(t,4).toLowerCase()==="icon"?(e=r.substr(t,4),t+=4):(e=null,f('"icon"')),e===null&&(r.substr(t,5).toLowerCase()==="alert"?(e=r.substr(t,5),t+=5):(e=null,f('"alert"')),e===null&&(e=A())))),e}function ar(){var e;return e=al(),e===null&&(e=fe()),e}function al(){var e,n,l,o;return o=t,r.substr(t,8).toLowerCase()==="handling"?(e=r.substr(t,8),t+=8):(e=null,f('"handling"')),e!==null?(n=X(),n!==null?(r.substr(t,8).toLowerCase()==="optional"?(l=r.substr(t,8),t+=8):(l=null,f('"optional"')),l===null&&(r.substr(t,8).toLowerCase()==="required"?(l=r.substr(t,8),t+=8):(l=null,f('"required"')),l===null&&(l=A())),l!==null?e=[e,n,l]:(e=null,t=o)):(e=null,t=o)):(e=null,t=o),e}function Ua(){var e,n,l,o,h,_;if(h=t,e=A(),e!==null){for(n=[],_=t,l=ee(),l!==null?(o=A(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);l!==null;)n.push(l),_=t,l=ee(),l!==null?(o=A(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);n!==null?e=[e,n]:(e=null,t=h)}else e=null,t=h;return e}function Ma(){var e,n,l;if(l=t,n=v(),n!==null)for(e=[];n!==null;)e.push(n),n=v();else e=null;return e!==null&&(e=function(o,h){T=parseInt(h.join(""))}(l,e)),e===null&&(t=l),e}function La(){var e,n;return n=t,e=ul(),e!==null&&(e=function(l){T=r.substring(t,l)}(n)),e===null&&(t=n),e}function ul(){var e,n,l,o,h,_,y,C;if(y=t,e=ol(),e!==null)if(n=Ue(),n!==null)if(l=dl(),l!==null){for(o=[],C=t,h=K(),h!==null?(_=ur(),_!==null?h=[h,_]:(h=null,t=C)):(h=null,t=C);h!==null;)o.push(h),C=t,h=K(),h!==null?(_=ur(),_!==null?h=[h,_]:(h=null,t=C)):(h=null,t=C);o!==null?e=[e,n,l,o]:(e=null,t=y)}else e=null,t=y;else e=null,t=y;else e=null,t=y;return e}function ol(){var e;return e=fl(),e===null&&(e=cl()),e}function fl(){var e;return r.substr(t,4).toLowerCase()==="text"?(e=r.substr(t,4),t+=4):(e=null,f('"text"')),e===null&&(r.substr(t,5).toLowerCase()==="image"?(e=r.substr(t,5),t+=5):(e=null,f('"image"')),e===null&&(r.substr(t,5).toLowerCase()==="audio"?(e=r.substr(t,5),t+=5):(e=null,f('"audio"')),e===null&&(r.substr(t,5).toLowerCase()==="video"?(e=r.substr(t,5),t+=5):(e=null,f('"video"')),e===null&&(r.substr(t,11).toLowerCase()==="application"?(e=r.substr(t,11),t+=11):(e=null,f('"application"')),e===null&&(e=sn()))))),e}function cl(){var e;return r.substr(t,7).toLowerCase()==="message"?(e=r.substr(t,7),t+=7):(e=null,f('"message"')),e===null&&(r.substr(t,9).toLowerCase()==="multipart"?(e=r.substr(t,9),t+=9):(e=null,f('"multipart"')),e===null&&(e=sn())),e}function sn(){var e;return e=A(),e===null&&(e=hl()),e}function hl(){var e,n,l;return l=t,r.substr(t,2).toLowerCase()==="x-"?(e=r.substr(t,2),t+=2):(e=null,f('"x-"')),e!==null?(n=A(),n!==null?e=[e,n]:(e=null,t=l)):(e=null,t=l),e}function dl(){var e;return e=sn(),e===null&&(e=A()),e}function ur(){var e,n,l,o;return o=t,e=A(),e!==null?(n=X(),n!==null?(l=_l(),l!==null?e=[e,n,l]:(e=null,t=o)):(e=null,t=o)):(e=null,t=o),e}function _l(){var e;return e=A(),e===null&&(e=dt()),e}function Ha(){var e,n,l,o;return o=t,e=pl(),e!==null?(n=D(),n!==null?(l=tn(),l!==null?e=[e,n,l]:(e=null,t=o)):(e=null,t=o)):(e=null,t=o),e}function pl(){var e,n,l;if(l=t,n=v(),n!==null)for(e=[];n!==null;)e.push(n),n=v();else e=null;return e!==null&&(e=function(o,h){T.value=parseInt(h.join(""))}(l,e)),e===null&&(t=l),e}function Fa(){var e,n;return n=t,e=it(),e!==null&&(e=function(l,o){T=o}(n,e)),e===null&&(t=n),e}function $a(){var e,n,l,o,h,_,y;if(h=t,_=t,e=wt(),e!==null){for(n=[],y=t,l=K(),l!==null?(o=fe(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);l!==null;)n.push(l),y=t,l=K(),l!==null?(o=fe(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);n!==null?e=[e,n]:(e=null,t=_)}else e=null,t=_;return e!==null&&(e=function(C,w){T.event=w.join("").toLowerCase()}(h,e[0])),e===null&&(t=h),e}function wt(){var e,n,l,o,h,_;if(h=t,e=P(),e!==null){for(n=[],_=t,r.charCodeAt(t)===46?(l=".",t++):(l=null,f('"."')),l!==null?(o=P(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);l!==null;)n.push(l),_=t,r.charCodeAt(t)===46?(l=".",t++):(l=null,f('"."')),l!==null?(o=P(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);n!==null?e=[e,n]:(e=null,t=h)}else e=null,t=h;return e}function qa(){var e,n,l,o,h,_,y;if(h=t,_=t,e=J(),e===null&&(e=lt()),e!==null){for(n=[],y=t,l=K(),l!==null?(o=or(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);l!==null;)n.push(l),y=t,l=K(),l!==null?(o=or(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);n!==null?e=[e,n]:(e=null,t=_)}else e=null,t=_;return e!==null&&(e=function(C){var w=T.tag;try{T=new _t(T.uri,T.display_name,T.params),w&&T.setParam("tag",w)}catch{T=-1}}()),e===null&&(t=h),e}function or(){var e;return e=fr(),e===null&&(e=fe()),e}function fr(){var e,n,l,o,h;return o=t,h=t,r.substr(t,3).toLowerCase()==="tag"?(e=r.substr(t,3),t+=3):(e=null,f('"tag"')),e!==null?(n=X(),n!==null?(l=A(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_,y){T.tag=y}(o,e[2])),e===null&&(t=o),e}function ja(){var e,n,l;if(l=t,n=v(),n!==null)for(e=[];n!==null;)e.push(n),n=v();else e=null;return e!==null&&(e=function(o,h){T=parseInt(h.join(""))}(l,e)),e===null&&(t=l),e}function Ba(){var e,n;return n=t,e=it(),e!==null&&(e=function(l,o){T=o}(n,e)),e===null&&(t=n),e}function Ga(){var e,n,l,o,h,_,y,C,w,j;for(C=t,w=t,e=[],n=rn();n!==null;)e.push(n),n=rn();if(e!==null)if(n=Be(),n!==null)if(l=ae(),l!==null)if(o=je(),o!==null){for(h=[],j=t,_=K(),_!==null?(y=fe(),y!==null?_=[_,y]:(_=null,t=j)):(_=null,t=j);_!==null;)h.push(_),j=t,_=K(),_!==null?(y=fe(),y!==null?_=[_,y]:(_=null,t=j)):(_=null,t=j);h!==null?e=[e,n,l,o,h]:(e=null,t=w)}else e=null,t=w;else e=null,t=w;else e=null,t=w;else e=null,t=w;return e!==null&&(e=function(re){try{T=new _t(T.uri,T.display_name,T.params)}catch{T=-1}}()),e===null&&(t=C),e}function Wa(){var e;return e=cr(),e}function cr(){var e,n,l,o,h,_,y,C;if(y=t,r.substr(t,6).toLowerCase()==="digest"?(e=r.substr(t,6),t+=6):(e=null,f('"Digest"')),e!==null)if(n=D(),n!==null)if(l=ln(),l!==null){for(o=[],C=t,h=ee(),h!==null?(_=ln(),_!==null?h=[h,_]:(h=null,t=C)):(h=null,t=C);h!==null;)o.push(h),C=t,h=ee(),h!==null?(_=ln(),_!==null?h=[h,_]:(h=null,t=C)):(h=null,t=C);o!==null?e=[e,n,l,o]:(e=null,t=y)}else e=null,t=y;else e=null,t=y;else e=null,t=y;return e===null&&(e=vl()),e}function vl(){var e,n,l,o,h,_,y,C;if(y=t,e=A(),e!==null)if(n=D(),n!==null)if(l=It(),l!==null){for(o=[],C=t,h=ee(),h!==null?(_=It(),_!==null?h=[h,_]:(h=null,t=C)):(h=null,t=C);h!==null;)o.push(h),C=t,h=ee(),h!==null?(_=It(),_!==null?h=[h,_]:(h=null,t=C)):(h=null,t=C);o!==null?e=[e,n,l,o]:(e=null,t=y)}else e=null,t=y;else e=null,t=y;else e=null,t=y;return e}function It(){var e,n,l,o;return o=t,e=A(),e!==null?(n=X(),n!==null?(l=A(),l===null&&(l=dt()),l!==null?e=[e,n,l]:(e=null,t=o)):(e=null,t=o)):(e=null,t=o),e}function ln(){var e;return e=ml(),e===null&&(e=yl(),e===null&&(e=Tl(),e===null&&(e=El(),e===null&&(e=Cl(),e===null&&(e=bl(),e===null&&(e=Al(),e===null&&(e=It()))))))),e}function ml(){var e,n,l,o;return o=t,r.substr(t,5).toLowerCase()==="realm"?(e=r.substr(t,5),t+=5):(e=null,f('"realm"')),e!==null?(n=X(),n!==null?(l=gl(),l!==null?e=[e,n,l]:(e=null,t=o)):(e=null,t=o)):(e=null,t=o),e}function gl(){var e,n;return n=t,e=W(),e!==null&&(e=function(l,o){T.realm=o}(n,e)),e===null&&(t=n),e}function yl(){var e,n,l,o,h,_,y,C,w;if(C=t,r.substr(t,6).toLowerCase()==="domain"?(e=r.substr(t,6),t+=6):(e=null,f('"domain"')),e!==null)if(n=X(),n!==null)if(l=Ge(),l!==null)if(o=an(),o!==null){if(h=[],w=t,y=U(),y!==null)for(_=[];y!==null;)_.push(y),y=U();else _=null;for(_!==null?(y=an(),y!==null?_=[_,y]:(_=null,t=w)):(_=null,t=w);_!==null;){if(h.push(_),w=t,y=U(),y!==null)for(_=[];y!==null;)_.push(y),y=U();else _=null;_!==null?(y=an(),y!==null?_=[_,y]:(_=null,t=w)):(_=null,t=w)}h!==null?(_=We(),_!==null?e=[e,n,l,o,h,_]:(e=null,t=C)):(e=null,t=C)}else e=null,t=C;else e=null,t=C;else e=null,t=C;else e=null,t=C;return e}function an(){var e;return e=rr(),e===null&&(e=Zt()),e}function Tl(){var e,n,l,o;return o=t,r.substr(t,5).toLowerCase()==="nonce"?(e=r.substr(t,5),t+=5):(e=null,f('"nonce"')),e!==null?(n=X(),n!==null?(l=Sl(),l!==null?e=[e,n,l]:(e=null,t=o)):(e=null,t=o)):(e=null,t=o),e}function Sl(){var e,n;return n=t,e=W(),e!==null&&(e=function(l,o){T.nonce=o}(n,e)),e===null&&(t=n),e}function El(){var e,n,l,o,h;return o=t,h=t,r.substr(t,6).toLowerCase()==="opaque"?(e=r.substr(t,6),t+=6):(e=null,f('"opaque"')),e!==null?(n=X(),n!==null?(l=W(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_,y){T.opaque=y}(o,e[2])),e===null&&(t=o),e}function Cl(){var e,n,l,o,h;return o=t,r.substr(t,5).toLowerCase()==="stale"?(e=r.substr(t,5),t+=5):(e=null,f('"stale"')),e!==null?(n=X(),n!==null?(h=t,r.substr(t,4).toLowerCase()==="true"?(l=r.substr(t,4),t+=4):(l=null,f('"true"')),l!==null&&(l=function(_){T.stale=!0}()),l===null&&(t=h),l===null&&(h=t,r.substr(t,5).toLowerCase()==="false"?(l=r.substr(t,5),t+=5):(l=null,f('"false"')),l!==null&&(l=function(_){T.stale=!1}()),l===null&&(t=h)),l!==null?e=[e,n,l]:(e=null,t=o)):(e=null,t=o)):(e=null,t=o),e}function bl(){var e,n,l,o,h;return o=t,h=t,r.substr(t,9).toLowerCase()==="algorithm"?(e=r.substr(t,9),t+=9):(e=null,f('"algorithm"')),e!==null?(n=X(),n!==null?(r.substr(t,3).toLowerCase()==="md5"?(l=r.substr(t,3),t+=3):(l=null,f('"MD5"')),l===null&&(r.substr(t,8).toLowerCase()==="md5-sess"?(l=r.substr(t,8),t+=8):(l=null,f('"MD5-sess"')),l===null&&(l=A())),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_,y){T.algorithm=y.toUpperCase()}(o,e[2])),e===null&&(t=o),e}function Al(){var e,n,l,o,h,_,y,C,w,j;if(C=t,r.substr(t,3).toLowerCase()==="qop"?(e=r.substr(t,3),t+=3):(e=null,f('"qop"')),e!==null)if(n=X(),n!==null)if(l=Ge(),l!==null){if(w=t,o=un(),o!==null){for(h=[],j=t,r.charCodeAt(t)===44?(_=",",t++):(_=null,f('","')),_!==null?(y=un(),y!==null?_=[_,y]:(_=null,t=j)):(_=null,t=j);_!==null;)h.push(_),j=t,r.charCodeAt(t)===44?(_=",",t++):(_=null,f('","')),_!==null?(y=un(),y!==null?_=[_,y]:(_=null,t=j)):(_=null,t=j);h!==null?o=[o,h]:(o=null,t=w)}else o=null,t=w;o!==null?(h=We(),h!==null?e=[e,n,l,o,h]:(e=null,t=C)):(e=null,t=C)}else e=null,t=C;else e=null,t=C;else e=null,t=C;return e}function un(){var e,n;return n=t,r.substr(t,8).toLowerCase()==="auth-int"?(e=r.substr(t,8),t+=8):(e=null,f('"auth-int"')),e===null&&(r.substr(t,4).toLowerCase()==="auth"?(e=r.substr(t,4),t+=4):(e=null,f('"auth"')),e===null&&(e=A())),e!==null&&(e=function(l,o){T.qop||(T.qop=[]),T.qop.push(o.toLowerCase())}(n,e)),e===null&&(t=n),e}function Va(){var e,n,l,o,h,_;if(h=t,e=A(),e!==null){for(n=[],_=t,l=ee(),l!==null?(o=A(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);l!==null;)n.push(l),_=t,l=ee(),l!==null?(o=A(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);n!==null?e=[e,n]:(e=null,t=h)}else e=null,t=h;return e}function Ka(){var e,n,l,o,h,_,y;if(h=t,_=t,e=on(),e!==null){for(n=[],y=t,l=ee(),l!==null?(o=on(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);l!==null;)n.push(l),y=t,l=ee(),l!==null?(o=on(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);n!==null?e=[e,n]:(e=null,t=_)}else e=null,t=_;return e!==null&&(e=function(C){var w,j;for(j=T.multi_header.length,w=0;w<j;w++)if(T.multi_header[w].parsed===null){T=null;break}T!==null?T=T.multi_header:T=-1}()),e===null&&(t=h),e}function on(){var e,n,l,o,h,_,y;if(h=t,_=t,e=lt(),e!==null){for(n=[],y=t,l=K(),l!==null?(o=fe(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);l!==null;)n.push(l),y=t,l=K(),l!==null?(o=fe(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);n!==null?e=[e,n]:(e=null,t=_)}else e=null,t=_;return e!==null&&(e=function(C){var w;T.multi_header||(T.multi_header=[]);try{w=new _t(T.uri,T.display_name,T.params),delete T.uri,delete T.display_name,delete T.params}catch{w=null}T.multi_header.push({possition:t,offset:C,parsed:w})}(h)),e===null&&(t=h),e}function za(){var e,n,l,o,h,_,y;if(h=t,_=t,r.substr(t,3).toLowerCase()==="sip"?(e=r.substr(t,3),t+=3):(e=null,f('"SIP"')),e===null&&(e=A()),e!==null){for(n=[],y=t,l=K(),l!==null?(o=hr(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);l!==null;)n.push(l),y=t,l=K(),l!==null?(o=hr(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);n!==null?e=[e,n]:(e=null,t=_)}else e=null,t=_;return e!==null&&(e=function(C,w){if(T.protocol=w.toLowerCase(),T.params||(T.params={}),T.params.text&&T.params.text[0]==='"'){var j=T.params.text;T.text=j.substring(1,j.length-1),delete T.params.text}}(h,e[0])),e===null&&(t=h),e}function hr(){var e;return e=Rl(),e===null&&(e=fe()),e}function Rl(){var e,n,l,o,h,_;if(h=t,_=t,r.substr(t,5).toLowerCase()==="cause"?(e=r.substr(t,5),t+=5):(e=null,f('"cause"')),e!==null)if(n=X(),n!==null){if(o=v(),o!==null)for(l=[];o!==null;)l.push(o),o=v();else l=null;l!==null?e=[e,n,l]:(e=null,t=_)}else e=null,t=_;else e=null,t=_;return e!==null&&(e=function(y,C){T.cause=parseInt(C.join(""))}(h,e[2])),e===null&&(t=h),e}function Ya(){var e,n,l,o,h,_;if(h=t,e=A(),e!==null){for(n=[],_=t,l=ee(),l!==null?(o=A(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);l!==null;)n.push(l),_=t,l=ee(),l!==null?(o=A(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);n!==null?e=[e,n]:(e=null,t=h)}else e=null,t=h;return e}function Ja(){var e,n,l,o,h,_;if(h=t,e=fn(),e!==null){for(n=[],_=t,l=ee(),l!==null?(o=fn(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);l!==null;)n.push(l),_=t,l=ee(),l!==null?(o=fn(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);n!==null?e=[e,n]:(e=null,t=h)}else e=null,t=h;return e}function fn(){var e,n,l,o,h,_;if(h=t,e=lt(),e!==null){for(n=[],_=t,l=K(),l!==null?(o=fe(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);l!==null;)n.push(l),_=t,l=K(),l!==null?(o=fe(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);n!==null?e=[e,n]:(e=null,t=h)}else e=null,t=h;return e}function Xa(){var e,n,l,o,h,_;if(h=t,e=wl(),e!==null){for(n=[],_=t,l=K(),l!==null?(o=dr(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);l!==null;)n.push(l),_=t,l=K(),l!==null?(o=dr(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);n!==null?e=[e,n]:(e=null,t=h)}else e=null,t=h;return e}function wl(){var e,n;return n=t,r.substr(t,6).toLowerCase()==="active"?(e=r.substr(t,6),t+=6):(e=null,f('"active"')),e===null&&(r.substr(t,7).toLowerCase()==="pending"?(e=r.substr(t,7),t+=7):(e=null,f('"pending"')),e===null&&(r.substr(t,10).toLowerCase()==="terminated"?(e=r.substr(t,10),t+=10):(e=null,f('"terminated"')),e===null&&(e=A()))),e!==null&&(e=function(l){T.state=r.substring(t,l)}(n)),e===null&&(t=n),e}function dr(){var e,n,l,o,h;return o=t,h=t,r.substr(t,6).toLowerCase()==="reason"?(e=r.substr(t,6),t+=6):(e=null,f('"reason"')),e!==null?(n=X(),n!==null?(l=Il(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_,y){typeof y<"u"&&(T.reason=y)}(o,e[2])),e===null&&(t=o),e===null&&(o=t,h=t,r.substr(t,7).toLowerCase()==="expires"?(e=r.substr(t,7),t+=7):(e=null,f('"expires"')),e!==null?(n=X(),n!==null?(l=it(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_,y){typeof y<"u"&&(T.expires=y)}(o,e[2])),e===null&&(t=o),e===null&&(o=t,h=t,r.substr(t,11).toLowerCase()==="retry_after"?(e=r.substr(t,11),t+=11):(e=null,f('"retry_after"')),e!==null?(n=X(),n!==null?(l=it(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_,y){typeof y<"u"&&(T.retry_after=y)}(o,e[2])),e===null&&(t=o),e===null&&(e=fe()))),e}function Il(){var e;return r.substr(t,11).toLowerCase()==="deactivated"?(e=r.substr(t,11),t+=11):(e=null,f('"deactivated"')),e===null&&(r.substr(t,9).toLowerCase()==="probation"?(e=r.substr(t,9),t+=9):(e=null,f('"probation"')),e===null&&(r.substr(t,8).toLowerCase()==="rejected"?(e=r.substr(t,8),t+=8):(e=null,f('"rejected"')),e===null&&(r.substr(t,7).toLowerCase()==="timeout"?(e=r.substr(t,7),t+=7):(e=null,f('"timeout"')),e===null&&(r.substr(t,6).toLowerCase()==="giveup"?(e=r.substr(t,6),t+=6):(e=null,f('"giveup"')),e===null&&(r.substr(t,10).toLowerCase()==="noresource"?(e=r.substr(t,10),t+=10):(e=null,f('"noresource"')),e===null&&(r.substr(t,9).toLowerCase()==="invariant"?(e=r.substr(t,9),t+=9):(e=null,f('"invariant"')),e===null&&(e=A()))))))),e}function Qa(){var e;return e=qe(),e=e!==null?e:"",e}function Za(){var e,n,l,o,h,_;if(h=t,e=A(),e!==null){for(n=[],_=t,l=ee(),l!==null?(o=A(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);l!==null;)n.push(l),_=t,l=ee(),l!==null?(o=A(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);n!==null?e=[e,n]:(e=null,t=h)}else e=null,t=h;return e=e!==null?e:"",e}function eu(){var e,n,l,o,h,_,y;if(h=t,_=t,e=J(),e===null&&(e=lt()),e!==null){for(n=[],y=t,l=K(),l!==null?(o=_r(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);l!==null;)n.push(l),y=t,l=K(),l!==null?(o=_r(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);n!==null?e=[e,n]:(e=null,t=_)}else e=null,t=_;return e!==null&&(e=function(C){var w=T.tag;try{T=new _t(T.uri,T.display_name,T.params),w&&T.setParam("tag",w)}catch{T=-1}}()),e===null&&(t=h),e}function _r(){var e;return e=fr(),e===null&&(e=fe()),e}function tu(){var e,n,l,o,h,_;if(h=t,e=cn(),e!==null){for(n=[],_=t,l=ee(),l!==null?(o=cn(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);l!==null;)n.push(l),_=t,l=ee(),l!==null?(o=cn(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);n!==null?e=[e,n]:(e=null,t=h)}else e=null,t=h;return e}function cn(){var e,n,l,o,h,_,y,C;if(y=t,e=Ul(),e!==null)if(n=D(),n!==null)if(l=Hl(),l!==null){for(o=[],C=t,h=K(),h!==null?(_=pr(),_!==null?h=[h,_]:(h=null,t=C)):(h=null,t=C);h!==null;)o.push(h),C=t,h=K(),h!==null?(_=pr(),_!==null?h=[h,_]:(h=null,t=C)):(h=null,t=C);o!==null?e=[e,n,l,o]:(e=null,t=y)}else e=null,t=y;else e=null,t=y;else e=null,t=y;return e}function pr(){var e;return e=Ol(),e===null&&(e=Nl(),e===null&&(e=kl(),e===null&&(e=Dl(),e===null&&(e=xl(),e===null&&(e=fe()))))),e}function Ol(){var e,n,l,o,h;return o=t,h=t,r.substr(t,3).toLowerCase()==="ttl"?(e=r.substr(t,3),t+=3):(e=null,f('"ttl"')),e!==null?(n=X(),n!==null?(l=vr(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_,y){T.ttl=y}(o,e[2])),e===null&&(t=o),e}function Nl(){var e,n,l,o,h;return o=t,h=t,r.substr(t,5).toLowerCase()==="maddr"?(e=r.substr(t,5),t+=5):(e=null,f('"maddr"')),e!==null?(n=X(),n!==null?(l=Tt(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_,y){T.maddr=y}(o,e[2])),e===null&&(t=o),e}function kl(){var e,n,l,o,h;return o=t,h=t,r.substr(t,8).toLowerCase()==="received"?(e=r.substr(t,8),t+=8):(e=null,f('"received"')),e!==null?(n=X(),n!==null?(l=St(),l===null&&(l=tr()),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_,y){T.received=y}(o,e[2])),e===null&&(t=o),e}function Dl(){var e,n,l,o,h;return o=t,h=t,r.substr(t,6).toLowerCase()==="branch"?(e=r.substr(t,6),t+=6):(e=null,f('"branch"')),e!==null?(n=X(),n!==null?(l=A(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_,y){T.branch=y}(o,e[2])),e===null&&(t=o),e}function xl(){var e,n,l,o,h;return o=t,r.substr(t,5).toLowerCase()==="rport"?(e=r.substr(t,5),t+=5):(e=null,f('"rport"')),e!==null?(h=t,n=X(),n!==null?(l=Pl(),l!==null?n=[n,l]:(n=null,t=h)):(n=null,t=h),n=n!==null?n:"",n!==null?e=[e,n]:(e=null,t=o)):(e=null,t=o),e}function Pl(){var e,n,l,o,h,_,y;return _=t,y=t,e=v(),e=e!==null?e:"",e!==null?(n=v(),n=n!==null?n:"",n!==null?(l=v(),l=l!==null?l:"",l!==null?(o=v(),o=o!==null?o:"",o!==null?(h=v(),h=h!==null?h:"",h!==null?e=[e,n,l,o,h]:(e=null,t=y)):(e=null,t=y)):(e=null,t=y)):(e=null,t=y)):(e=null,t=y),e!==null&&(e=function(C,w){T.rport=parseInt(w.join(""))}(_,e)),e===null&&(t=_),e}function Ul(){var e,n,l,o,h,_;return _=t,e=Ml(),e!==null?(n=Ue(),n!==null?(l=A(),l!==null?(o=Ue(),o!==null?(h=Ll(),h!==null?e=[e,n,l,o,h]:(e=null,t=_)):(e=null,t=_)):(e=null,t=_)):(e=null,t=_)):(e=null,t=_),e}function Ml(){var e,n;return n=t,r.substr(t,3).toLowerCase()==="sip"?(e=r.substr(t,3),t+=3):(e=null,f('"SIP"')),e===null&&(e=A()),e!==null&&(e=function(l,o){T.protocol=o}(n,e)),e===null&&(t=n),e}function Ll(){var e,n;return n=t,r.substr(t,3).toLowerCase()==="udp"?(e=r.substr(t,3),t+=3):(e=null,f('"UDP"')),e===null&&(r.substr(t,3).toLowerCase()==="tcp"?(e=r.substr(t,3),t+=3):(e=null,f('"TCP"')),e===null&&(r.substr(t,3).toLowerCase()==="tls"?(e=r.substr(t,3),t+=3):(e=null,f('"TLS"')),e===null&&(r.substr(t,4).toLowerCase()==="sctp"?(e=r.substr(t,4),t+=4):(e=null,f('"SCTP"')),e===null&&(e=A())))),e!==null&&(e=function(l,o){T.transport=o}(n,e)),e===null&&(t=n),e}function Hl(){var e,n,l,o,h;return o=t,e=Fl(),e!==null?(h=t,n=rt(),n!==null?(l=$l(),l!==null?n=[n,l]:(n=null,t=h)):(n=null,t=h),n=n!==null?n:"",n!==null?e=[e,n]:(e=null,t=o)):(e=null,t=o),e}function Fl(){var e,n;return n=t,e=St(),e===null&&(e=er(),e===null&&(e=Qn())),e!==null&&(e=function(l){T.host=r.substring(t,l)}(n)),e===null&&(t=n),e}function $l(){var e,n,l,o,h,_,y;return _=t,y=t,e=v(),e=e!==null?e:"",e!==null?(n=v(),n=n!==null?n:"",n!==null?(l=v(),l=l!==null?l:"",l!==null?(o=v(),o=o!==null?o:"",o!==null?(h=v(),h=h!==null?h:"",h!==null?e=[e,n,l,o,h]:(e=null,t=y)):(e=null,t=y)):(e=null,t=y)):(e=null,t=y)):(e=null,t=y),e!==null&&(e=function(C,w){T.port=parseInt(w.join(""))}(_,e)),e===null&&(t=_),e}function vr(){var e,n,l,o,h;return o=t,h=t,e=v(),e!==null?(n=v(),n=n!==null?n:"",n!==null?(l=v(),l=l!==null?l:"",l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_,y){return parseInt(y.join(""))}(o,e)),e===null&&(t=o),e}function nu(){var e;return e=cr(),e}function ru(){var e,n,l,o,h,_;if(h=t,e=ql(),e!==null){for(n=[],_=t,l=K(),l!==null?(o=mr(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);l!==null;)n.push(l),_=t,l=K(),l!==null?(o=mr(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);n!==null?e=[e,n]:(e=null,t=h)}else e=null,t=h;return e}function ql(){var e,n;return n=t,e=it(),e!==null&&(e=function(l,o){T.expires=o}(n,e)),e===null&&(t=n),e}function mr(){var e;return e=jl(),e===null&&(e=fe()),e}function jl(){var e,n,l,o,h;return o=t,h=t,r.substr(t,9).toLowerCase()==="refresher"?(e=r.substr(t,9),t+=9):(e=null,f('"refresher"')),e!==null?(n=X(),n!==null?(r.substr(t,3).toLowerCase()==="uac"?(l=r.substr(t,3),t+=3):(l=null,f('"uac"')),l===null&&(r.substr(t,3).toLowerCase()==="uas"?(l=r.substr(t,3),t+=3):(l=null,f('"uas"'))),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_,y){T.refresher=y.toLowerCase()}(o,e[2])),e===null&&(t=o),e}function su(){var e,n,l,o;return o=t,e=A(),e!==null?(n=Ie(),n!==null?(l=Bl(),l!==null?e=[e,n,l]:(e=null,t=o)):(e=null,t=o)):(e=null,t=o),e}function Bl(){var e,n;for(e=[],n=be(),n===null&&(n=k(),n===null&&(n=D()));n!==null;)e.push(n),n=be(),n===null&&(n=k(),n===null&&(n=D()));return e}function lu(){var e,n;for(e=[],n=N();n!==null;)e.push(n),n=N();return e}function iu(){var e,n,l;return l=t,r.substr(t,5)==="uuid:"?(e="uuid:",t+=5):(e=null,f('"uuid:"')),e!==null?(n=Gl(),n!==null?e=[e,n]:(e=null,t=l)):(e=null,t=l),e}function Gl(){var e,n,l,o,h,_,y,C,w,j,re;return j=t,re=t,e=Wl(),e!==null?(r.charCodeAt(t)===45?(n="-",t++):(n=null,f('"-"')),n!==null?(l=Me(),l!==null?(r.charCodeAt(t)===45?(o="-",t++):(o=null,f('"-"')),o!==null?(h=Me(),h!==null?(r.charCodeAt(t)===45?(_="-",t++):(_=null,f('"-"')),_!==null?(y=Me(),y!==null?(r.charCodeAt(t)===45?(C="-",t++):(C=null,f('"-"')),C!==null?(w=Vl(),w!==null?e=[e,n,l,o,h,_,y,C,w]:(e=null,t=re)):(e=null,t=re)):(e=null,t=re)):(e=null,t=re)):(e=null,t=re)):(e=null,t=re)):(e=null,t=re)):(e=null,t=re)):(e=null,t=re),e!==null&&(e=function(Ne,hn){T=r.substring(t+5,Ne)}(j,e[0])),e===null&&(t=j),e}function Me(){var e,n,l,o,h;return h=t,e=S(),e!==null?(n=S(),n!==null?(l=S(),l!==null?(o=S(),o!==null?e=[e,n,l,o]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e}function Wl(){var e,n,l;return l=t,e=Me(),e!==null?(n=Me(),n!==null?e=[e,n]:(e=null,t=l)):(e=null,t=l),e}function Vl(){var e,n,l,o;return o=t,e=Me(),e!==null?(n=Me(),n!==null?(l=Me(),l!==null?e=[e,n,l]:(e=null,t=o)):(e=null,t=o)):(e=null,t=o),e}function au(){var e,n,l,o,h,_,y;if(h=t,_=t,e=J(),e===null&&(e=lt()),e!==null){for(n=[],y=t,l=K(),l!==null?(o=fe(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);l!==null;)n.push(l),y=t,l=K(),l!==null?(o=fe(),o!==null?l=[l,o]:(l=null,t=y)):(l=null,t=y);n!==null?e=[e,n]:(e=null,t=_)}else e=null,t=_;return e!==null&&(e=function(C){try{T=new _t(T.uri,T.display_name,T.params)}catch{T=-1}}()),e===null&&(t=h),e}function uu(){var e,n,l,o,h,_;if(h=t,e=Kl(),e!==null){for(n=[],_=t,l=K(),l!==null?(o=gr(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);l!==null;)n.push(l),_=t,l=K(),l!==null?(o=gr(),o!==null?l=[l,o]:(l=null,t=_)):(l=null,t=_);n!==null?e=[e,n]:(e=null,t=h)}else e=null,t=h;return e}function Kl(){var e,n,l,o,h,_;return o=t,h=t,e=Oe(),e!==null?(_=t,r.charCodeAt(t)===64?(n="@",t++):(n=null,f('"@"')),n!==null?(l=Oe(),l!==null?n=[n,l]:(n=null,t=_)):(n=null,t=_),n=n!==null?n:"",n!==null?e=[e,n]:(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(y){T.call_id=r.substring(t,y)}(o)),e===null&&(t=o),e}function gr(){var e;return e=zl(),e===null&&(e=Yl(),e===null&&(e=Jl(),e===null&&(e=fe()))),e}function zl(){var e,n,l,o,h;return o=t,h=t,r.substr(t,6)==="to-tag"?(e="to-tag",t+=6):(e=null,f('"to-tag"')),e!==null?(n=X(),n!==null?(l=A(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_,y){T.to_tag=y}(o,e[2])),e===null&&(t=o),e}function Yl(){var e,n,l,o,h;return o=t,h=t,r.substr(t,8)==="from-tag"?(e="from-tag",t+=8):(e=null,f('"from-tag"')),e!==null?(n=X(),n!==null?(l=A(),l!==null?e=[e,n,l]:(e=null,t=h)):(e=null,t=h)):(e=null,t=h),e!==null&&(e=function(_,y){T.from_tag=y}(o,e[2])),e===null&&(t=o),e}function Jl(){var e,n;return n=t,r.substr(t,10)==="early-only"?(e="early-only",t+=10):(e=null,f('"early-only"')),e!==null&&(e=function(l){T.early_only=!0}()),e===null&&(t=n),e}function ou(e){e.sort();for(var n=null,l=[],o=0;o<e.length;o++)e[o]!==n&&(l.push(e[o]),n=e[o]);return l}function fu(){for(var e=1,n=1,l=!1,o=0;o<Math.max(t,d);o++){var h=r.charAt(o);h===`
`?(l||e++,n=1,l=!1):h==="\r"||h==="\u2028"||h==="\u2029"?(e++,n=1,l=!0):(n++,l=!1)}return{line:e,column:n}}var Xl=Qe(),_t=rs(),T={},cu=c[s]();if(cu===null||t!==r.length){var yr=Math.max(t,d),hu=yr<r.length?r.charAt(yr):null,Ql=fu();return new this.SyntaxError(ou(m),hu,yr,Ql.line,Ql.column),-1}return T},toSource:function(){return this._source}};return a.SyntaxError=function(i,r,s,c,t){function d(m,f){var p,v;switch(m.length){case 0:p="end of input";break;case 1:p=m[0];break;default:p=m.slice(0,m.length-1).join(", ")+" or "+m[m.length-1]}return v=f?u(f):"end of input","Expected "+p+" but "+v+" found."}this.name="SyntaxError",this.expected=i,this.found=r,this.message=d(i,r),this.offset=s,this.line=c,this.column=t},a.SyntaxError.prototype=Error.prototype,a}()),Er}var Cr,ni;function Qe(){if(ni)return Cr;ni=1;function u(f,p){var v;if(typeof Symbol>"u"||f[Symbol.iterator]==null){if(Array.isArray(f)||(v=a(f))||p&&f&&typeof f.length=="number"){v&&(f=v);var g=0,S=function(){};return{s:S,n:function(){return g>=f.length?{done:!0}:{done:!1,value:f[g++]}},e:function(q){throw q},f:S}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var E=!0,N=!1,H;return{s:function(){v=f[Symbol.iterator]()},n:function(){var q=v.next();return E=q.done,q},e:function(q){N=!0,H=q},f:function(){try{!E&&v.return!=null&&v.return()}finally{if(N)throw H}}}}function a(f,p){if(f){if(typeof f=="string")return i(f,p);var v=Object.prototype.toString.call(f).slice(8,-1);if(v==="Object"&&f.constructor&&(v=f.constructor.name),v==="Map"||v==="Set")return Array.from(f);if(v==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(v))return i(f,p)}}function i(f,p){(p==null||p>f.length)&&(p=f.length);for(var v=0,g=new Array(p);v<p;v++)g[v]=f[v];return g}function r(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function s(f,p){for(var v=0;v<p.length;v++){var g=p[v];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}function c(f,p,v){return p&&s(f.prototype,p),v&&s(f,v),f}var t=he,d=ye(),m=xe();return Cr=function(){c(f,null,[{key:"parse",value:function(v){if(v=m.parse(v,"SIP_URI"),v!==-1)return v}}]);function f(p,v,g,S){var E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},N=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};if(r(this,f),!g)throw new TypeError('missing or invalid "host" parameter');this._parameters={},this._headers={},this._scheme=p||t.SIP,this._user=v,this._host=g,this._port=S;for(var H in E)Object.prototype.hasOwnProperty.call(E,H)&&this.setParam(H,E[H]);for(var U in N)Object.prototype.hasOwnProperty.call(N,U)&&this.setHeader(U,N[U])}return c(f,[{key:"setParam",value:function(v,g){v&&(this._parameters[v.toLowerCase()]=typeof g>"u"||g===null?null:g.toString())}},{key:"getParam",value:function(v){if(v)return this._parameters[v.toLowerCase()]}},{key:"hasParam",value:function(v){if(v)return this._parameters.hasOwnProperty(v.toLowerCase())&&!0||!1}},{key:"deleteParam",value:function(v){if(v=v.toLowerCase(),this._parameters.hasOwnProperty(v)){var g=this._parameters[v];return delete this._parameters[v],g}}},{key:"clearParams",value:function(){this._parameters={}}},{key:"setHeader",value:function(v,g){this._headers[d.headerize(v)]=Array.isArray(g)?g:[g]}},{key:"getHeader",value:function(v){if(v)return this._headers[d.headerize(v)]}},{key:"hasHeader",value:function(v){if(v)return this._headers.hasOwnProperty(d.headerize(v))&&!0||!1}},{key:"deleteHeader",value:function(v){if(v=d.headerize(v),this._headers.hasOwnProperty(v)){var g=this._headers[v];return delete this._headers[v],g}}},{key:"clearHeaders",value:function(){this._headers={}}},{key:"clone",value:function(){return new f(this._scheme,this._user,this._host,this._port,JSON.parse(JSON.stringify(this._parameters)),JSON.parse(JSON.stringify(this._headers)))}},{key:"toString",value:function(){var v=[],g="".concat(this._scheme,":");this._user&&(g+="".concat(d.escapeUser(this._user),"@")),g+=this._host,(this._port||this._port===0)&&(g+=":".concat(this._port));for(var S in this._parameters)Object.prototype.hasOwnProperty.call(this._parameters,S)&&(g+=";".concat(S),this._parameters[S]!==null&&(g+="=".concat(this._parameters[S])));for(var E in this._headers)if(Object.prototype.hasOwnProperty.call(this._headers,E)){var N=u(this._headers[E]),H;try{for(N.s();!(H=N.n()).done;){var U=H.value;v.push("".concat(E,"=").concat(U))}}catch(q){N.e(q)}finally{N.f()}}return v.length>0&&(g+="?".concat(v.join("&"))),g}},{key:"toAor",value:function(v){var g="".concat(this._scheme,":");return this._user&&(g+="".concat(d.escapeUser(this._user),"@")),g+=this._host,v&&(this._port||this._port===0)&&(g+=":".concat(this._port)),g}},{key:"scheme",get:function(){return this._scheme},set:function(v){this._scheme=v.toLowerCase()}},{key:"user",get:function(){return this._user},set:function(v){this._user=v}},{key:"host",get:function(){return this._host},set:function(v){this._host=v.toLowerCase()}},{key:"port",get:function(){return this._port},set:function(v){this._port=v===0?v:parseInt(v,10)||null}}]),f}(),Cr}var ri;function ye(){if(ri)return oe;ri=1;function u(p){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?u=function(g){return typeof g}:u=function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},u(p)}function a(p,v){var g;if(typeof Symbol>"u"||p[Symbol.iterator]==null){if(Array.isArray(p)||(g=i(p))||v&&p&&typeof p.length=="number"){g&&(p=g);var S=0,E=function(){};return{s:E,n:function(){return S>=p.length?{done:!0}:{done:!1,value:p[S++]}},e:function(G){throw G},f:E}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var N=!0,H=!1,U;return{s:function(){g=p[Symbol.iterator]()},n:function(){var G=g.next();return N=G.done,G},e:function(G){H=!0,U=G},f:function(){try{!N&&g.return!=null&&g.return()}finally{if(H)throw U}}}}function i(p,v){if(p){if(typeof p=="string")return r(p,v);var g=Object.prototype.toString.call(p).slice(8,-1);if(g==="Object"&&p.constructor&&(g=p.constructor.name),g==="Map"||g==="Set")return Array.from(p);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return r(p,v)}}function r(p,v){(v==null||v>p.length)&&(v=p.length);for(var g=0,S=new Array(v);g<v;g++)S[g]=p[g];return S}var s=he,c=Qe(),t=xe();oe.str_utf8_length=function(p){return unescape(encodeURIComponent(p)).length};var d=oe.isFunction=function(p){return p!==void 0?Object.prototype.toString.call(p)==="[object Function]":!1};oe.isString=function(p){return p!==void 0?Object.prototype.toString.call(p)==="[object String]":!1},oe.isDecimal=function(p){return!isNaN(p)&&parseFloat(p)===parseInt(p,10)},oe.isEmpty=function(p){return p===null||p===""||p===void 0||Array.isArray(p)&&p.length===0||typeof p=="number"&&isNaN(p)},oe.hasMethods=function(p){for(var v=arguments.length,g=new Array(v>1?v-1:0),S=1;S<v;S++)g[S-1]=arguments[S];for(var E=0,N=g;E<N.length;E++){var H=N[E];if(d(p[H]))return!1}return!0};var m=oe.createRandomToken=function(p){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:32,g,S,E="";for(g=0;g<p;g++)S=Math.random()*v|0,E+=S.toString(v);return E};oe.newTag=function(){return m(10)},oe.newUUID=function(){var p="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(v){var g=Math.random()*16|0,S=v==="x"?g:g&3|8;return S.toString(16)});return p},oe.hostType=function(p){if(p){if(p=t.parse(p,"host"),p!==-1)return p.host_type}else return};var f=oe.escapeUser=function(p){return encodeURIComponent(decodeURIComponent(p)).replace(/%3A/ig,":").replace(/%2B/ig,"+").replace(/%3F/ig,"?").replace(/%2F/ig,"/")};return oe.normalizeTarget=function(p,v){if(p){if(p instanceof c)return p;if(typeof p=="string"){var g=p.split("@"),S,E;switch(g.length){case 1:if(!v)return;S=p,E=v;break;case 2:S=g[0],E=g[1];break;default:S=g.slice(0,g.length-1).join("@"),E=g[g.length-1]}S=S.replace(/^(sips?|tel):/i,""),/^[-.()]*\+?[0-9\-.()]+$/.test(S)&&(S=S.replace(/[-.()]/g,"")),p="".concat(s.SIP,":").concat(f(S),"@").concat(E);var N;return(N=c.parse(p))?N:void 0}else return}else return},oe.headerize=function(p){var v={"Call-Id":"Call-ID",Cseq:"CSeq","Www-Authenticate":"WWW-Authenticate"},g=p.toLowerCase().replace(/_/g,"-").split("-"),S="",E=g.length,N;for(N=0;N<E;N++)N!==0&&(S+="-"),S+=g[N].charAt(0).toUpperCase()+g[N].substring(1);return v[S]&&(S=v[S]),S},oe.sipErrorCause=function(p){for(var v in s.SIP_ERROR_CAUSES)if(s.SIP_ERROR_CAUSES[v].indexOf(p)!==-1)return s.causes[v];return s.causes.SIP_FAILURE_CODE},oe.getRandomTestNetIP=function(){function p(v,g){return Math.floor(Math.random()*(g-v+1)+v)}return"192.0.2.".concat(p(1,254))},oe.calculateMD5=function(p){function v(W,B){return W<<B|W>>>32-B}function g(W,B){var V=W&2147483648,J=B&2147483648,ae=W&1073741824,de=B&1073741824,le=(W&1073741823)+(B&1073741823);return ae&de?le^2147483648^V^J:ae|de?le&1073741824?le^3221225472^V^J:le^1073741824^V^J:le^V^J}function S(W,B,V){return W&B|~W&V}function E(W,B,V){return W&V|B&~V}function N(W,B,V){return W^B^V}function H(W,B,V){return B^(W|~V)}function U(W,B,V,J,ae,de,le){return W=g(W,g(g(S(B,V,J),ae),le)),g(v(W,de),B)}function q(W,B,V,J,ae,de,le){return W=g(W,g(g(E(B,V,J),ae),le)),g(v(W,de),B)}function G(W,B,V,J,ae,de,le){return W=g(W,g(g(N(B,V,J),ae),le)),g(v(W,de),B)}function z(W,B,V,J,ae,de,le){return W=g(W,g(g(H(B,V,J),ae),le)),g(v(W,de),B)}function Y(W){for(var B,V=W.length,J=V+8,ae=(J-J%64)/64,de=(ae+1)*16,le=new Array(de-1),st=0,Se=0;Se<V;)B=(Se-Se%4)/4,st=Se%4*8,le[B]=le[B]|W.charCodeAt(Se)<<st,Se++;return B=(Se-Se%4)/4,st=Se%4*8,le[B]=le[B]|128<<st,le[de-2]=V<<3,le[de-1]=V>>>29,le}function ue(W){var B="",V="",J,ae;for(ae=0;ae<=3;ae++)J=W>>>ae*8&255,V="0".concat(J.toString(16)),B=B+V.substr(V.length-2,2);return B}function Z(W){for(var B="",V=0;V<W.length;V++){var J=W.charCodeAt(V);J<128?B+=String.fromCharCode(J):J>127&&J<2048?(B+=String.fromCharCode(J>>6|192),B+=String.fromCharCode(J&63|128)):(B+=String.fromCharCode(J>>12|224),B+=String.fromCharCode(J>>6&63|128),B+=String.fromCharCode(J&63|128))}return B}var D=[],O,Ie,qe,be,Q,k,x,A,P,ht=7,Oe=12,et=17,Ue=22,X=5,tt=9,nt=14,je=20,Be=4,ee=11,K=16,rt=23,Ge=6,We=10,Ve=15,Ke=21;for(p=Z(p),D=Y(p),k=1732584193,x=4023233417,A=2562383102,P=271733878,O=0;O<D.length;O+=16)Ie=k,qe=x,be=A,Q=P,k=U(k,x,A,P,D[O+0],ht,3614090360),P=U(P,k,x,A,D[O+1],Oe,3905402710),A=U(A,P,k,x,D[O+2],et,606105819),x=U(x,A,P,k,D[O+3],Ue,3250441966),k=U(k,x,A,P,D[O+4],ht,4118548399),P=U(P,k,x,A,D[O+5],Oe,1200080426),A=U(A,P,k,x,D[O+6],et,2821735955),x=U(x,A,P,k,D[O+7],Ue,4249261313),k=U(k,x,A,P,D[O+8],ht,1770035416),P=U(P,k,x,A,D[O+9],Oe,2336552879),A=U(A,P,k,x,D[O+10],et,4294925233),x=U(x,A,P,k,D[O+11],Ue,2304563134),k=U(k,x,A,P,D[O+12],ht,1804603682),P=U(P,k,x,A,D[O+13],Oe,4254626195),A=U(A,P,k,x,D[O+14],et,2792965006),x=U(x,A,P,k,D[O+15],Ue,1236535329),k=q(k,x,A,P,D[O+1],X,4129170786),P=q(P,k,x,A,D[O+6],tt,3225465664),A=q(A,P,k,x,D[O+11],nt,643717713),x=q(x,A,P,k,D[O+0],je,3921069994),k=q(k,x,A,P,D[O+5],X,3593408605),P=q(P,k,x,A,D[O+10],tt,38016083),A=q(A,P,k,x,D[O+15],nt,3634488961),x=q(x,A,P,k,D[O+4],je,3889429448),k=q(k,x,A,P,D[O+9],X,568446438),P=q(P,k,x,A,D[O+14],tt,3275163606),A=q(A,P,k,x,D[O+3],nt,4107603335),x=q(x,A,P,k,D[O+8],je,1163531501),k=q(k,x,A,P,D[O+13],X,2850285829),P=q(P,k,x,A,D[O+2],tt,4243563512),A=q(A,P,k,x,D[O+7],nt,1735328473),x=q(x,A,P,k,D[O+12],je,2368359562),k=G(k,x,A,P,D[O+5],Be,4294588738),P=G(P,k,x,A,D[O+8],ee,2272392833),A=G(A,P,k,x,D[O+11],K,1839030562),x=G(x,A,P,k,D[O+14],rt,4259657740),k=G(k,x,A,P,D[O+1],Be,2763975236),P=G(P,k,x,A,D[O+4],ee,1272893353),A=G(A,P,k,x,D[O+7],K,4139469664),x=G(x,A,P,k,D[O+10],rt,3200236656),k=G(k,x,A,P,D[O+13],Be,681279174),P=G(P,k,x,A,D[O+0],ee,3936430074),A=G(A,P,k,x,D[O+3],K,3572445317),x=G(x,A,P,k,D[O+6],rt,76029189),k=G(k,x,A,P,D[O+9],Be,3654602809),P=G(P,k,x,A,D[O+12],ee,3873151461),A=G(A,P,k,x,D[O+15],K,530742520),x=G(x,A,P,k,D[O+2],rt,3299628645),k=z(k,x,A,P,D[O+0],Ge,4096336452),P=z(P,k,x,A,D[O+7],We,1126891415),A=z(A,P,k,x,D[O+14],Ve,2878612391),x=z(x,A,P,k,D[O+5],Ke,4237533241),k=z(k,x,A,P,D[O+12],Ge,1700485571),P=z(P,k,x,A,D[O+3],We,2399980690),A=z(A,P,k,x,D[O+10],Ve,4293915773),x=z(x,A,P,k,D[O+1],Ke,2240044497),k=z(k,x,A,P,D[O+8],Ge,1873313359),P=z(P,k,x,A,D[O+15],We,4264355552),A=z(A,P,k,x,D[O+6],Ve,2734768916),x=z(x,A,P,k,D[O+13],Ke,1309151649),k=z(k,x,A,P,D[O+4],Ge,4149444226),P=z(P,k,x,A,D[O+11],We,3174756917),A=z(A,P,k,x,D[O+2],Ve,718787259),x=z(x,A,P,k,D[O+9],Ke,3951481745),k=g(k,Ie),x=g(x,qe),A=g(A,be),P=g(P,Q);var dt=ue(k)+ue(x)+ue(A)+ue(P);return dt.toLowerCase()},oe.closeMediaStream=function(p){if(p)try{var v;if(p.getTracks){v=p.getTracks();var g=a(v),S;try{for(g.s();!(S=g.n()).done;){var E=S.value;E.stop()}}catch(Y){g.e(Y)}finally{g.f()}}else{v=p.getAudioTracks();var N=a(v),H;try{for(N.s();!(H=N.n()).done;){var U=H.value;U.stop()}}catch(Y){N.e(Y)}finally{N.f()}v=p.getVideoTracks();var q=a(v),G;try{for(q.s();!(G=q.n()).done;){var z=G.value;z.stop()}}catch(Y){q.e(Y)}finally{q.f()}}}catch{(typeof p.stop=="function"||u(p.stop)==="object")&&p.stop()}},oe.cloneArray=function(p){return p&&p.slice()||[]},oe.cloneObject=function(p){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return p&&Object.assign({},p)||v},oe}var ss={exports:{}},gt=typeof Reflect=="object"?Reflect:null,si=gt&&typeof gt.apply=="function"?gt.apply:function(a,i,r){return Function.prototype.apply.call(a,i,r)},Rn;gt&&typeof gt.ownKeys=="function"?Rn=gt.ownKeys:Object.getOwnPropertySymbols?Rn=function(a){return Object.getOwnPropertyNames(a).concat(Object.getOwnPropertySymbols(a))}:Rn=function(a){return Object.getOwnPropertyNames(a)};function Fu(u){console&&console.warn&&console.warn(u)}var fa=Number.isNaN||function(a){return a!==a};function te(){te.init.call(this)}ss.exports=te;ss.exports.once=Bu;te.EventEmitter=te;te.prototype._events=void 0;te.prototype._eventsCount=0;te.prototype._maxListeners=void 0;var li=10;function Yn(u){if(typeof u!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof u)}Object.defineProperty(te,"defaultMaxListeners",{enumerable:!0,get:function(){return li},set:function(u){if(typeof u!="number"||u<0||fa(u))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+u+".");li=u}});te.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};te.prototype.setMaxListeners=function(a){if(typeof a!="number"||a<0||fa(a))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+a+".");return this._maxListeners=a,this};function ca(u){return u._maxListeners===void 0?te.defaultMaxListeners:u._maxListeners}te.prototype.getMaxListeners=function(){return ca(this)};te.prototype.emit=function(a){for(var i=[],r=1;r<arguments.length;r++)i.push(arguments[r]);var s=a==="error",c=this._events;if(c!==void 0)s=s&&c.error===void 0;else if(!s)return!1;if(s){var t;if(i.length>0&&(t=i[0]),t instanceof Error)throw t;var d=new Error("Unhandled error."+(t?" ("+t.message+")":""));throw d.context=t,d}var m=c[a];if(m===void 0)return!1;if(typeof m=="function")si(m,this,i);else for(var f=m.length,p=va(m,f),r=0;r<f;++r)si(p[r],this,i);return!0};function ha(u,a,i,r){var s,c,t;if(Yn(i),c=u._events,c===void 0?(c=u._events=Object.create(null),u._eventsCount=0):(c.newListener!==void 0&&(u.emit("newListener",a,i.listener?i.listener:i),c=u._events),t=c[a]),t===void 0)t=c[a]=i,++u._eventsCount;else if(typeof t=="function"?t=c[a]=r?[i,t]:[t,i]:r?t.unshift(i):t.push(i),s=ca(u),s>0&&t.length>s&&!t.warned){t.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+t.length+" "+String(a)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=u,d.type=a,d.count=t.length,Fu(d)}return u}te.prototype.addListener=function(a,i){return ha(this,a,i,!1)};te.prototype.on=te.prototype.addListener;te.prototype.prependListener=function(a,i){return ha(this,a,i,!0)};function $u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function da(u,a,i){var r={fired:!1,wrapFn:void 0,target:u,type:a,listener:i},s=$u.bind(r);return s.listener=i,r.wrapFn=s,s}te.prototype.once=function(a,i){return Yn(i),this.on(a,da(this,a,i)),this};te.prototype.prependOnceListener=function(a,i){return Yn(i),this.prependListener(a,da(this,a,i)),this};te.prototype.removeListener=function(a,i){var r,s,c,t,d;if(Yn(i),s=this._events,s===void 0)return this;if(r=s[a],r===void 0)return this;if(r===i||r.listener===i)--this._eventsCount===0?this._events=Object.create(null):(delete s[a],s.removeListener&&this.emit("removeListener",a,r.listener||i));else if(typeof r!="function"){for(c=-1,t=r.length-1;t>=0;t--)if(r[t]===i||r[t].listener===i){d=r[t].listener,c=t;break}if(c<0)return this;c===0?r.shift():qu(r,c),r.length===1&&(s[a]=r[0]),s.removeListener!==void 0&&this.emit("removeListener",a,d||i)}return this};te.prototype.off=te.prototype.removeListener;te.prototype.removeAllListeners=function(a){var i,r,s;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[a]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[a]),this;if(arguments.length===0){var c=Object.keys(r),t;for(s=0;s<c.length;++s)t=c[s],t!=="removeListener"&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(i=r[a],typeof i=="function")this.removeListener(a,i);else if(i!==void 0)for(s=i.length-1;s>=0;s--)this.removeListener(a,i[s]);return this};function _a(u,a,i){var r=u._events;if(r===void 0)return[];var s=r[a];return s===void 0?[]:typeof s=="function"?i?[s.listener||s]:[s]:i?ju(s):va(s,s.length)}te.prototype.listeners=function(a){return _a(this,a,!0)};te.prototype.rawListeners=function(a){return _a(this,a,!1)};te.listenerCount=function(u,a){return typeof u.listenerCount=="function"?u.listenerCount(a):pa.call(u,a)};te.prototype.listenerCount=pa;function pa(u){var a=this._events;if(a!==void 0){var i=a[u];if(typeof i=="function")return 1;if(i!==void 0)return i.length}return 0}te.prototype.eventNames=function(){return this._eventsCount>0?Rn(this._events):[]};function va(u,a){for(var i=new Array(a),r=0;r<a;++r)i[r]=u[r];return i}function qu(u,a){for(;a+1<u.length;a++)u[a]=u[a+1];u.pop()}function ju(u){for(var a=new Array(u.length),i=0;i<a.length;++i)a[i]=u[i].listener||u[i];return a}function Bu(u,a){return new Promise(function(i,r){function s(t){u.removeListener(a,c),r(t)}function c(){typeof u.removeListener=="function"&&u.removeListener("error",s),i([].slice.call(arguments))}ma(u,a,c,{once:!0}),a!=="error"&&Gu(u,s,{once:!0})})}function Gu(u,a,i){typeof u.on=="function"&&ma(u,"error",a,i)}function ma(u,a,i,r){if(typeof u.on=="function")r.once?u.once(a,i):u.on(a,i);else if(typeof u.addEventListener=="function")u.addEventListener(a,function s(c){r.once&&u.removeEventListener(a,s),i(c)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof u)}var Ze=ss.exports,Gr={exports:{}},br,ii;function Wu(){if(ii)return br;ii=1;var u=1e3,a=u*60,i=a*60,r=i*24,s=r*7,c=r*365.25;br=function(p,v){v=v||{};var g=typeof p;if(g==="string"&&p.length>0)return t(p);if(g==="number"&&isFinite(p))return v.long?m(p):d(p);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(p))};function t(p){if(p=String(p),!(p.length>100)){var v=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(p);if(v){var g=parseFloat(v[1]),S=(v[2]||"ms").toLowerCase();switch(S){case"years":case"year":case"yrs":case"yr":case"y":return g*c;case"weeks":case"week":case"w":return g*s;case"days":case"day":case"d":return g*r;case"hours":case"hour":case"hrs":case"hr":case"h":return g*i;case"minutes":case"minute":case"mins":case"min":case"m":return g*a;case"seconds":case"second":case"secs":case"sec":case"s":return g*u;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g;default:return}}}}function d(p){var v=Math.abs(p);return v>=r?Math.round(p/r)+"d":v>=i?Math.round(p/i)+"h":v>=a?Math.round(p/a)+"m":v>=u?Math.round(p/u)+"s":p+"ms"}function m(p){var v=Math.abs(p);return v>=r?f(p,v,r,"day"):v>=i?f(p,v,i,"hour"):v>=a?f(p,v,a,"minute"):v>=u?f(p,v,u,"second"):p+" ms"}function f(p,v,g,S){var E=v>=g*1.5;return Math.round(p/g)+" "+S+(E?"s":"")}return br}function Vu(u){i.debug=i,i.default=i,i.coerce=m,i.disable=c,i.enable=s,i.enabled=t,i.humanize=Wu(),i.destroy=f,Object.keys(u).forEach(p=>{i[p]=u[p]}),i.names=[],i.skips=[],i.formatters={};function a(p){let v=0;for(let g=0;g<p.length;g++)v=(v<<5)-v+p.charCodeAt(g),v|=0;return i.colors[Math.abs(v)%i.colors.length]}i.selectColor=a;function i(p){let v,g=null,S,E;function N(...H){if(!N.enabled)return;const U=N,q=Number(new Date),G=q-(v||q);U.diff=G,U.prev=v,U.curr=q,v=q,H[0]=i.coerce(H[0]),typeof H[0]!="string"&&H.unshift("%O");let z=0;H[0]=H[0].replace(/%([a-zA-Z%])/g,(ue,Z)=>{if(ue==="%%")return"%";z++;const D=i.formatters[Z];if(typeof D=="function"){const O=H[z];ue=D.call(U,O),H.splice(z,1),z--}return ue}),i.formatArgs.call(U,H),(U.log||i.log).apply(U,H)}return N.namespace=p,N.useColors=i.useColors(),N.color=i.selectColor(p),N.extend=r,N.destroy=i.destroy,Object.defineProperty(N,"enabled",{enumerable:!0,configurable:!1,get:()=>g!==null?g:(S!==i.namespaces&&(S=i.namespaces,E=i.enabled(p)),E),set:H=>{g=H}}),typeof i.init=="function"&&i.init(N),N}function r(p,v){const g=i(this.namespace+(typeof v>"u"?":":v)+p);return g.log=this.log,g}function s(p){i.save(p),i.namespaces=p,i.names=[],i.skips=[];let v;const g=(typeof p=="string"?p:"").split(/[\s,]+/),S=g.length;for(v=0;v<S;v++)g[v]&&(p=g[v].replace(/\*/g,".*?"),p[0]==="-"?i.skips.push(new RegExp("^"+p.slice(1)+"$")):i.names.push(new RegExp("^"+p+"$")))}function c(){const p=[...i.names.map(d),...i.skips.map(d).map(v=>"-"+v)].join(",");return i.enable(""),p}function t(p){if(p[p.length-1]==="*")return!0;let v,g;for(v=0,g=i.skips.length;v<g;v++)if(i.skips[v].test(p))return!1;for(v=0,g=i.names.length;v<g;v++)if(i.names[v].test(p))return!0;return!1}function d(p){return p.toString().substring(2,p.toString().length-2).replace(/\.\*\?$/,"*")}function m(p){return p instanceof Error?p.stack||p.message:p}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return i.enable(i.load()),i}var Ku=Vu;(function(u,a){var i={};a.formatArgs=s,a.save=c,a.load=t,a.useColors=r,a.storage=d(),a.destroy=(()=>{let f=!1;return()=>{f||(f=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),a.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function s(f){if(f[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+f[0]+(this.useColors?"%c ":" ")+"+"+u.exports.humanize(this.diff),!this.useColors)return;const p="color: "+this.color;f.splice(1,0,p,"color: inherit");let v=0,g=0;f[0].replace(/%[a-zA-Z%]/g,S=>{S!=="%%"&&(v++,S==="%c"&&(g=v))}),f.splice(g,0,p)}a.log=console.debug||console.log||(()=>{});function c(f){try{f?a.storage.setItem("debug",f):a.storage.removeItem("debug")}catch{}}function t(){let f;try{f=a.storage.getItem("debug")}catch{}return!f&&typeof process<"u"&&"env"in process&&(f=i.DEBUG),f}function d(){try{return localStorage}catch{}}u.exports=Ku(a);const{formatters:m}=u.exports;m.j=function(f){try{return JSON.stringify(f)}catch(p){return"[UnexpectedJSONParseError]: "+p.message}}})(Gr,Gr.exports);var ls=Gr.exports;function zu(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function ai(u,a){for(var i=0;i<a.length;i++){var r=a[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(u,r.key,r)}}function Yu(u,a,i){return a&&ai(u.prototype,a),i&&ai(u,i),u}var pt=ls,vt="JsSIP",_e=function(){function u(a){zu(this,u),a?(this._debug=pt.default("".concat(vt,":").concat(a)),this._warn=pt.default("".concat(vt,":WARN:").concat(a)),this._error=pt.default("".concat(vt,":ERROR:").concat(a))):(this._debug=pt.default(vt),this._warn=pt.default("".concat(vt,":WARN")),this._error=pt.default("".concat(vt,":ERROR"))),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}return Yu(u,[{key:"debug",get:function(){return this._debug}},{key:"warn",get:function(){return this._warn}},{key:"error",get:function(){return this._error}}]),u}(),Pe={},ga={},ya={exports:{}},ui=ya.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(u){return u.encoding?"rtpmap:%d %s/%s/%s":u.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(u){return u.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(u){return u.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(u){return"extmap:%d"+(u.direction?"/%s":"%v")+(u["encrypt-uri"]?" %s":"%v")+" %s"+(u.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(u){return u.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(u){var a="candidate:%s %d %s %d %s %d typ %s";return a+=u.raddr!=null?" raddr %s rport %d":"%v%v",a+=u.tcptype!=null?" tcptype %s":"%v",u.generation!=null&&(a+=" generation %d"),a+=u["network-id"]!=null?" network-id %d":"%v",a+=u["network-cost"]!=null?" network-cost %d":"%v",a}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(u){var a="ssrc:%d";return u.attribute!=null&&(a+=" %s",u.value!=null&&(a+=":%s")),a}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(u){return u.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(u){return u.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(u){return"imageattr:%s %s %s"+(u.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(u){return"simulcast:%s %s"+(u.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(u){return"ts-refclk:%s"+(u.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(u){var a="mediaclk:";return a+=u.id!=null?"id=%s %s":"%v%s",a+=u.mediaClockValue!=null?"=%s":"",a+=u.rateNumerator!=null?" rate=%s":"",a+=u.rateDenominator!=null?"/%s":"",a}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(ui).forEach(function(u){var a=ui[u];a.forEach(function(i){i.reg||(i.reg=/(.*)/),i.format||(i.format="%s")})});var Ta=ya.exports;(function(u){var a=function(d){return String(Number(d))===d?Number(d):d},i=function(d,m,f,p){if(p&&!f)m[p]=a(d[1]);else for(var v=0;v<f.length;v+=1)d[v+1]!=null&&(m[f[v]]=a(d[v+1]))},r=function(d,m,f){var p=d.name&&d.names;d.push&&!m[d.push]?m[d.push]=[]:p&&!m[d.name]&&(m[d.name]={});var v=d.push?{}:p?m[d.name]:m;i(f.match(d.reg),v,d.names,d.name),d.push&&m[d.push].push(v)},s=Ta,c=RegExp.prototype.test.bind(/^([a-z])=(.*)/);u.parse=function(d){var m={},f=[],p=m;return d.split(/(\r\n|\r|\n)/).filter(c).forEach(function(v){var g=v[0],S=v.slice(2);g==="m"&&(f.push({rtp:[],fmtp:[]}),p=f[f.length-1]);for(var E=0;E<(s[g]||[]).length;E+=1){var N=s[g][E];if(N.reg.test(S))return r(N,p,S)}}),m.media=f,m};var t=function(d,m){var f=m.split(/=(.+)/,2);return f.length===2?d[f[0]]=a(f[1]):f.length===1&&m.length>1&&(d[f[0]]=void 0),d};u.parseParams=function(d){return d.split(/;\s?/).reduce(t,{})},u.parseFmtpConfig=u.parseParams,u.parsePayloads=function(d){return d.toString().split(" ").map(Number)},u.parseRemoteCandidates=function(d){for(var m=[],f=d.split(" ").map(a),p=0;p<f.length;p+=3)m.push({component:f[p],ip:f[p+1],port:f[p+2]});return m},u.parseImageAttributes=function(d){return d.split(" ").map(function(m){return m.substring(1,m.length-1).split(",").reduce(t,{})})},u.parseSimulcastStreamList=function(d){return d.split(";").map(function(m){return m.split(",").map(function(f){var p,v=!1;return f[0]!=="~"?p=a(f):(p=a(f.substring(1,f.length)),v=!0),{scid:p,paused:v}})})}})(ga);var Ar=Ta,Ju=/%[sdv%]/g,Xu=function(u){var a=1,i=arguments,r=i.length;return u.replace(Ju,function(s){if(a>=r)return s;var c=i[a];switch(a+=1,s){case"%%":return"%";case"%s":return String(c);case"%d":return Number(c);case"%v":return""}})},Ot=function(u,a,i){var r=a.format instanceof Function?a.format(a.push?i:i[a.name]):a.format,s=[u+"="+r];if(a.names)for(var c=0;c<a.names.length;c+=1){var t=a.names[c];a.name?s.push(i[a.name][t]):s.push(i[a.names[c]])}else s.push(i[a.name]);return Xu.apply(null,s)},Qu=["v","o","s","i","u","e","p","c","b","t","r","z","a"],Zu=["i","c","b","a"],eo=function(u,a){a=a||{},u.version==null&&(u.version=0),u.name==null&&(u.name=" "),u.media.forEach(function(c){c.payloads==null&&(c.payloads="")});var i=a.outerOrder||Qu,r=a.innerOrder||Zu,s=[];return i.forEach(function(c){Ar[c].forEach(function(t){t.name in u&&u[t.name]!=null?s.push(Ot(c,t,u)):t.push in u&&u[t.push]!=null&&u[t.push].forEach(function(d){s.push(Ot(c,t,d))})})}),u.media.forEach(function(c){s.push(Ot("m",Ar.m[0],c)),r.forEach(function(t){Ar[t].forEach(function(d){d.name in c&&c[d.name]!=null?s.push(Ot(t,d,c)):d.push in c&&c[d.push]!=null&&c[d.push].forEach(function(m){s.push(Ot(t,d,m))})})})}),s.join(`\r
`)+`\r
`},ct=ga,to=eo;Pe.write=to;Pe.parse=ct.parse;Pe.parseParams=ct.parseParams;Pe.parseFmtpConfig=ct.parseFmtpConfig;Pe.parsePayloads=ct.parsePayloads;Pe.parseRemoteCandidates=ct.parseRemoteCandidates;Pe.parseImageAttributes=ct.parseImageAttributes;Pe.parseSimulcastStreamList=ct.parseSimulcastStreamList;function wn(u){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?wn=function(i){return typeof i}:wn=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},wn(u)}function is(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&Wr(u,a)}function Wr(u,a){return Wr=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},Wr(u,a)}function as(u){var a=so();return function(){var r=Ln(u),s;if(a){var c=Ln(this).constructor;s=Reflect.construct(r,arguments,c)}else s=r.apply(this,arguments);return no(this,s)}}function no(u,a){return a&&(wn(a)==="object"||typeof a=="function")?a:ro(u)}function ro(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}function so(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Ln(u){return Ln=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},Ln(u)}function Re(u,a){var i;if(typeof Symbol>"u"||u[Symbol.iterator]==null){if(Array.isArray(u)||(i=lo(u))||a&&u&&typeof u.length=="number"){i&&(u=i);var r=0,s=function(){};return{s,n:function(){return r>=u.length?{done:!0}:{done:!1,value:u[r++]}},e:function(f){throw f},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c=!0,t=!1,d;return{s:function(){i=u[Symbol.iterator]()},n:function(){var f=i.next();return c=f.done,f},e:function(f){t=!0,d=f},f:function(){try{!c&&i.return!=null&&i.return()}finally{if(t)throw d}}}}function lo(u,a){if(u){if(typeof u=="string")return oi(u,a);var i=Object.prototype.toString.call(u).slice(8,-1);if(i==="Object"&&u.constructor&&(i=u.constructor.name),i==="Map"||i==="Set")return Array.from(u);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return oi(u,a)}}function oi(u,a){(a==null||a>u.length)&&(a=u.length);for(var i=0,r=new Array(a);i<a;i++)r[i]=u[i];return r}function jt(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function fi(u,a){for(var i=0;i<a.length;i++){var r=a[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(u,r.key,r)}}function Jn(u,a,i){return a&&fi(u.prototype,a),i&&fi(u,i),u}var Sa=Pe,io=_e,me=he,ce=ye(),ci=rs(),ao=xe(),Rr=new io("SIPMessage"),Ea=function(){function u(a,i,r,s,c,t){if(jt(this,u),!a||!i||!r)return null;s=s||{},this.ua=r,this.headers={},this.method=a,this.ruri=i,this.body=t,this.extraHeaders=ce.cloneArray(c),this.ua.configuration.extra_headers&&(this.extraHeaders=this.extraHeaders.concat(this.ua.configuration.extra_headers)),s.route_set?this.setHeader("route",s.route_set):r.configuration.use_preloaded_route&&this.setHeader("route","<".concat(r.transport.sip_uri,";lr>")),this.setHeader("via",""),this.setHeader("max-forwards",me.MAX_FORWARDS);var d=s.to_uri||i,m=s.to_tag?{tag:s.to_tag}:null,f=typeof s.to_display_name<"u"?s.to_display_name:null;this.to=new ci(d,f,m),this.setHeader("to",this.to.toString());var p=s.from_uri||r.configuration.uri,v={tag:s.from_tag||ce.newTag()},g;typeof s.from_display_name<"u"?g=s.from_display_name:r.configuration.display_name?g=r.configuration.display_name:g=null,this.from=new ci(p,g,v),this.setHeader("from",this.from.toString());var S=s.call_id||r.configuration.jssip_id+ce.createRandomToken(15);this.call_id=S,this.setHeader("call-id",S);var E=s.cseq||Math.floor(Math.random()*1e4);this.cseq=E,this.setHeader("cseq","".concat(E," ").concat(a))}return Jn(u,[{key:"setHeader",value:function(i,r){for(var s=new RegExp("^\\s*".concat(i,"\\s*:"),"i"),c=0;c<this.extraHeaders.length;c++)s.test(this.extraHeaders[c])&&this.extraHeaders.splice(c,1);this.headers[ce.headerize(i)]=Array.isArray(r)?r:[r]}},{key:"getHeader",value:function(i){var r=this.headers[ce.headerize(i)];if(r){if(r[0])return r[0]}else{var s=new RegExp("^\\s*".concat(i,"\\s*:"),"i"),c=Re(this.extraHeaders),t;try{for(c.s();!(t=c.n()).done;){var d=t.value;if(s.test(d))return d.substring(d.indexOf(":")+1).trim()}}catch(m){c.e(m)}finally{c.f()}}}},{key:"getHeaders",value:function(i){var r=this.headers[ce.headerize(i)],s=[];if(r){var c=Re(r),t;try{for(c.s();!(t=c.n()).done;){var d=t.value;s.push(d)}}catch(g){c.e(g)}finally{c.f()}return s}else{var m=new RegExp("^\\s*".concat(i,"\\s*:"),"i"),f=Re(this.extraHeaders),p;try{for(f.s();!(p=f.n()).done;){var v=p.value;m.test(v)&&s.push(v.substring(v.indexOf(":")+1).trim())}}catch(g){f.e(g)}finally{f.f()}return s}}},{key:"hasHeader",value:function(i){if(this.headers[ce.headerize(i)])return!0;var r=new RegExp("^\\s*".concat(i,"\\s*:"),"i"),s=Re(this.extraHeaders),c;try{for(s.s();!(c=s.n()).done;){var t=c.value;if(r.test(t))return!0}}catch(d){s.e(d)}finally{s.f()}return!1}},{key:"parseSDP",value:function(i){return!i&&this.sdp?this.sdp:(this.sdp=Sa.parse(this.body||""),this.sdp)}},{key:"toString",value:function(){var i="".concat(this.method," ").concat(this.ruri,` SIP/2.0\r
`);for(var r in this.headers)if(Object.prototype.hasOwnProperty.call(this.headers,r)){var s=Re(this.headers[r]),c;try{for(s.s();!(c=s.n()).done;){var t=c.value;i+="".concat(r,": ").concat(t,`\r
`)}}catch(S){s.e(S)}finally{s.f()}}var d=Re(this.extraHeaders),m;try{for(d.s();!(m=d.n()).done;){var f=m.value;i+="".concat(f.trim(),`\r
`)}}catch(S){d.e(S)}finally{d.f()}var p=[];switch(this.method){case me.REGISTER:p.push("path","gruu");break;case me.INVITE:this.ua.configuration.session_timers&&p.push("timer"),(this.ua.contact.pub_gruu||this.ua.contact.temp_gruu)&&p.push("gruu"),p.push("ice","replaces");break;case me.UPDATE:this.ua.configuration.session_timers&&p.push("timer"),p.push("ice");break}p.push("outbound");var v=this.ua.configuration.user_agent||me.USER_AGENT;if(i+="Allow: ".concat(me.ALLOWED_METHODS,`\r
`),i+="Supported: ".concat(p,`\r
`),i+="User-Agent: ".concat(v,`\r
`),this.body){var g=ce.str_utf8_length(this.body);i+="Content-Length: ".concat(g,`\r
\r
`),i+=this.body}else i+=`Content-Length: 0\r
\r
`;return i}},{key:"clone",value:function(){var i=new u(this.method,this.ruri,this.ua);return Object.keys(this.headers).forEach(function(r){i.headers[r]=this.headers[r].slice()},this),i.body=this.body,i.extraHeaders=ce.cloneArray(this.extraHeaders),i.to=this.to,i.from=this.from,i.call_id=this.call_id,i.cseq=this.cseq,i}}]),u}(),uo=function(u){is(i,u);var a=as(i);function i(r,s,c,t,d){var m;return jt(this,i),m=a.call(this,me.INVITE,r,s,c,t,d),m.transaction=null,m}return Jn(i,[{key:"cancel",value:function(s){this.transaction.cancel(s)}},{key:"clone",value:function(){var s=new i(this.ruri,this.ua);return Object.keys(this.headers).forEach(function(c){s.headers[c]=this.headers[c].slice()},this),s.body=this.body,s.extraHeaders=ce.cloneArray(this.extraHeaders),s.to=this.to,s.from=this.from,s.call_id=this.call_id,s.cseq=this.cseq,s.transaction=this.transaction,s}}]),i}(Ea),Ca=function(){function u(){jt(this,u),this.data=null,this.headers=null,this.method=null,this.via=null,this.via_branch=null,this.call_id=null,this.cseq=null,this.from=null,this.from_tag=null,this.to=null,this.to_tag=null,this.body=null,this.sdp=null}return Jn(u,[{key:"addHeader",value:function(i,r){var s={raw:r};i=ce.headerize(i),this.headers[i]?this.headers[i].push(s):this.headers[i]=[s]}},{key:"getHeader",value:function(i){var r=this.headers[ce.headerize(i)];if(r){if(r[0])return r[0].raw}else return}},{key:"getHeaders",value:function(i){var r=this.headers[ce.headerize(i)],s=[];if(!r)return[];var c=Re(r),t;try{for(c.s();!(t=c.n()).done;){var d=t.value;s.push(d.raw)}}catch(m){c.e(m)}finally{c.f()}return s}},{key:"hasHeader",value:function(i){return!!this.headers[ce.headerize(i)]}},{key:"parseHeader",value:function(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(i=ce.headerize(i),this.headers[i]){if(r>=this.headers[i].length){Rr.debug('not so many "'.concat(i,'" headers present'));return}}else{Rr.debug('header "'.concat(i,'" not present'));return}var s=this.headers[i][r],c=s.raw;if(s.parsed)return s.parsed;var t=ao.parse(c,i.replace(/-/g,"_"));if(t===-1){this.headers[i].splice(r,1),Rr.debug('error parsing "'.concat(i,'" header field with value "').concat(c,'"'));return}else return s.parsed=t,t}},{key:"s",value:function(i,r){return this.parseHeader(i,r)}},{key:"setHeader",value:function(i,r){var s={raw:r};this.headers[ce.headerize(i)]=[s]}},{key:"parseSDP",value:function(i){return!i&&this.sdp?this.sdp:(this.sdp=Sa.parse(this.body||""),this.sdp)}},{key:"toString",value:function(){return this.data}}]),u}(),oo=function(u){is(i,u);var a=as(i);function i(r){var s;return jt(this,i),s=a.call(this),s.ua=r,s.headers={},s.ruri=null,s.transport=null,s.server_transaction=null,s}return Jn(i,[{key:"reply",value:function(s,c,t,d,m,f){var p=[],v=this.getHeader("To");if(s=s||null,c=c||null,!s||s<100||s>699)throw new TypeError("Invalid status_code: ".concat(s));if(c&&typeof c!="string"&&!(c instanceof String))throw new TypeError("Invalid reason_phrase: ".concat(c));c=c||me.REASON_PHRASE[s]||"",t=ce.cloneArray(t),this.ua.configuration.extra_headers&&(t=t.concat(this.ua.configuration.extra_headers));var g="SIP/2.0 ".concat(s," ").concat(c,`\r
`);if(this.method===me.INVITE&&s>100&&s<=200){var S=this.getHeaders("record-route"),E=Re(S),N;try{for(E.s();!(N=E.n()).done;){var H=N.value;g+="Record-Route: ".concat(H,`\r
`)}}catch(O){E.e(O)}finally{E.f()}}var U=this.getHeaders("via"),q=Re(U),G;try{for(q.s();!(G=q.n()).done;){var z=G.value;g+="Via: ".concat(z,`\r
`)}}catch(O){q.e(O)}finally{q.f()}!this.to_tag&&s>100?v+=";tag=".concat(ce.newTag()):this.to_tag&&!this.s("to").hasParam("tag")&&(v+=";tag=".concat(this.to_tag)),g+="To: ".concat(v,`\r
`),g+="From: ".concat(this.getHeader("From"),`\r
`),g+="Call-ID: ".concat(this.call_id,`\r
`),g+="CSeq: ".concat(this.cseq," ").concat(this.method,`\r
`);var Y=Re(t),ue;try{for(Y.s();!(ue=Y.n()).done;){var Z=ue.value;g+="".concat(Z.trim(),`\r
`)}}catch(O){Y.e(O)}finally{Y.f()}switch(this.method){case me.INVITE:this.ua.configuration.session_timers&&p.push("timer"),(this.ua.contact.pub_gruu||this.ua.contact.temp_gruu)&&p.push("gruu"),p.push("ice","replaces");break;case me.UPDATE:this.ua.configuration.session_timers&&p.push("timer"),d&&p.push("ice"),p.push("replaces")}if(p.push("outbound"),this.method===me.OPTIONS?(g+="Allow: ".concat(me.ALLOWED_METHODS,`\r
`),g+="Accept: ".concat(me.ACCEPTED_BODY_TYPES,`\r
`)):s===405?g+="Allow: ".concat(me.ALLOWED_METHODS,`\r
`):s===415&&(g+="Accept: ".concat(me.ACCEPTED_BODY_TYPES,`\r
`)),g+="Supported: ".concat(p,`\r
`),d){var D=ce.str_utf8_length(d);g+=`Content-Type: application/sdp\r
`,g+="Content-Length: ".concat(D,`\r
\r
`),g+=d}else g+="Content-Length: ".concat(0,`\r
\r
`);this.server_transaction.receiveResponse(s,g,m,f)}},{key:"reply_sl",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=this.getHeaders("via");if(!s||s<100||s>699)throw new TypeError("Invalid status_code: ".concat(s));if(c&&typeof c!="string"&&!(c instanceof String))throw new TypeError("Invalid reason_phrase: ".concat(c));c=c||me.REASON_PHRASE[s]||"";var d="SIP/2.0 ".concat(s," ").concat(c,`\r
`),m=Re(t),f;try{for(m.s();!(f=m.n()).done;){var p=f.value;d+="Via: ".concat(p,`\r
`)}}catch(N){m.e(N)}finally{m.f()}var v=this.getHeader("To");if(!this.to_tag&&s>100?v+=";tag=".concat(ce.newTag()):this.to_tag&&!this.s("to").hasParam("tag")&&(v+=";tag=".concat(this.to_tag)),d+="To: ".concat(v,`\r
`),d+="From: ".concat(this.getHeader("From"),`\r
`),d+="Call-ID: ".concat(this.call_id,`\r
`),d+="CSeq: ".concat(this.cseq," ").concat(this.method,`\r
`),this.ua.configuration.extra_headers){var g=Re(this.ua.configuration.extra_headers),S;try{for(g.s();!(S=g.n()).done;){var E=S.value;d+="".concat(E.trim(),`\r
`)}}catch(N){g.e(N)}finally{g.f()}}d+="Content-Length: ".concat(0,`\r
\r
`),this.transport.send(d)}}]),i}(Ca),fo=function(u){is(i,u);var a=as(i);function i(){var r;return jt(this,i),r=a.call(this),r.headers={},r.status_code=null,r.reason_phrase=null,r}return i}(Ca),$e={OutgoingRequest:Ea,InitialOutgoingInviteRequest:uo,IncomingRequest:oo,IncomingResponse:fo};function co(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function hi(u,a){for(var i=0;i<a.length;i++){var r=a[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(u,r.key,r)}}function ho(u,a,i){return a&&hi(u.prototype,a),i&&hi(u,i),u}var _o=_e,Le=ye(),we=new _o("DigestAuthentication"),po=function(){function u(a){co(this,u),this._credentials=a,this._cnonce=null,this._nc=0,this._ncHex="00000000",this._algorithm=null,this._realm=null,this._nonce=null,this._opaque=null,this._stale=null,this._qop=null,this._method=null,this._uri=null,this._ha1=null,this._response=null}return ho(u,[{key:"get",value:function(i){switch(i){case"realm":return this._realm;case"ha1":return this._ha1;default:we.warn('get() | cannot get "%s" parameter',i);return}}},{key:"authenticate",value:function(i,r){var s=i.method,c=i.ruri,t=i.body,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(this._algorithm=r.algorithm,this._realm=r.realm,this._nonce=r.nonce,this._opaque=r.opaque,this._stale=r.stale,this._algorithm){if(this._algorithm!=="MD5")return we.warn('authenticate() | challenge with Digest algorithm different than "MD5", authentication aborted'),!1}else this._algorithm="MD5";if(!this._nonce)return we.warn("authenticate() | challenge without Digest nonce, authentication aborted"),!1;if(!this._realm)return we.warn("authenticate() | challenge without Digest realm, authentication aborted"),!1;if(!this._credentials.password){if(!this._credentials.ha1)return we.warn("authenticate() | no plain SIP password nor ha1 provided, authentication aborted"),!1;if(this._credentials.realm!==this._realm)return we.warn('authenticate() | no plain SIP password, and stored `realm` does not match the given `realm`, cannot authenticate [stored:"%s", given:"%s"]',this._credentials.realm,this._realm),!1}if(r.qop)if(r.qop.indexOf("auth-int")>-1)this._qop="auth-int";else if(r.qop.indexOf("auth")>-1)this._qop="auth";else return we.warn('authenticate() | challenge without Digest qop different than "auth" or "auth-int", authentication aborted'),!1;else this._qop=null;this._method=s,this._uri=c,this._cnonce=d||Le.createRandomToken(12),this._nc+=1;var m=Number(this._nc).toString(16);this._ncHex="00000000".substr(0,8-m.length)+m,this._nc===4294967296&&(this._nc=1,this._ncHex="00000001"),this._credentials.password?this._ha1=Le.calculateMD5("".concat(this._credentials.username,":").concat(this._realm,":").concat(this._credentials.password)):this._ha1=this._credentials.ha1;var f,p;return this._qop==="auth"?(f="".concat(this._method,":").concat(this._uri),p=Le.calculateMD5(f),we.debug('authenticate() | using qop=auth [a2:"%s"]',f),this._response=Le.calculateMD5("".concat(this._ha1,":").concat(this._nonce,":").concat(this._ncHex,":").concat(this._cnonce,":auth:").concat(p))):this._qop==="auth-int"?(f="".concat(this._method,":").concat(this._uri,":").concat(Le.calculateMD5(t||"")),p=Le.calculateMD5(f),we.debug('authenticate() | using qop=auth-int [a2:"%s"]',f),this._response=Le.calculateMD5("".concat(this._ha1,":").concat(this._nonce,":").concat(this._ncHex,":").concat(this._cnonce,":auth-int:").concat(p))):this._qop===null&&(f="".concat(this._method,":").concat(this._uri),p=Le.calculateMD5(f),we.debug('authenticate() | using qop=null [a2:"%s"]',f),this._response=Le.calculateMD5("".concat(this._ha1,":").concat(this._nonce,":").concat(p))),we.debug("authenticate() | response generated"),!0}},{key:"toString",value:function(){var i=[];if(!this._response)throw new Error("response field does not exist, cannot generate Authorization header");return i.push("algorithm=".concat(this._algorithm)),i.push('username="'.concat(this._credentials.username,'"')),i.push('realm="'.concat(this._realm,'"')),i.push('nonce="'.concat(this._nonce,'"')),i.push('uri="'.concat(this._uri,'"')),i.push('response="'.concat(this._response,'"')),this._opaque&&i.push('opaque="'.concat(this._opaque,'"')),this._qop&&(i.push("qop=".concat(this._qop)),i.push('cnonce="'.concat(this._cnonce,'"')),i.push("nc=".concat(this._ncHex))),"Digest ".concat(i.join(", "))}}]),u}(),He=500,vo=4e3,di=5e3,ba={T1:He,T2:vo,T4:di,TIMER_B:64*He,TIMER_D:0*He,TIMER_F:64*He,TIMER_H:64*He,TIMER_I:0*He,TIMER_J:0*He,TIMER_K:0*di,TIMER_L:64*He,TIMER_M:64*He,PROVISIONAL_RESPONSE_INTERVAL:6e4};function In(u){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?In=function(i){return typeof i}:In=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},In(u)}function Bt(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function _i(u,a){for(var i=0;i<a.length;i++){var r=a[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(u,r.key,r)}}function Gt(u,a,i){return a&&_i(u.prototype,a),i&&_i(u,i),u}function Wt(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&Vr(u,a)}function Vr(u,a){return Vr=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},Vr(u,a)}function Vt(u){var a=go();return function(){var r=Hn(u),s;if(a){var c=Hn(this).constructor;s=Reflect.construct(r,arguments,c)}else s=r.apply(this,arguments);return mo(this,s)}}function mo(u,a){return a&&(In(a)==="object"||typeof a=="function")?a:Je(u)}function Je(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}function go(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Hn(u){return Hn=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},Hn(u)}var Kt=Ze.EventEmitter,zt=_e,Lt=he,pi=$e,De=ba,vi=new zt("NonInviteClientTransaction"),dn=new zt("InviteClientTransaction"),yo=new zt("AckClientTransaction"),mi=new zt("NonInviteServerTransaction"),_n=new zt("InviteServerTransaction"),L={STATUS_TRYING:1,STATUS_PROCEEDING:2,STATUS_CALLING:3,STATUS_ACCEPTED:4,STATUS_COMPLETED:5,STATUS_TERMINATED:6,STATUS_CONFIRMED:7,NON_INVITE_CLIENT:"nict",NON_INVITE_SERVER:"nist",INVITE_CLIENT:"ict",INVITE_SERVER:"ist"},To=function(u){Wt(i,u);var a=Vt(i);function i(r,s,c,t){var d;Bt(this,i),d=a.call(this),d.type=L.NON_INVITE_CLIENT,d.id="z9hG4bK".concat(Math.floor(Math.random()*1e7)),d.ua=r,d.transport=s,d.request=c,d.eventHandlers=t;var m="SIP/2.0/".concat(s.via_transport);return m+=" ".concat(r.configuration.via_host,";branch=").concat(d.id),d.request.setHeader("via",m),d.ua.newTransaction(Je(d)),d}return Gt(i,[{key:"stateChanged",value:function(s){this.state=s,this.emit("stateChanged")}},{key:"send",value:function(){var s=this;this.stateChanged(L.STATUS_TRYING),this.F=setTimeout(function(){s.timer_F()},De.TIMER_F),this.transport.send(this.request)||this.onTransportError()}},{key:"onTransportError",value:function(){vi.debug("transport error occurred, deleting transaction ".concat(this.id)),clearTimeout(this.F),clearTimeout(this.K),this.stateChanged(L.STATUS_TERMINATED),this.ua.destroyTransaction(this),this.eventHandlers.onTransportError()}},{key:"timer_F",value:function(){vi.debug("Timer F expired for transaction ".concat(this.id)),this.stateChanged(L.STATUS_TERMINATED),this.ua.destroyTransaction(this),this.eventHandlers.onRequestTimeout()}},{key:"timer_K",value:function(){this.stateChanged(L.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"receiveResponse",value:function(s){var c=this,t=s.status_code;if(t<200)switch(this.state){case L.STATUS_TRYING:case L.STATUS_PROCEEDING:this.stateChanged(L.STATUS_PROCEEDING),this.eventHandlers.onReceiveResponse(s);break}else switch(this.state){case L.STATUS_TRYING:case L.STATUS_PROCEEDING:this.stateChanged(L.STATUS_COMPLETED),clearTimeout(this.F),t===408?this.eventHandlers.onRequestTimeout():this.eventHandlers.onReceiveResponse(s),this.K=setTimeout(function(){c.timer_K()},De.TIMER_K);break;case L.STATUS_COMPLETED:break}}},{key:"C",get:function(){return L}}]),i}(Kt),So=function(u){Wt(i,u);var a=Vt(i);function i(r,s,c,t){var d;Bt(this,i),d=a.call(this),d.type=L.INVITE_CLIENT,d.id="z9hG4bK".concat(Math.floor(Math.random()*1e7)),d.ua=r,d.transport=s,d.request=c,d.eventHandlers=t,c.transaction=Je(d);var m="SIP/2.0/".concat(s.via_transport);return m+=" ".concat(r.configuration.via_host,";branch=").concat(d.id),d.request.setHeader("via",m),d.ua.newTransaction(Je(d)),d}return Gt(i,[{key:"stateChanged",value:function(s){this.state=s,this.emit("stateChanged")}},{key:"send",value:function(){var s=this;this.stateChanged(L.STATUS_CALLING),this.B=setTimeout(function(){s.timer_B()},De.TIMER_B),this.transport.send(this.request)||this.onTransportError()}},{key:"onTransportError",value:function(){clearTimeout(this.B),clearTimeout(this.D),clearTimeout(this.M),this.state!==L.STATUS_ACCEPTED&&(dn.debug("transport error occurred, deleting transaction ".concat(this.id)),this.eventHandlers.onTransportError()),this.stateChanged(L.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"timer_M",value:function(){dn.debug("Timer M expired for transaction ".concat(this.id)),this.state===L.STATUS_ACCEPTED&&(clearTimeout(this.B),this.stateChanged(L.STATUS_TERMINATED),this.ua.destroyTransaction(this))}},{key:"timer_B",value:function(){dn.debug("Timer B expired for transaction ".concat(this.id)),this.state===L.STATUS_CALLING&&(this.stateChanged(L.STATUS_TERMINATED),this.ua.destroyTransaction(this),this.eventHandlers.onRequestTimeout())}},{key:"timer_D",value:function(){dn.debug("Timer D expired for transaction ".concat(this.id)),clearTimeout(this.B),this.stateChanged(L.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"sendACK",value:function(s){var c=this,t=new pi.OutgoingRequest(Lt.ACK,this.request.ruri,this.ua,{route_set:this.request.getHeaders("route"),call_id:this.request.getHeader("call-id"),cseq:this.request.cseq});t.setHeader("from",this.request.getHeader("from")),t.setHeader("via",this.request.getHeader("via")),t.setHeader("to",s.getHeader("to")),this.D=setTimeout(function(){c.timer_D()},De.TIMER_D),this.transport.send(t)}},{key:"cancel",value:function(s){if(this.state===L.STATUS_PROCEEDING){var c=new pi.OutgoingRequest(Lt.CANCEL,this.request.ruri,this.ua,{route_set:this.request.getHeaders("route"),call_id:this.request.getHeader("call-id"),cseq:this.request.cseq});c.setHeader("from",this.request.getHeader("from")),c.setHeader("via",this.request.getHeader("via")),c.setHeader("to",this.request.getHeader("to")),s&&c.setHeader("reason",s),this.transport.send(c)}}},{key:"receiveResponse",value:function(s){var c=this,t=s.status_code;if(t>=100&&t<=199)switch(this.state){case L.STATUS_CALLING:this.stateChanged(L.STATUS_PROCEEDING),this.eventHandlers.onReceiveResponse(s);break;case L.STATUS_PROCEEDING:this.eventHandlers.onReceiveResponse(s);break}else if(t>=200&&t<=299)switch(this.state){case L.STATUS_CALLING:case L.STATUS_PROCEEDING:this.stateChanged(L.STATUS_ACCEPTED),this.M=setTimeout(function(){c.timer_M()},De.TIMER_M),this.eventHandlers.onReceiveResponse(s);break;case L.STATUS_ACCEPTED:this.eventHandlers.onReceiveResponse(s);break}else if(t>=300&&t<=699)switch(this.state){case L.STATUS_CALLING:case L.STATUS_PROCEEDING:this.stateChanged(L.STATUS_COMPLETED),this.sendACK(s),this.eventHandlers.onReceiveResponse(s);break;case L.STATUS_COMPLETED:this.sendACK(s);break}}},{key:"C",get:function(){return L}}]),i}(Kt),Eo=function(u){Wt(i,u);var a=Vt(i);function i(r,s,c,t){var d;Bt(this,i),d=a.call(this),d.id="z9hG4bK".concat(Math.floor(Math.random()*1e7)),d.transport=s,d.request=c,d.eventHandlers=t;var m="SIP/2.0/".concat(s.via_transport);return m+=" ".concat(r.configuration.via_host,";branch=").concat(d.id),d.request.setHeader("via",m),d}return Gt(i,[{key:"send",value:function(){this.transport.send(this.request)||this.onTransportError()}},{key:"onTransportError",value:function(){yo.debug("transport error occurred for transaction ".concat(this.id)),this.eventHandlers.onTransportError()}},{key:"C",get:function(){return L}}]),i}(Kt),Co=function(u){Wt(i,u);var a=Vt(i);function i(r,s,c){var t;return Bt(this,i),t=a.call(this),t.type=L.NON_INVITE_SERVER,t.id=c.via_branch,t.ua=r,t.transport=s,t.request=c,t.last_response="",c.server_transaction=Je(t),t.state=L.STATUS_TRYING,r.newTransaction(Je(t)),t}return Gt(i,[{key:"stateChanged",value:function(s){this.state=s,this.emit("stateChanged")}},{key:"timer_J",value:function(){mi.debug("Timer J expired for transaction ".concat(this.id)),this.stateChanged(L.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"onTransportError",value:function(){this.transportError||(this.transportError=!0,mi.debug("transport error occurred, deleting transaction ".concat(this.id)),clearTimeout(this.J),this.stateChanged(L.STATUS_TERMINATED),this.ua.destroyTransaction(this))}},{key:"receiveResponse",value:function(s,c,t,d){var m=this;if(s===100)switch(this.state){case L.STATUS_TRYING:this.stateChanged(L.STATUS_PROCEEDING),this.transport.send(c)||this.onTransportError();break;case L.STATUS_PROCEEDING:this.last_response=c,this.transport.send(c)?t&&t():(this.onTransportError(),d&&d());break}else if(s>=200&&s<=699)switch(this.state){case L.STATUS_TRYING:case L.STATUS_PROCEEDING:this.stateChanged(L.STATUS_COMPLETED),this.last_response=c,this.J=setTimeout(function(){m.timer_J()},De.TIMER_J),this.transport.send(c)?t&&t():(this.onTransportError(),d&&d());break;case L.STATUS_COMPLETED:break}}},{key:"C",get:function(){return L}}]),i}(Kt),bo=function(u){Wt(i,u);var a=Vt(i);function i(r,s,c){var t;return Bt(this,i),t=a.call(this),t.type=L.INVITE_SERVER,t.id=c.via_branch,t.ua=r,t.transport=s,t.request=c,t.last_response="",c.server_transaction=Je(t),t.state=L.STATUS_PROCEEDING,r.newTransaction(Je(t)),t.resendProvisionalTimer=null,c.reply(100),t}return Gt(i,[{key:"stateChanged",value:function(s){this.state=s,this.emit("stateChanged")}},{key:"timer_H",value:function(){_n.debug("Timer H expired for transaction ".concat(this.id)),this.state===L.STATUS_COMPLETED&&_n.debug("ACK not received, dialog will be terminated"),this.stateChanged(L.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"timer_I",value:function(){this.stateChanged(L.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"timer_L",value:function(){_n.debug("Timer L expired for transaction ".concat(this.id)),this.state===L.STATUS_ACCEPTED&&(this.stateChanged(L.STATUS_TERMINATED),this.ua.destroyTransaction(this))}},{key:"onTransportError",value:function(){this.transportError||(this.transportError=!0,_n.debug("transport error occurred, deleting transaction ".concat(this.id)),this.resendProvisionalTimer!==null&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null),clearTimeout(this.L),clearTimeout(this.H),clearTimeout(this.I),this.stateChanged(L.STATUS_TERMINATED),this.ua.destroyTransaction(this))}},{key:"resend_provisional",value:function(){this.transport.send(this.last_response)||this.onTransportError()}},{key:"receiveResponse",value:function(s,c,t,d){var m=this;if(s>=100&&s<=199)switch(this.state){case L.STATUS_PROCEEDING:this.transport.send(c)||this.onTransportError(),this.last_response=c;break}if(s>100&&s<=199&&this.state===L.STATUS_PROCEEDING)this.resendProvisionalTimer===null&&(this.resendProvisionalTimer=setInterval(function(){m.resend_provisional()},De.PROVISIONAL_RESPONSE_INTERVAL));else if(s>=200&&s<=299)switch(this.state){case L.STATUS_PROCEEDING:this.stateChanged(L.STATUS_ACCEPTED),this.last_response=c,this.L=setTimeout(function(){m.timer_L()},De.TIMER_L),this.resendProvisionalTimer!==null&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null);case L.STATUS_ACCEPTED:this.transport.send(c)?t&&t():(this.onTransportError(),d&&d());break}else if(s>=300&&s<=699)switch(this.state){case L.STATUS_PROCEEDING:this.resendProvisionalTimer!==null&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null),this.transport.send(c)?(this.stateChanged(L.STATUS_COMPLETED),this.H=setTimeout(function(){m.timer_H()},De.TIMER_H),t&&t()):(this.onTransportError(),d&&d());break}}},{key:"C",get:function(){return L}}]),i}(Kt);function Ao(u,a){var i=u._transactions,r;switch(a.method){case Lt.INVITE:if(r=i.ist[a.via_branch],r){switch(r.state){case L.STATUS_PROCEEDING:r.transport.send(r.last_response);break;case L.STATUS_ACCEPTED:break}return!0}break;case Lt.ACK:if(r=i.ist[a.via_branch],r){if(r.state===L.STATUS_ACCEPTED)return!1;if(r.state===L.STATUS_COMPLETED)return r.state=L.STATUS_CONFIRMED,r.I=setTimeout(function(){r.timer_I()},De.TIMER_I),!0}else return!1;break;case Lt.CANCEL:return r=i.ist[a.via_branch],r?(a.reply_sl(200),r.state!==L.STATUS_PROCEEDING):(a.reply_sl(481),!0);default:if(r=i.nist[a.via_branch],r){switch(r.state){case L.STATUS_TRYING:break;case L.STATUS_PROCEEDING:case L.STATUS_COMPLETED:r.transport.send(r.last_response);break}return!0}break}}var Yt={C:L,NonInviteClientTransaction:To,InviteClientTransaction:So,AckClientTransaction:Eo,NonInviteServerTransaction:Co,InviteServerTransaction:bo,checkTransaction:Ao};function Ro(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function gi(u,a){for(var i=0;i<a.length;i++){var r=a[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(u,r.key,r)}}function wo(u,a,i){return a&&gi(u.prototype,a),i&&gi(u,i),u}var Io=_e,yi=he,Oo=po,wr=Yt,No=new Io("RequestSender"),Ir={onRequestTimeout:function(){},onTransportError:function(){},onReceiveResponse:function(){},onAuthenticated:function(){}},Jt=function(){function u(a,i,r){Ro(this,u),this._ua=a,this._eventHandlers=r,this._method=i.method,this._request=i,this._auth=null,this._challenged=!1,this._staled=!1;for(var s in Ir)Object.prototype.hasOwnProperty.call(Ir,s)&&(this._eventHandlers[s]||(this._eventHandlers[s]=Ir[s]));a.status===a.C.STATUS_USER_CLOSED&&(this._method!==yi.BYE||this._method!==yi.ACK)&&this._eventHandlers.onTransportError()}return wo(u,[{key:"send",value:function(){var i=this,r={onRequestTimeout:function(){i._eventHandlers.onRequestTimeout()},onTransportError:function(){i._eventHandlers.onTransportError()},onReceiveResponse:function(c){i._receiveResponse(c)}};switch(this._method){case"INVITE":this.clientTransaction=new wr.InviteClientTransaction(this._ua,this._ua.transport,this._request,r);break;case"ACK":this.clientTransaction=new wr.AckClientTransaction(this._ua,this._ua.transport,this._request,r);break;default:this.clientTransaction=new wr.NonInviteClientTransaction(this._ua,this._ua.transport,this._request,r)}this._ua._configuration.authorization_jwt&&this._request.setHeader("Authorization",this._ua._configuration.authorization_jwt),this.clientTransaction.send()}},{key:"_receiveResponse",value:function(i){var r,s,c=i.status_code;if((c===401||c===407)&&(this._ua.configuration.password!==null||this._ua.configuration.ha1!==null)){if(i.status_code===401?(r=i.parseHeader("www-authenticate"),s="authorization"):(r=i.parseHeader("proxy-authenticate"),s="proxy-authorization"),!r){No.debug("".concat(i.status_code," with wrong or missing challenge, cannot authenticate")),this._eventHandlers.onReceiveResponse(i);return}if(!this._challenged||!this._staled&&r.stale===!0){if(this._auth||(this._auth=new Oo({username:this._ua.configuration.authorization_user,password:this._ua.configuration.password,realm:this._ua.configuration.realm,ha1:this._ua.configuration.ha1})),!this._auth.authenticate(this._request,r)){this._eventHandlers.onReceiveResponse(i);return}this._challenged=!0,this._ua.set("realm",this._auth.get("realm")),this._ua.set("ha1",this._auth.get("ha1")),r.stale&&(this._staled=!0),this._request=this._request.clone(),this._request.cseq+=1,this._request.setHeader("cseq","".concat(this._request.cseq," ").concat(this._method)),this._request.setHeader(s,this._auth.toString()),this._eventHandlers.onAuthenticated(this._request),this.send()}else this._eventHandlers.onReceiveResponse(i)}else this._eventHandlers.onReceiveResponse(i)}}]),u}();function ko(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function Ti(u,a){for(var i=0;i<a.length;i++){var r=a[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(u,r.key,r)}}function Do(u,a,i){return a&&Ti(u.prototype,a),i&&Ti(u,i),u}var xo=_e,Or=ye(),at=he,Si=$e,Ei=Jt,Nt=new xo("Registrator"),pn=10,Po=function(){function u(a,i){ko(this,u),this._reg_id=1,this._ua=a,this._transport=i,this._registrar=a.configuration.registrar_server,this._expires=a.configuration.register_expires,this._call_id=Or.createRandomToken(22),this._cseq=0,this._to_uri=a.configuration.uri,this._registrationTimer=null,this._registering=!1,this._registered=!1,this._contact=this._ua.contact.toString(),this._contact+=";+sip.ice",this._extraHeaders=[],this._extraContactParams="",this._sipInstance='"<urn:uuid:'.concat(this._ua.configuration.instance_id,'>"'),this._contact+=";reg-id=".concat(this._reg_id),this._contact+=";+sip.instance=".concat(this._sipInstance)}return Do(u,[{key:"setExtraHeaders",value:function(i){Array.isArray(i)||(i=[]),this._extraHeaders=i.slice()}},{key:"setExtraContactParams",value:function(i){i instanceof Object||(i={}),this._extraContactParams="";for(var r in i)if(Object.prototype.hasOwnProperty.call(i,r)){var s=i[r];this._extraContactParams+=";".concat(r),s&&(this._extraContactParams+="=".concat(s))}}},{key:"register",value:function(){var i=this;if(this._registering){Nt.debug("Register request in progress...");return}var r=this._extraHeaders.slice();r.push("Contact: ".concat(this._contact,";expires=").concat(this._expires).concat(this._extraContactParams)),r.push("Expires: ".concat(this._expires));var s=new Si.OutgoingRequest(at.REGISTER,this._registrar,this._ua,{to_uri:this._to_uri,call_id:this._call_id,cseq:this._cseq+=1},r),c=new Ei(this._ua,s,{onRequestTimeout:function(){i._registrationFailure(null,at.causes.REQUEST_TIMEOUT)},onTransportError:function(){i._registrationFailure(null,at.causes.CONNECTION_ERROR)},onAuthenticated:function(){i._cseq+=1},onReceiveResponse:function(d){if(d.cseq===i._cseq)switch(i._registrationTimer!==null&&(clearTimeout(i._registrationTimer),i._registrationTimer=null),!0){case/^1[0-9]{2}$/.test(d.status_code):break;case/^2[0-9]{2}$/.test(d.status_code):{if(i._registering=!1,!d.hasHeader("Contact")){Nt.debug("no Contact header in response to REGISTER, response ignored");break}var m=d.headers.Contact.reduce(function(S,E){return S.concat(E.parsed)},[]),f=m.find(function(S){return i._sipInstance===S.getParam("+sip.instance")&&i._reg_id===parseInt(S.getParam("reg-id"))});if(f||(f=m.find(function(S){return S.uri.user===i._ua.contact.uri.user})),!f){Nt.debug("no Contact header pointing to us, response ignored");break}var p=f.getParam("expires");!p&&d.hasHeader("expires")&&(p=d.getHeader("expires")),p||(p=i._expires),p=Number(p),p<pn&&(p=pn);var v=p>64?p*1e3/2+Math.floor((p/2-32)*1e3*Math.random()):p*1e3-5e3;i._registrationTimer=setTimeout(function(){i._registrationTimer=null,i._ua.listeners("registrationExpiring").length===0?i.register():i._ua.emit("registrationExpiring")},v),f.hasParam("temp-gruu")&&(i._ua.contact.temp_gruu=f.getParam("temp-gruu").replace(/"/g,"")),f.hasParam("pub-gruu")&&(i._ua.contact.pub_gruu=f.getParam("pub-gruu").replace(/"/g,"")),i._registered||(i._registered=!0,i._ua.registered({response:d}));break}case/^423$/.test(d.status_code):{d.hasHeader("min-expires")?(i._expires=Number(d.getHeader("min-expires")),i._expires<pn&&(i._expires=pn),i.register()):(Nt.debug("423 response received for REGISTER without Min-Expires"),i._registrationFailure(d,at.causes.SIP_FAILURE_CODE));break}default:{var g=Or.sipErrorCause(d.status_code);i._registrationFailure(d,g)}}}});this._registering=!0,c.send()}},{key:"unregister",value:function(){var i=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this._registered){Nt.debug("already unregistered");return}this._registered=!1,this._registrationTimer!==null&&(clearTimeout(this._registrationTimer),this._registrationTimer=null);var s=this._extraHeaders.slice();r.all?s.push("Contact: *".concat(this._extraContactParams)):s.push("Contact: ".concat(this._contact,";expires=0").concat(this._extraContactParams)),s.push("Expires: 0");var c=new Si.OutgoingRequest(at.REGISTER,this._registrar,this._ua,{to_uri:this._to_uri,call_id:this._call_id,cseq:this._cseq+=1},s),t=new Ei(this._ua,c,{onRequestTimeout:function(){i._unregistered(null,at.causes.REQUEST_TIMEOUT)},onTransportError:function(){i._unregistered(null,at.causes.CONNECTION_ERROR)},onAuthenticated:function(){i._cseq+=1},onReceiveResponse:function(m){switch(!0){case/^1[0-9]{2}$/.test(m.status_code):break;case/^2[0-9]{2}$/.test(m.status_code):i._unregistered(m);break;default:{var f=Or.sipErrorCause(m.status_code);i._unregistered(m,f)}}}});t.send()}},{key:"close",value:function(){this._registered&&this.unregister()}},{key:"onTransportClosed",value:function(){this._registering=!1,this._registrationTimer!==null&&(clearTimeout(this._registrationTimer),this._registrationTimer=null),this._registered&&(this._registered=!1,this._ua.unregistered({}))}},{key:"_registrationFailure",value:function(i,r){this._registering=!1,this._ua.registrationFailed({response:i||null,cause:r}),this._registered&&(this._registered=!1,this._ua.unregistered({response:i||null,cause:r}))}},{key:"_unregistered",value:function(i,r){this._registering=!1,this._registered=!1,this._ua.unregistered({response:i||null,cause:r||null})}},{key:"registered",get:function(){return this._registered}}]),u}();function Uo(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function Ci(u,a){for(var i=0;i<a.length;i++){var r=a[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(u,r.key,r)}}function Mo(u,a,i){return a&&Ci(u.prototype,a),i&&Ci(u,i),u}var Nr=he,vn=Yt,Lo=Jt,kr={onRequestTimeout:function(){},onTransportError:function(){},onSuccessResponse:function(){},onErrorResponse:function(){},onAuthenticated:function(){},onDialogError:function(){}},Ho=function(){function u(a,i,r){Uo(this,u),this._dialog=a,this._ua=a._ua,this._request=i,this._eventHandlers=r,this._reattempt=!1,this._reattemptTimer=null;for(var s in kr)Object.prototype.hasOwnProperty.call(kr,s)&&(this._eventHandlers[s]||(this._eventHandlers[s]=kr[s]))}return Mo(u,[{key:"send",value:function(){var i=this,r=new Lo(this._ua,this._request,{onRequestTimeout:function(){i._eventHandlers.onRequestTimeout()},onTransportError:function(){i._eventHandlers.onTransportError()},onAuthenticated:function(t){i._eventHandlers.onAuthenticated(t)},onReceiveResponse:function(t){i._receiveResponse(t)}});if(r.send(),(this._request.method===Nr.INVITE||this._request.method===Nr.UPDATE&&this._request.body)&&r.clientTransaction.state!==vn.C.STATUS_TERMINATED){this._dialog.uac_pending_reply=!0;var s=function c(){(r.clientTransaction.state===vn.C.STATUS_ACCEPTED||r.clientTransaction.state===vn.C.STATUS_COMPLETED||r.clientTransaction.state===vn.C.STATUS_TERMINATED)&&(r.clientTransaction.removeListener("stateChanged",c),i._dialog.uac_pending_reply=!1)};r.clientTransaction.on("stateChanged",s)}}},{key:"_receiveResponse",value:function(i){var r=this;i.status_code===408||i.status_code===481?this._eventHandlers.onDialogError(i):i.method===Nr.INVITE&&i.status_code===491?this._reattempt?i.status_code>=200&&i.status_code<300?this._eventHandlers.onSuccessResponse(i):i.status_code>=300&&this._eventHandlers.onErrorResponse(i):(this._request.cseq=this._dialog.local_seqnum+=1,this._reattemptTimer=setTimeout(function(){r._dialog.isTerminated()||(r._reattempt=!0,r.send())},1e3)):i.status_code>=200&&i.status_code<300?this._eventHandlers.onSuccessResponse(i):i.status_code>=300&&this._eventHandlers.onErrorResponse(i)}},{key:"request",get:function(){return this._request}}]),u}();function Fo(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function bi(u,a){for(var i=0;i<a.length;i++){var r=a[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(u,r.key,r)}}function Ai(u,a,i){return a&&bi(u.prototype,a),i&&bi(u,i),u}var $o=_e,Ri=$e,ze=he,kt=Yt,qo=Ho,Dr=ye(),xr=new $o("Dialog"),Ye={STATUS_EARLY:1,STATUS_CONFIRMED:2,STATUS_TERMINATED:3},jo=function(){Ai(u,null,[{key:"C",get:function(){return Ye}}]);function u(a,i,r){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ye.STATUS_CONFIRMED;if(Fo(this,u),this._owner=a,this._ua=a._ua,this._uac_pending_reply=!1,this._uas_pending_reply=!1,!i.hasHeader("contact"))return{error:"unable to create a Dialog without Contact header field"};i instanceof Ri.IncomingResponse&&(s=i.status_code<200?Ye.STATUS_EARLY:Ye.STATUS_CONFIRMED);var c=i.parseHeader("contact");r==="UAS"?(this._id={call_id:i.call_id,local_tag:i.to_tag,remote_tag:i.from_tag,toString:function(){return this.call_id+this.local_tag+this.remote_tag}},this._state=s,this._remote_seqnum=i.cseq,this._local_uri=i.parseHeader("to").uri,this._remote_uri=i.parseHeader("from").uri,this._remote_target=c.uri,this._route_set=i.getHeaders("record-route"),this._ack_seqnum=this._remote_seqnum):r==="UAC"&&(this._id={call_id:i.call_id,local_tag:i.from_tag,remote_tag:i.to_tag,toString:function(){return this.call_id+this.local_tag+this.remote_tag}},this._state=s,this._local_seqnum=i.cseq,this._local_uri=i.parseHeader("from").uri,this._remote_uri=i.parseHeader("to").uri,this._remote_target=c.uri,this._route_set=i.getHeaders("record-route").reverse(),this._ack_seqnum=null),this._ua.newDialog(this),xr.debug("new ".concat(r," dialog created with status ").concat(this._state===Ye.STATUS_EARLY?"EARLY":"CONFIRMED"))}return Ai(u,[{key:"isTerminated",value:function(){return this._status===Ye.STATUS_TERMINATED}},{key:"update",value:function(i,r){this._state=Ye.STATUS_CONFIRMED,xr.debug("dialog ".concat(this._id.toString(),"  changed to CONFIRMED state")),r==="UAC"&&(this._route_set=i.getHeaders("record-route").reverse())}},{key:"terminate",value:function(){xr.debug("dialog ".concat(this._id.toString()," deleted")),this._ua.destroyDialog(this),this._state=Ye.STATUS_TERMINATED}},{key:"sendRequest",value:function(i){var r=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=Dr.cloneArray(s.extraHeaders),t=Dr.cloneObject(s.eventHandlers),d=s.body||null,m=this._createRequest(i,c,d);t.onAuthenticated=function(){r._local_seqnum+=1};var f=new qo(this,m,t);return f.send(),m}},{key:"receiveRequest",value:function(i){this._checkInDialogRequest(i)&&(i.method===ze.ACK&&this._ack_seqnum!==null?this._ack_seqnum=null:i.method===ze.INVITE&&(this._ack_seqnum=i.cseq),this._owner.receiveRequest(i))}},{key:"_createRequest",value:function(i,r,s){r=Dr.cloneArray(r),this._local_seqnum||(this._local_seqnum=Math.floor(Math.random()*1e4));var c=i===ze.CANCEL||i===ze.ACK?this._local_seqnum:this._local_seqnum+=1,t=new Ri.OutgoingRequest(i,this._remote_target,this._ua,{cseq:c,call_id:this._id.call_id,from_uri:this._local_uri,from_tag:this._id.local_tag,to_uri:this._remote_uri,to_tag:this._id.remote_tag,route_set:this._route_set},r,s);return t}},{key:"_checkInDialogRequest",value:function(i){var r=this;if(!this._remote_seqnum)this._remote_seqnum=i.cseq;else if(i.cseq<this._remote_seqnum)if(i.method===ze.ACK){if(this._ack_seqnum===null||i.cseq!==this._ack_seqnum)return!1}else return i.reply(500),!1;else i.cseq>this._remote_seqnum&&(this._remote_seqnum=i.cseq);if(i.method===ze.INVITE||i.method===ze.UPDATE&&i.body){if(this._uac_pending_reply===!0)i.reply(491);else if(this._uas_pending_reply===!0){var s=(Math.random()*10|0)+1;return i.reply(500,null,["Retry-After:".concat(s)]),!1}else{this._uas_pending_reply=!0;var c=function t(){(i.server_transaction.state===kt.C.STATUS_ACCEPTED||i.server_transaction.state===kt.C.STATUS_COMPLETED||i.server_transaction.state===kt.C.STATUS_TERMINATED)&&(i.server_transaction.removeListener("stateChanged",t),r._uas_pending_reply=!1)};i.server_transaction.on("stateChanged",c)}i.hasHeader("contact")&&i.server_transaction.on("stateChanged",function(){i.server_transaction.state===kt.C.STATUS_ACCEPTED&&(r._remote_target=i.parseHeader("contact").uri)})}else i.method===ze.NOTIFY&&i.hasHeader("contact")&&i.server_transaction.on("stateChanged",function(){i.server_transaction.state===kt.C.STATUS_COMPLETED&&(r._remote_target=i.parseHeader("contact").uri)});return!0}},{key:"id",get:function(){return this._id}},{key:"local_seqnum",get:function(){return this._local_seqnum},set:function(i){this._local_seqnum=i}},{key:"owner",get:function(){return this._owner}},{key:"uac_pending_reply",get:function(){return this._uac_pending_reply},set:function(i){this._uac_pending_reply=i}},{key:"uas_pending_reply",get:function(){return this._uas_pending_reply}}]),u}(),us={exports:{}};function On(u){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?On=function(i){return typeof i}:On=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},On(u)}function Bo(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function wi(u,a){for(var i=0;i<a.length;i++){var r=a[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(u,r.key,r)}}function Go(u,a,i){return a&&wi(u.prototype,a),i&&wi(u,i),u}function Wo(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&Kr(u,a)}function Kr(u,a){return Kr=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},Kr(u,a)}function Vo(u){var a=Yo();return function(){var r=Fn(u),s;if(a){var c=Fn(this).constructor;s=Reflect.construct(r,arguments,c)}else s=r.apply(this,arguments);return Ko(this,s)}}function Ko(u,a){return a&&(On(a)==="object"||typeof a=="function")?a:zo(u)}function zo(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}function Yo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Fn(u){return Fn=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},Fn(u)}var Jo=Ze.EventEmitter,Xo=_e,Qo=he,Zo=Xe,Ii=ye(),ef=new Xo("RTCSession:DTMF"),Aa={MIN_DURATION:70,MAX_DURATION:6e3,DEFAULT_DURATION:100,MIN_INTER_TONE_GAP:50,DEFAULT_INTER_TONE_GAP:500};us.exports=function(u){Wo(i,u);var a=Vo(i);function i(r){var s;return Bo(this,i),s=a.call(this),s._session=r,s._direction=null,s._tone=null,s._duration=null,s._request=null,s}return Go(i,[{key:"send",value:function(s){var c=this,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(s===void 0)throw new TypeError("Not enough arguments");if(this._direction="outgoing",this._session.status!==this._session.C.STATUS_CONFIRMED&&this._session.status!==this._session.C.STATUS_WAITING_FOR_ACK)throw new Zo.InvalidStateError(this._session.status);var d=Ii.cloneArray(t.extraHeaders);if(this.eventHandlers=Ii.cloneObject(t.eventHandlers),typeof s=="string")s=s.toUpperCase();else if(typeof s=="number")s=s.toString();else throw new TypeError("Invalid tone: ".concat(s));if(s.match(/^[0-9A-DR#*]$/))this._tone=s;else throw new TypeError("Invalid tone: ".concat(s));this._duration=t.duration,d.push("Content-Type: application/dtmf-relay");var m="Signal=".concat(this._tone,`\r
`);m+="Duration=".concat(this._duration),this._session.newDTMF({originator:"local",dtmf:this,request:this._request}),this._session.sendRequest(Qo.INFO,{extraHeaders:d,eventHandlers:{onSuccessResponse:function(p){c.emit("succeeded",{originator:"remote",response:p})},onErrorResponse:function(p){c.eventHandlers.onFailed&&c.eventHandlers.onFailed(),c.emit("failed",{originator:"remote",response:p})},onRequestTimeout:function(){c._session.onRequestTimeout()},onTransportError:function(){c._session.onTransportError()},onDialogError:function(){c._session.onDialogError()}},body:m})}},{key:"init_incoming",value:function(s){var c=/^(Signal\s*?=\s*?)([0-9A-D#*]{1})(\s)?.*/,t=/^(Duration\s?=\s?)([0-9]{1,4})(\s)?.*/;if(this._direction="incoming",this._request=s,s.reply(200),s.body){var d=s.body.split(`
`);d.length>=1&&c.test(d[0])&&(this._tone=d[0].replace(c,"$2")),d.length>=2&&t.test(d[1])&&(this._duration=parseInt(d[1].replace(t,"$2"),10))}this._duration||(this._duration=Aa.DEFAULT_DURATION),this._tone?this._session.newDTMF({originator:"remote",dtmf:this,request:s}):ef.debug("invalid INFO DTMF received, discarded")}},{key:"tone",get:function(){return this._tone}},{key:"duration",get:function(){return this._duration}}]),i}(Jo);us.exports.C=Aa;var tf=us.exports;function Nn(u){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Nn=function(i){return typeof i}:Nn=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Nn(u)}function nf(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function Oi(u,a){for(var i=0;i<a.length;i++){var r=a[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(u,r.key,r)}}function rf(u,a,i){return a&&Oi(u.prototype,a),i&&Oi(u,i),u}function sf(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&zr(u,a)}function zr(u,a){return zr=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},zr(u,a)}function lf(u){var a=of();return function(){var r=$n(u),s;if(a){var c=$n(this).constructor;s=Reflect.construct(r,arguments,c)}else s=r.apply(this,arguments);return af(this,s)}}function af(u,a){return a&&(Nn(a)==="object"||typeof a=="function")?a:uf(u)}function uf(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}function of(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function $n(u){return $n=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},$n(u)}var ff=Ze.EventEmitter,cf=he,hf=Xe,df=ye(),_f=function(u){sf(i,u);var a=lf(i);function i(r){var s;return nf(this,i),s=a.call(this),s._session=r,s._direction=null,s._contentType=null,s._body=null,s}return rf(i,[{key:"send",value:function(s,c){var t=this,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this._direction="outgoing",s===void 0)throw new TypeError("Not enough arguments");if(this._session.status!==this._session.C.STATUS_CONFIRMED&&this._session.status!==this._session.C.STATUS_WAITING_FOR_ACK)throw new hf.InvalidStateError(this._session.status);this._contentType=s,this._body=c;var m=df.cloneArray(d.extraHeaders);m.push("Content-Type: ".concat(s)),this._session.newInfo({originator:"local",info:this,request:this.request}),this._session.sendRequest(cf.INFO,{extraHeaders:m,eventHandlers:{onSuccessResponse:function(p){t.emit("succeeded",{originator:"remote",response:p})},onErrorResponse:function(p){t.emit("failed",{originator:"remote",response:p})},onTransportError:function(){t._session.onTransportError()},onRequestTimeout:function(){t._session.onRequestTimeout()},onDialogError:function(){t._session.onDialogError()}},body:c})}},{key:"init_incoming",value:function(s){this._direction="incoming",this.request=s,s.reply(200),this._contentType=s.hasHeader("Content-Type")?s.getHeader("Content-Type").toLowerCase():void 0,this._body=s.body,this._session.newInfo({originator:"remote",info:this,request:s})}},{key:"contentType",get:function(){return this._contentType}},{key:"body",get:function(){return this._body}}]),i}(ff);function pf(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function Ni(u,a){for(var i=0;i<a.length;i++){var r=a[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(u,r.key,r)}}function vf(u,a,i){return a&&Ni(u.prototype,a),i&&Ni(u,i),u}var mf=_e,ki=he,gf=new mf("RTCSession:ReferNotifier"),Pr={event_type:"refer",body_type:"message/sipfrag;version=2.0",expires:300},yf=function(){function u(a,i,r){pf(this,u),this._session=a,this._id=i,this._expires=r||Pr.expires,this._active=!0,this.notify(100)}return vf(u,[{key:"notify",value:function(i,r){if(gf.debug("notify()"),this._active!==!1){r=r||ki.REASON_PHRASE[i]||"";var s;i>=200?s="terminated;reason=noresource":s="active;expires=".concat(this._expires),this._session.sendRequest(ki.NOTIFY,{extraHeaders:["Event: ".concat(Pr.event_type,";id=").concat(this._id),"Subscription-State: ".concat(s),"Content-Type: ".concat(Pr.body_type)],body:"SIP/2.0 ".concat(i," ").concat(r),eventHandlers:{onErrorResponse:function(){this._active=!1}}})}}}]),u}();function kn(u){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?kn=function(i){return typeof i}:kn=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},kn(u)}function Tf(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function Di(u,a){for(var i=0;i<a.length;i++){var r=a[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(u,r.key,r)}}function Sf(u,a,i){return a&&Di(u.prototype,a),i&&Di(u,i),u}function Ef(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&Yr(u,a)}function Yr(u,a){return Yr=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},Yr(u,a)}function Cf(u){var a=Rf();return function(){var r=qn(u),s;if(a){var c=qn(this).constructor;s=Reflect.construct(r,arguments,c)}else s=r.apply(this,arguments);return bf(this,s)}}function bf(u,a){return a&&(kn(a)==="object"||typeof a=="function")?a:Af(u)}function Af(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}function Rf(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function qn(u){return qn=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},qn(u)}var wf=Ze.EventEmitter,If=_e,Dt=he,Of=xe(),xi=ye(),ut=new If("RTCSession:ReferSubscriber"),Nf=function(u){Ef(i,u);var a=Cf(i);function i(r){var s;return Tf(this,i),s=a.call(this),s._id=null,s._session=r,s}return Sf(i,[{key:"sendRefer",value:function(s){var c=this,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ut.debug("sendRefer()");var d=xi.cloneArray(t.extraHeaders),m=xi.cloneObject(t.eventHandlers);for(var f in m)Object.prototype.hasOwnProperty.call(m,f)&&this.on(f,m[f]);var p=null;t.replaces&&(p=t.replaces._request.call_id,p+=";to-tag=".concat(t.replaces._to_tag),p+=";from-tag=".concat(t.replaces._from_tag),p=encodeURIComponent(p));var v="Refer-To: <".concat(s).concat(p?"?Replaces=".concat(p):"",">");if(d.push(v),!d.some(function(E){return E.toLowerCase().startsWith("referred-by:")})){var g="Referred-By: <".concat(this._session._ua._configuration.uri._scheme,":").concat(this._session._ua._configuration.uri._user,"@").concat(this._session._ua._configuration.uri._host,">");d.push(g)}d.push("Contact: ".concat(this._session.contact));var S=this._session.sendRequest(Dt.REFER,{extraHeaders:d,eventHandlers:{onSuccessResponse:function(N){c._requestSucceeded(N)},onErrorResponse:function(N){c._requestFailed(N,Dt.causes.REJECTED)},onTransportError:function(){c._requestFailed(null,Dt.causes.CONNECTION_ERROR)},onRequestTimeout:function(){c._requestFailed(null,Dt.causes.REQUEST_TIMEOUT)},onDialogError:function(){c._requestFailed(null,Dt.causes.DIALOG_ERROR)}}});this._id=S.cseq}},{key:"receiveNotify",value:function(s){if(ut.debug("receiveNotify()"),!!s.body){var c=Of.parse(s.body.trim().split(`\r
`,1)[0],"Status_Line");if(c===-1){ut.debug('receiveNotify() | error parsing NOTIFY body: "'.concat(s.body,'"'));return}switch(!0){case/^100$/.test(c.status_code):this.emit("trying",{request:s,status_line:c});break;case/^1[0-9]{2}$/.test(c.status_code):this.emit("progress",{request:s,status_line:c});break;case/^2[0-9]{2}$/.test(c.status_code):this.emit("accepted",{request:s,status_line:c});break;default:this.emit("failed",{request:s,status_line:c});break}}}},{key:"_requestSucceeded",value:function(s){ut.debug("REFER succeeded"),ut.debug('emit "requestSucceeded"'),this.emit("requestSucceeded",{response:s})}},{key:"_requestFailed",value:function(s,c){ut.debug("REFER failed"),ut.debug('emit "requestFailed"'),this.emit("requestFailed",{response:s||null,cause:c})}},{key:"id",get:function(){return this._id}}]),i}(wf);function Dn(u){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Dn=function(i){return typeof i}:Dn=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Dn(u)}function Fe(u,a){var i;if(typeof Symbol>"u"||u[Symbol.iterator]==null){if(Array.isArray(u)||(i=kf(u))||a&&u&&typeof u.length=="number"){i&&(u=i);var r=0,s=function(){};return{s,n:function(){return r>=u.length?{done:!0}:{done:!1,value:u[r++]}},e:function(f){throw f},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c=!0,t=!1,d;return{s:function(){i=u[Symbol.iterator]()},n:function(){var f=i.next();return c=f.done,f},e:function(f){t=!0,d=f},f:function(){try{!c&&i.return!=null&&i.return()}finally{if(t)throw d}}}}function kf(u,a){if(u){if(typeof u=="string")return Pi(u,a);var i=Object.prototype.toString.call(u).slice(8,-1);if(i==="Object"&&u.constructor&&(i=u.constructor.name),i==="Map"||i==="Set")return Array.from(u);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Pi(u,a)}}function Pi(u,a){(a==null||a>u.length)&&(a=u.length);for(var i=0,r=new Array(a);i<a;i++)r[i]=u[i];return r}function Df(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function Ui(u,a){for(var i=0;i<a.length;i++){var r=a[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(u,r.key,r)}}function Mi(u,a,i){return a&&Ui(u.prototype,a),i&&Ui(u,i),u}function xf(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&Jr(u,a)}function Jr(u,a){return Jr=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},Jr(u,a)}function Pf(u){var a=Lf();return function(){var r=jn(u),s;if(a){var c=jn(this).constructor;s=Reflect.construct(r,arguments,c)}else s=r.apply(this,arguments);return Uf(this,s)}}function Uf(u,a){return a&&(Dn(a)==="object"||typeof a=="function")?a:Mf(u)}function Mf(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}function Lf(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function jn(u){return jn=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},jn(u)}var Hf=Ze.EventEmitter,Li=Pe,Ff=_e,M=he,ot=Xe,Hi=Yt,ie=ye(),xt=ba,$f=$e,mn=jo,qf=Jt,Ce=tf,Fi=_f,jf=yf,Bf=Nf,$i=Qe(),R=new Ff("RTCSession"),I={STATUS_NULL:0,STATUS_INVITE_SENT:1,STATUS_1XX_RECEIVED:2,STATUS_INVITE_RECEIVED:3,STATUS_WAITING_FOR_ANSWER:4,STATUS_ANSWERED:5,STATUS_WAITING_FOR_ACK:6,STATUS_CANCELED:7,STATUS_TERMINATED:8,STATUS_CONFIRMED:9},gn=["audio","video"],Gf=function(u){xf(i,u);var a=Pf(i);Mi(i,null,[{key:"C",get:function(){return I}}]);function i(r){var s;return Df(this,i),R.debug("new"),s=a.call(this),s._id=null,s._ua=r,s._status=I.STATUS_NULL,s._dialog=null,s._earlyDialogs={},s._contact=null,s._from_tag=null,s._to_tag=null,s._connection=null,s._connectionPromiseQueue=Promise.resolve(),s._request=null,s._is_canceled=!1,s._cancel_reason="",s._is_confirmed=!1,s._late_sdp=!1,s._rtcOfferConstraints=null,s._rtcAnswerConstraints=null,s._localMediaStream=null,s._localMediaStreamLocallyGenerated=!1,s._rtcReady=!0,s._iceReady=!1,s._timers={ackTimer:null,expiresTimer:null,invite2xxTimer:null,userNoAnswerTimer:null},s._direction=null,s._local_identity=null,s._remote_identity=null,s._start_time=null,s._end_time=null,s._tones=null,s._audioMuted=!1,s._videoMuted=!1,s._localHold=!1,s._remoteHold=!1,s._sessionTimers={enabled:s._ua.configuration.session_timers,refreshMethod:s._ua.configuration.session_timers_refresh_method,defaultExpires:M.SESSION_EXPIRES,currentExpires:null,running:!1,refresher:!1,timer:null},s._referSubscribers={},s._data={},s}return Mi(i,[{key:"isInProgress",value:function(){switch(this._status){case I.STATUS_NULL:case I.STATUS_INVITE_SENT:case I.STATUS_1XX_RECEIVED:case I.STATUS_INVITE_RECEIVED:case I.STATUS_WAITING_FOR_ANSWER:return!0;default:return!1}}},{key:"isEstablished",value:function(){switch(this._status){case I.STATUS_ANSWERED:case I.STATUS_WAITING_FOR_ACK:case I.STATUS_CONFIRMED:return!0;default:return!1}}},{key:"isEnded",value:function(){switch(this._status){case I.STATUS_CANCELED:case I.STATUS_TERMINATED:return!0;default:return!1}}},{key:"isMuted",value:function(){return{audio:this._audioMuted,video:this._videoMuted}}},{key:"isOnHold",value:function(){return{local:this._localHold,remote:this._remoteHold}}},{key:"connect",value:function(s){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0;R.debug("connect()");var d=s,m=ie.cloneObject(c.eventHandlers),f=ie.cloneArray(c.extraHeaders),p=ie.cloneObject(c.mediaConstraints,{audio:!0,video:!0}),v=c.mediaStream||null,g=ie.cloneObject(c.pcConfig,{iceServers:[]}),S=c.rtcConstraints||null,E=c.rtcOfferConstraints||null;if(this._rtcOfferConstraints=E,this._rtcAnswerConstraints=c.rtcAnswerConstraints||null,this._data=c.data||this._data,s===void 0)throw new TypeError("Not enough arguments");if(this._status!==I.STATUS_NULL)throw new ot.InvalidStateError(this._status);if(!window.RTCPeerConnection)throw new ot.NotSupportedError("WebRTC not supported");if(s=this._ua.normalizeTarget(s),!s)throw new TypeError("Invalid target: ".concat(d));this._sessionTimers.enabled&&ie.isDecimal(c.sessionTimersExpires)&&(c.sessionTimersExpires>=M.MIN_SESSION_EXPIRES?this._sessionTimers.defaultExpires=c.sessionTimersExpires:this._sessionTimers.defaultExpires=M.SESSION_EXPIRES);for(var N in m)Object.prototype.hasOwnProperty.call(m,N)&&this.on(N,m[N]);this._from_tag=ie.newTag();var H=c.anonymous||!1,U={from_tag:this._from_tag};this._contact=this._ua.contact.toString({anonymous:H,outbound:!0}),H?(U.from_display_name="Anonymous",U.from_uri=new $i("sip","anonymous","anonymous.invalid"),f.push("P-Preferred-Identity: ".concat(this._ua.configuration.uri.toString())),f.push("Privacy: id")):c.fromUserName&&(U.from_uri=new $i("sip",c.fromUserName,this._ua.configuration.uri.host),f.push("P-Preferred-Identity: ".concat(this._ua.configuration.uri.toString()))),c.fromDisplayName&&(U.from_display_name=c.fromDisplayName),f.push("Contact: ".concat(this._contact)),f.push("Content-Type: application/sdp"),this._sessionTimers.enabled&&f.push("Session-Expires: ".concat(this._sessionTimers.defaultExpires).concat(this._ua.configuration.session_timers_force_refresher?";refresher=uac":"")),this._request=new $f.InitialOutgoingInviteRequest(s,this._ua,U,f),this._id=this._request.call_id+this._from_tag,this._createRTCConnection(g,S),this._direction="outgoing",this._local_identity=this._request.from,this._remote_identity=this._request.to,t&&t(this),this._newRTCSession("local",this._request),this._sendInitialRequest(p,E,v)}},{key:"init_incoming",value:function(s,c){var t=this;R.debug("init_incoming()");var d,m=s.hasHeader("Content-Type")?s.getHeader("Content-Type").toLowerCase():void 0;if(s.body&&m!=="application/sdp"){s.reply(415);return}if(this._status=I.STATUS_INVITE_RECEIVED,this._from_tag=s.from_tag,this._id=s.call_id+this._from_tag,this._request=s,this._contact=this._ua.contact.toString(),s.hasHeader("expires")&&(d=s.getHeader("expires")*1e3),s.to_tag=ie.newTag(),!this._createDialog(s,"UAS",!0)){s.reply(500,"Missing Contact header field");return}s.body?this._late_sdp=!1:this._late_sdp=!0,this._status=I.STATUS_WAITING_FOR_ANSWER,this._timers.userNoAnswerTimer=setTimeout(function(){s.reply(408),t._failed("local",null,M.causes.NO_ANSWER)},this._ua.configuration.no_answer_timeout),d&&(this._timers.expiresTimer=setTimeout(function(){t._status===I.STATUS_WAITING_FOR_ANSWER&&(s.reply(487),t._failed("system",null,M.causes.EXPIRES))},d)),this._direction="incoming",this._local_identity=s.to,this._remote_identity=s.from,c&&c(this),this._newRTCSession("remote",s),this._status!==I.STATUS_TERMINATED&&(s.reply(180,null,["Contact: ".concat(this._contact)]),this._progress("local",null))}},{key:"answer",value:function(){var s=this,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};R.debug("answer()");var t=this._request,d=ie.cloneArray(c.extraHeaders),m=ie.cloneObject(c.mediaConstraints),f=c.mediaStream||null,p=ie.cloneObject(c.pcConfig,{iceServers:[]}),v=c.rtcConstraints||null,g=c.rtcAnswerConstraints||null,S=ie.cloneObject(c.rtcOfferConstraints),E,N=!1,H=!1,U=!1,q=!1;if(this._rtcAnswerConstraints=g,this._rtcOfferConstraints=c.rtcOfferConstraints||null,this._data=c.data||this._data,this._direction!=="incoming")throw new ot.NotSupportedError('"answer" not supported for outgoing RTCSession');if(this._status!==I.STATUS_WAITING_FOR_ANSWER)throw new ot.InvalidStateError(this._status);if(this._sessionTimers.enabled&&ie.isDecimal(c.sessionTimersExpires)&&(c.sessionTimersExpires>=M.MIN_SESSION_EXPIRES?this._sessionTimers.defaultExpires=c.sessionTimersExpires:this._sessionTimers.defaultExpires=M.SESSION_EXPIRES),this._status=I.STATUS_ANSWERED,!this._createDialog(t,"UAS")){t.reply(500,"Error creating dialog");return}clearTimeout(this._timers.userNoAnswerTimer),d.unshift("Contact: ".concat(this._contact));var G=t.parseSDP();Array.isArray(G.media)||(G.media=[G.media]);var z=Fe(G.media),Y;try{for(z.s();!(Y=z.n()).done;){var ue=Y.value;ue.type==="audio"&&(N=!0,(!ue.direction||ue.direction==="sendrecv")&&(U=!0)),ue.type==="video"&&(H=!0,(!ue.direction||ue.direction==="sendrecv")&&(q=!0))}}catch(Q){z.e(Q)}finally{z.f()}if(f&&m.audio===!1){E=f.getAudioTracks();var Z=Fe(E),D;try{for(Z.s();!(D=Z.n()).done;){var O=D.value;f.removeTrack(O)}}catch(Q){Z.e(Q)}finally{Z.f()}}if(f&&m.video===!1){E=f.getVideoTracks();var Ie=Fe(E),qe;try{for(Ie.s();!(qe=Ie.n()).done;){var be=qe.value;f.removeTrack(be)}}catch(Q){Ie.e(Q)}finally{Ie.f()}}!f&&m.audio===void 0&&(m.audio=U),!f&&m.video===void 0&&(m.video=q),!f&&!N&&!S.offerToReceiveAudio&&(m.audio=!1),!f&&!H&&!S.offerToReceiveVideo&&(m.video=!1),this._createRTCConnection(p,v),Promise.resolve().then(function(){if(f)return f;if(m.audio||m.video)return s._localMediaStreamLocallyGenerated=!0,navigator.mediaDevices.getUserMedia(m).catch(function(Q){throw s._status===I.STATUS_TERMINATED?new Error("terminated"):(t.reply(480),s._failed("local",null,M.causes.USER_DENIED_MEDIA_ACCESS),R.warn('emit "getusermediafailed" [error:%o]',Q),s.emit("getusermediafailed",Q),new Error("getUserMedia() failed"))})}).then(function(Q){if(s._status===I.STATUS_TERMINATED)throw new Error("terminated");s._localMediaStream=Q,Q&&Q.getTracks().forEach(function(k){s._connection.addTrack(k,Q)})}).then(function(){if(!s._late_sdp){var Q={originator:"remote",type:"offer",sdp:t.body};R.debug('emit "sdp"'),s.emit("sdp",Q);var k=new RTCSessionDescription({type:"offer",sdp:Q.sdp});return s._connectionPromiseQueue=s._connectionPromiseQueue.then(function(){return s._connection.setRemoteDescription(k)}).catch(function(x){throw t.reply(488),s._failed("system",null,M.causes.WEBRTC_ERROR),R.warn('emit "peerconnection:setremotedescriptionfailed" [error:%o]',x),s.emit("peerconnection:setremotedescriptionfailed",x),new Error("peerconnection.setRemoteDescription() failed")}),s._connectionPromiseQueue}}).then(function(){if(s._status===I.STATUS_TERMINATED)throw new Error("terminated");return s._connecting(t),s._late_sdp?s._createLocalDescription("offer",s._rtcOfferConstraints).catch(function(){throw t.reply(500),new Error("_createLocalDescription() failed")}):s._createLocalDescription("answer",g).catch(function(){throw t.reply(500),new Error("_createLocalDescription() failed")})}).then(function(Q){if(s._status===I.STATUS_TERMINATED)throw new Error("terminated");s._handleSessionTimersInIncomingRequest(t,d),t.reply(200,null,d,Q,function(){s._status=I.STATUS_WAITING_FOR_ACK,s._setInvite2xxTimer(t,Q),s._setACKTimer(),s._accepted("local")},function(){s._failed("system",null,M.causes.CONNECTION_ERROR)})}).catch(function(Q){s._status!==I.STATUS_TERMINATED&&R.warn(Q)})}},{key:"terminate",value:function(){var s=this,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};R.debug("terminate()");var t=c.cause||M.causes.BYE,d=ie.cloneArray(c.extraHeaders),m=c.body,f,p=c.status_code,v=c.reason_phrase;if(this._status===I.STATUS_TERMINATED)throw new ot.InvalidStateError(this._status);switch(this._status){case I.STATUS_NULL:case I.STATUS_INVITE_SENT:case I.STATUS_1XX_RECEIVED:if(R.debug("canceling session"),p&&(p<200||p>=700))throw new TypeError("Invalid status_code: ".concat(p));p&&(v=v||M.REASON_PHRASE[p]||"",f="SIP ;cause=".concat(p,' ;text="').concat(v,'"')),this._status===I.STATUS_NULL||this._status===I.STATUS_INVITE_SENT?(this._is_canceled=!0,this._cancel_reason=f):this._status===I.STATUS_1XX_RECEIVED&&this._request.cancel(f),this._status=I.STATUS_CANCELED,this._failed("local",null,M.causes.CANCELED);break;case I.STATUS_WAITING_FOR_ANSWER:case I.STATUS_ANSWERED:if(R.debug("rejecting session"),p=p||480,p<300||p>=700)throw new TypeError("Invalid status_code: ".concat(p));this._request.reply(p,v,d,m),this._failed("local",null,M.causes.REJECTED);break;case I.STATUS_WAITING_FOR_ACK:case I.STATUS_CONFIRMED:if(R.debug("terminating session"),v=c.reason_phrase||M.REASON_PHRASE[p]||"",p&&(p<200||p>=700))throw new TypeError("Invalid status_code: ".concat(p));if(p&&d.push("Reason: SIP ;cause=".concat(p,'; text="').concat(v,'"')),this._status===I.STATUS_WAITING_FOR_ACK&&this._direction==="incoming"&&this._request.server_transaction.state!==Hi.C.STATUS_TERMINATED){var g=this._dialog;this.receiveRequest=function(S){var E=S.method;E===M.ACK&&(s.sendRequest(M.BYE,{extraHeaders:d,body:m}),g.terminate())},this._request.server_transaction.on("stateChanged",function(){s._request.server_transaction.state===Hi.C.STATUS_TERMINATED&&(s.sendRequest(M.BYE,{extraHeaders:d,body:m}),g.terminate())}),this._ended("local",null,t),this._dialog=g,this._ua.newDialog(g)}else this.sendRequest(M.BYE,{extraHeaders:d,body:m}),this._ended("local",null,t)}}},{key:"sendDTMF",value:function(s){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};R.debug("sendDTMF() | tones: %s",s);var t=0,d=c.duration||null,m=c.interToneGap||null,f=c.transportType||M.DTMF_TRANSPORT.INFO;if(s===void 0)throw new TypeError("Not enough arguments");if(this._status!==I.STATUS_CONFIRMED&&this._status!==I.STATUS_WAITING_FOR_ACK&&this._status!==I.STATUS_1XX_RECEIVED)throw new ot.InvalidStateError(this._status);if(f!==M.DTMF_TRANSPORT.INFO&&f!==M.DTMF_TRANSPORT.RFC2833)throw new TypeError("invalid transportType: ".concat(f));if(typeof s=="number"&&(s=s.toString()),!s||typeof s!="string"||!s.match(/^[0-9A-DR#*,]+$/i))throw new TypeError("Invalid tones: ".concat(s));if(d&&!ie.isDecimal(d))throw new TypeError("Invalid tone duration: ".concat(d));if(d?d<Ce.C.MIN_DURATION?(R.debug('"duration" value is lower than the minimum allowed, setting it to '.concat(Ce.C.MIN_DURATION," milliseconds")),d=Ce.C.MIN_DURATION):d>Ce.C.MAX_DURATION?(R.debug('"duration" value is greater than the maximum allowed, setting it to '.concat(Ce.C.MAX_DURATION," milliseconds")),d=Ce.C.MAX_DURATION):d=Math.abs(d):d=Ce.C.DEFAULT_DURATION,c.duration=d,m&&!ie.isDecimal(m))throw new TypeError("Invalid interToneGap: ".concat(m));if(m?m<Ce.C.MIN_INTER_TONE_GAP?(R.debug('"interToneGap" value is lower than the minimum allowed, setting it to '.concat(Ce.C.MIN_INTER_TONE_GAP," milliseconds")),m=Ce.C.MIN_INTER_TONE_GAP):m=Math.abs(m):m=Ce.C.DEFAULT_INTER_TONE_GAP,f===M.DTMF_TRANSPORT.RFC2833){var p=this._getDTMFRTPSender();p&&(s=p.toneBuffer+s,p.insertDTMF(s,d,m));return}if(this._tones){this._tones+=s;return}this._tones=s,v.call(this);function v(){var g=this,S;if(this._status===I.STATUS_TERMINATED||!this._tones||t>=this._tones.length){this._tones=null;return}var E=this._tones[t];if(t+=1,E===",")S=2e3;else{var N=new Ce(this);c.eventHandlers={onFailed:function(){g._tones=null}},N.send(E,c),S=d+m}setTimeout(v.bind(this),S)}}},{key:"sendInfo",value:function(s,c){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(R.debug("sendInfo()"),this._status!==I.STATUS_CONFIRMED&&this._status!==I.STATUS_WAITING_FOR_ACK&&this._status!==I.STATUS_1XX_RECEIVED)throw new ot.InvalidStateError(this._status);var d=new Fi(this);d.send(s,c,t)}},{key:"mute",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{audio:!0,video:!1};R.debug("mute()");var c=!1,t=!1;this._audioMuted===!1&&s.audio&&(c=!0,this._audioMuted=!0,this._toggleMuteAudio(!0)),this._videoMuted===!1&&s.video&&(t=!0,this._videoMuted=!0,this._toggleMuteVideo(!0)),(c===!0||t===!0)&&this._onmute({audio:c,video:t})}},{key:"unmute",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{audio:!0,video:!0};R.debug("unmute()");var c=!1,t=!1;this._audioMuted===!0&&s.audio&&(c=!0,this._audioMuted=!1,this._localHold===!1&&this._toggleMuteAudio(!1)),this._videoMuted===!0&&s.video&&(t=!0,this._videoMuted=!1,this._localHold===!1&&this._toggleMuteVideo(!1)),(c===!0||t===!0)&&this._onunmute({audio:c,video:t})}},{key:"hold",value:function(){var s=this,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(R.debug("hold()"),this._status!==I.STATUS_WAITING_FOR_ACK&&this._status!==I.STATUS_CONFIRMED||this._localHold===!0||!this._isReadyToReOffer())return!1;this._localHold=!0,this._onhold("local");var d={succeeded:function(){t&&t()},failed:function(){s.terminate({cause:M.causes.WEBRTC_ERROR,status_code:500,reason_phrase:"Hold Failed"})}};return c.useUpdate?this._sendUpdate({sdpOffer:!0,eventHandlers:d,extraHeaders:c.extraHeaders}):this._sendReinvite({eventHandlers:d,extraHeaders:c.extraHeaders}),!0}},{key:"unhold",value:function(){var s=this,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(R.debug("unhold()"),this._status!==I.STATUS_WAITING_FOR_ACK&&this._status!==I.STATUS_CONFIRMED||this._localHold===!1||!this._isReadyToReOffer())return!1;this._localHold=!1,this._onunhold("local");var d={succeeded:function(){t&&t()},failed:function(){s.terminate({cause:M.causes.WEBRTC_ERROR,status_code:500,reason_phrase:"Unhold Failed"})}};return c.useUpdate?this._sendUpdate({sdpOffer:!0,eventHandlers:d,extraHeaders:c.extraHeaders}):this._sendReinvite({eventHandlers:d,extraHeaders:c.extraHeaders}),!0}},{key:"renegotiate",value:function(){var s=this,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;R.debug("renegotiate()");var d=c.rtcOfferConstraints||null;if(this._status!==I.STATUS_WAITING_FOR_ACK&&this._status!==I.STATUS_CONFIRMED||!this._isReadyToReOffer())return!1;var m={succeeded:function(){t&&t()},failed:function(){s.terminate({cause:M.causes.WEBRTC_ERROR,status_code:500,reason_phrase:"Media Renegotiation Failed"})}};return this._setLocalMediaStatus(),c.useUpdate?this._sendUpdate({sdpOffer:!0,eventHandlers:m,rtcOfferConstraints:d,extraHeaders:c.extraHeaders}):this._sendReinvite({eventHandlers:m,rtcOfferConstraints:d,extraHeaders:c.extraHeaders}),!0}},{key:"refer",value:function(s,c){var t=this;R.debug("refer()");var d=s;if(this._status!==I.STATUS_WAITING_FOR_ACK&&this._status!==I.STATUS_CONFIRMED)return!1;if(s=this._ua.normalizeTarget(s),!s)throw new TypeError("Invalid target: ".concat(d));var m=new Bf(this);m.sendRefer(s,c);var f=m.id;return this._referSubscribers[f]=m,m.on("requestFailed",function(){delete t._referSubscribers[f]}),m.on("accepted",function(){delete t._referSubscribers[f]}),m.on("failed",function(){delete t._referSubscribers[f]}),m}},{key:"sendRequest",value:function(s,c){return R.debug("sendRequest()"),this._dialog.sendRequest(s,c)}},{key:"receiveRequest",value:function(s){var c=this;if(R.debug("receiveRequest()"),s.method===M.CANCEL)(this._status===I.STATUS_WAITING_FOR_ANSWER||this._status===I.STATUS_ANSWERED)&&(this._status=I.STATUS_CANCELED,this._request.reply(487),this._failed("remote",s,M.causes.CANCELED));else switch(s.method){case M.ACK:if(this._status!==I.STATUS_WAITING_FOR_ACK)return;if(this._status=I.STATUS_CONFIRMED,clearTimeout(this._timers.ackTimer),clearTimeout(this._timers.invite2xxTimer),this._late_sdp){if(!s.body){this.terminate({cause:M.causes.MISSING_SDP,status_code:400});break}var t={originator:"remote",type:"answer",sdp:s.body};R.debug('emit "sdp"'),this.emit("sdp",t);var d=new RTCSessionDescription({type:"answer",sdp:t.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return c._connection.setRemoteDescription(d)}).then(function(){c._is_confirmed||c._confirmed("remote",s)}).catch(function(f){c.terminate({cause:M.causes.BAD_MEDIA_DESCRIPTION,status_code:488}),R.warn('emit "peerconnection:setremotedescriptionfailed" [error:%o]',f),c.emit("peerconnection:setremotedescriptionfailed",f)})}else this._is_confirmed||this._confirmed("remote",s);break;case M.BYE:this._status===I.STATUS_CONFIRMED||this._status===I.STATUS_WAITING_FOR_ACK?(s.reply(200),this._ended("remote",s,M.causes.BYE)):this._status===I.STATUS_INVITE_RECEIVED||this._status===I.STATUS_WAITING_FOR_ANSWER?(s.reply(200),this._request.reply(487,"BYE Received"),this._ended("remote",s,M.causes.BYE)):s.reply(403,"Wrong Status");break;case M.INVITE:this._status===I.STATUS_CONFIRMED?s.hasHeader("replaces")?this._receiveReplaces(s):this._receiveReinvite(s):s.reply(403,"Wrong Status");break;case M.INFO:if(this._status===I.STATUS_1XX_RECEIVED||this._status===I.STATUS_WAITING_FOR_ANSWER||this._status===I.STATUS_ANSWERED||this._status===I.STATUS_WAITING_FOR_ACK||this._status===I.STATUS_CONFIRMED){var m=s.hasHeader("Content-Type")?s.getHeader("Content-Type").toLowerCase():void 0;m&&m.match(/^application\/dtmf-relay/i)?new Ce(this).init_incoming(s):m!==void 0?new Fi(this).init_incoming(s):s.reply(415)}else s.reply(403,"Wrong Status");break;case M.UPDATE:this._status===I.STATUS_CONFIRMED?this._receiveUpdate(s):s.reply(403,"Wrong Status");break;case M.REFER:this._status===I.STATUS_CONFIRMED?this._receiveRefer(s):s.reply(403,"Wrong Status");break;case M.NOTIFY:this._status===I.STATUS_CONFIRMED?this._receiveNotify(s):s.reply(403,"Wrong Status");break;default:s.reply(501)}}},{key:"onTransportError",value:function(){R.warn("onTransportError()"),this._status!==I.STATUS_TERMINATED&&this.terminate({status_code:500,reason_phrase:M.causes.CONNECTION_ERROR,cause:M.causes.CONNECTION_ERROR})}},{key:"onRequestTimeout",value:function(){R.warn("onRequestTimeout()"),this._status!==I.STATUS_TERMINATED&&this.terminate({status_code:408,reason_phrase:M.causes.REQUEST_TIMEOUT,cause:M.causes.REQUEST_TIMEOUT})}},{key:"onDialogError",value:function(){R.warn("onDialogError()"),this._status!==I.STATUS_TERMINATED&&this.terminate({status_code:500,reason_phrase:M.causes.DIALOG_ERROR,cause:M.causes.DIALOG_ERROR})}},{key:"newDTMF",value:function(s){R.debug("newDTMF()"),this.emit("newDTMF",s)}},{key:"newInfo",value:function(s){R.debug("newInfo()"),this.emit("newInfo",s)}},{key:"_isReadyToReOffer",value:function(){return this._rtcReady?this._dialog?this._dialog.uac_pending_reply===!0||this._dialog.uas_pending_reply===!0?(R.debug("_isReadyToReOffer() | there is another INVITE/UPDATE transaction in progress"),!1):!0:(R.debug("_isReadyToReOffer() | session not established yet"),!1):(R.debug("_isReadyToReOffer() | internal WebRTC status not ready"),!1)}},{key:"_close",value:function(){if(R.debug("close()"),this._localMediaStream&&this._localMediaStreamLocallyGenerated&&(R.debug("close() | closing local MediaStream"),ie.closeMediaStream(this._localMediaStream)),this._status!==I.STATUS_TERMINATED){if(this._status=I.STATUS_TERMINATED,this._connection)try{this._connection.close()}catch(d){R.warn("close() | error closing the RTCPeerConnection: %o",d)}for(var s in this._timers)Object.prototype.hasOwnProperty.call(this._timers,s)&&clearTimeout(this._timers[s]);clearTimeout(this._sessionTimers.timer),this._dialog&&(this._dialog.terminate(),delete this._dialog);for(var c in this._earlyDialogs)Object.prototype.hasOwnProperty.call(this._earlyDialogs,c)&&(this._earlyDialogs[c].terminate(),delete this._earlyDialogs[c]);for(var t in this._referSubscribers)Object.prototype.hasOwnProperty.call(this._referSubscribers,t)&&delete this._referSubscribers[t];this._ua.destroyRTCSession(this)}}},{key:"_setInvite2xxTimer",value:function(s,c){var t=xt.T1;function d(){this._status===I.STATUS_WAITING_FOR_ACK&&(s.reply(200,null,["Contact: ".concat(this._contact)],c),t<xt.T2&&(t=t*2,t>xt.T2&&(t=xt.T2)),this._timers.invite2xxTimer=setTimeout(d.bind(this),t))}this._timers.invite2xxTimer=setTimeout(d.bind(this),t)}},{key:"_setACKTimer",value:function(){var s=this;this._timers.ackTimer=setTimeout(function(){s._status===I.STATUS_WAITING_FOR_ACK&&(R.debug("no ACK received, terminating the session"),clearTimeout(s._timers.invite2xxTimer),s.sendRequest(M.BYE),s._ended("remote",null,M.causes.NO_ACK))},xt.TIMER_H)}},{key:"_createRTCConnection",value:function(s,c){var t=this;this._connection=new RTCPeerConnection(s,c),this._connection.addEventListener("iceconnectionstatechange",function(){var d=t._connection.iceConnectionState;d==="failed"&&t.terminate({cause:M.causes.RTP_TIMEOUT,status_code:408,reason_phrase:M.causes.RTP_TIMEOUT})}),R.debug('emit "peerconnection"'),this.emit("peerconnection",{peerconnection:this._connection})}},{key:"_createLocalDescription",value:function(s,c){var t=this;if(R.debug("createLocalDescription()"),s!=="offer"&&s!=="answer")throw new Error('createLocalDescription() | invalid type "'.concat(s,'"'));var d=this._connection;return this._rtcReady=!1,Promise.resolve().then(function(){return s==="offer"?d.createOffer(c).catch(function(m){return R.warn('emit "peerconnection:createofferfailed" [error:%o]',m),t.emit("peerconnection:createofferfailed",m),Promise.reject(m)}):d.createAnswer(c).catch(function(m){return R.warn('emit "peerconnection:createanswerfailed" [error:%o]',m),t.emit("peerconnection:createanswerfailed",m),Promise.reject(m)})}).then(function(m){return d.setLocalDescription(m).catch(function(f){return t._rtcReady=!0,R.warn('emit "peerconnection:setlocaldescriptionfailed" [error:%o]',f),t.emit("peerconnection:setlocaldescriptionfailed",f),Promise.reject(f)})}).then(function(){var m=c&&c.iceRestart;if(d.iceGatheringState==="complete"&&!m||d.iceGatheringState==="gathering"&&t._iceReady){t._rtcReady=!0;var f={originator:"local",type:s,sdp:d.localDescription.sdp};return R.debug('emit "sdp"'),t.emit("sdp",f),Promise.resolve(f.sdp)}return new Promise(function(p){var v=!1,g,S;t._iceReady=!1;var E=function(){if(!v){d.removeEventListener("icecandidate",g),d.removeEventListener("icegatheringstatechange",S),v=!0,t._rtcReady=!0,t._iceReady=!0;var H={originator:"local",type:s,sdp:d.localDescription.sdp};R.debug('emit "sdp"'),t.emit("sdp",H),p(H.sdp)}};d.addEventListener("icecandidate",g=function(H){var U=H.candidate;U?t.emit("icecandidate",{candidate:U,ready:E}):E()}),d.addEventListener("icegatheringstatechange",S=function(){d.iceGatheringState==="complete"&&E()})})})}},{key:"_createDialog",value:function(s,c,t){var d=c==="UAS"?s.to_tag:s.from_tag,m=c==="UAS"?s.from_tag:s.to_tag,f=s.call_id+d+m,p=this._earlyDialogs[f];if(t)return p?!0:(p=new mn(this,s,c,mn.C.STATUS_EARLY),p.error?(R.debug(p.error),this._failed("remote",s,M.causes.INTERNAL_ERROR),!1):(this._earlyDialogs[f]=p,!0));if(this._from_tag=s.from_tag,this._to_tag=s.to_tag,p)return p.update(s,c),this._dialog=p,delete this._earlyDialogs[f],!0;var v=new mn(this,s,c);return v.error?(R.debug(v.error),this._failed("remote",s,M.causes.INTERNAL_ERROR),!1):(this._dialog=v,!0)}},{key:"_receiveReinvite",value:function(s){var c=this;R.debug("receiveReinvite()");var t=s.hasHeader("Content-Type")?s.getHeader("Content-Type").toLowerCase():void 0,d={request:s,callback:void 0,reject:f.bind(this)},m=!1;function f(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};m=!0;var g=v.status_code||403,S=v.reason_phrase||"",E=ie.cloneArray(v.extraHeaders);if(this._status!==I.STATUS_CONFIRMED)return!1;if(g<300||g>=700)throw new TypeError("Invalid status_code: ".concat(g));s.reply(g,S,E)}if(this.emit("reinvite",d),m)return;if(this._late_sdp=!1,!s.body){this._late_sdp=!0,this._remoteHold&&(this._remoteHold=!1,this._onunhold("remote")),this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return c._createLocalDescription("offer",c._rtcOfferConstraints)}).then(function(v){p.call(c,v)}).catch(function(){s.reply(500)});return}if(t!=="application/sdp"){R.debug("invalid Content-Type"),s.reply(415);return}this._processInDialogSdpOffer(s).then(function(v){c._status!==I.STATUS_TERMINATED&&p.call(c,v)}).catch(function(v){R.warn(v)});function p(v){var g=this,S=["Contact: ".concat(this._contact)];this._handleSessionTimersInIncomingRequest(s,S),this._late_sdp&&(v=this._mangleOffer(v)),s.reply(200,null,S,v,function(){g._status=I.STATUS_WAITING_FOR_ACK,g._setInvite2xxTimer(s,v),g._setACKTimer()}),typeof d.callback=="function"&&d.callback()}}},{key:"_receiveUpdate",value:function(s){var c=this;R.debug("receiveUpdate()");var t=s.hasHeader("Content-Type")?s.getHeader("Content-Type").toLowerCase():void 0,d={request:s,callback:void 0,reject:f.bind(this)},m=!1;function f(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};m=!0;var g=v.status_code||403,S=v.reason_phrase||"",E=ie.cloneArray(v.extraHeaders);if(this._status!==I.STATUS_CONFIRMED)return!1;if(g<300||g>=700)throw new TypeError("Invalid status_code: ".concat(g));s.reply(g,S,E)}if(this.emit("update",d),m)return;if(!s.body){p.call(this,null);return}if(t!=="application/sdp"){R.debug("invalid Content-Type"),s.reply(415);return}this._processInDialogSdpOffer(s).then(function(v){c._status!==I.STATUS_TERMINATED&&p.call(c,v)}).catch(function(v){R.warn(v)});function p(v){var g=["Contact: ".concat(this._contact)];this._handleSessionTimersInIncomingRequest(s,g),s.reply(200,null,g,v),typeof d.callback=="function"&&d.callback()}}},{key:"_processInDialogSdpOffer",value:function(s){var c=this;R.debug("_processInDialogSdpOffer()");var t=s.parseSDP(),d=!1,m=Fe(t.media),f;try{for(m.s();!(f=m.n()).done;){var p=f.value;if(gn.indexOf(p.type)!==-1){var v=p.direction||t.direction||"sendrecv";if(v==="sendonly"||v==="inactive")d=!0;else{d=!1;break}}}}catch(E){m.e(E)}finally{m.f()}var g={originator:"remote",type:"offer",sdp:s.body};R.debug('emit "sdp"'),this.emit("sdp",g);var S=new RTCSessionDescription({type:"offer",sdp:g.sdp});return this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){if(c._status===I.STATUS_TERMINATED)throw new Error("terminated");return c._connection.setRemoteDescription(S).catch(function(E){throw s.reply(488),R.warn('emit "peerconnection:setremotedescriptionfailed" [error:%o]',E),c.emit("peerconnection:setremotedescriptionfailed",E),E})}).then(function(){if(c._status===I.STATUS_TERMINATED)throw new Error("terminated");c._remoteHold===!0&&d===!1?(c._remoteHold=!1,c._onunhold("remote")):c._remoteHold===!1&&d===!0&&(c._remoteHold=!0,c._onhold("remote"))}).then(function(){if(c._status===I.STATUS_TERMINATED)throw new Error("terminated");return c._createLocalDescription("answer",c._rtcAnswerConstraints).catch(function(E){throw s.reply(500),R.warn('emit "peerconnection:createtelocaldescriptionfailed" [error:%o]',E),E})}).catch(function(E){R.warn("_processInDialogSdpOffer() failed [error: %o]",E)}),this._connectionPromiseQueue}},{key:"_receiveRefer",value:function(s){var c=this;if(R.debug("receiveRefer()"),!s.refer_to){R.debug("no Refer-To header field present in REFER"),s.reply(400);return}if(s.refer_to.uri.scheme!==M.SIP){R.debug("Refer-To header field points to a non-SIP URI scheme"),s.reply(416);return}s.reply(202);var t=new jf(this,s.cseq);R.debug('emit "refer"'),this.emit("refer",{request:s,accept:function(p,v){d.call(c,p,v)},reject:function(){m.call(c)}});function d(f){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(f=typeof f=="function"?f:null,this._status!==I.STATUS_WAITING_FOR_ACK&&this._status!==I.STATUS_CONFIRMED)return!1;var v=new i(this._ua);if(v.on("progress",function(S){var E=S.response;t.notify(E.status_code,E.reason_phrase)}),v.on("accepted",function(S){var E=S.response;t.notify(E.status_code,E.reason_phrase)}),v.on("_failed",function(S){var E=S.message,N=S.cause;E?t.notify(E.status_code,E.reason_phrase):t.notify(487,N)}),s.refer_to.uri.hasHeader("replaces")){var g=decodeURIComponent(s.refer_to.uri.getHeader("replaces"));p.extraHeaders=ie.cloneArray(p.extraHeaders),p.extraHeaders.push("Replaces: ".concat(g))}v.connect(s.refer_to.uri.toAor(),p,f)}function m(){t.notify(603)}}},{key:"_receiveNotify",value:function(s){switch(R.debug("receiveNotify()"),s.event||s.reply(400),s.event.event){case"refer":{var c,t;if(s.event.params&&s.event.params.id)c=s.event.params.id,t=this._referSubscribers[c];else if(Object.keys(this._referSubscribers).length===1)t=this._referSubscribers[Object.keys(this._referSubscribers)[0]];else{s.reply(400,"Missing event id parameter");return}if(!t){s.reply(481,"Subscription does not exist");return}t.receiveNotify(s),s.reply(200);break}default:s.reply(489)}}},{key:"_receiveReplaces",value:function(s){var c=this;R.debug("receiveReplaces()");function t(m){var f=this;if(this._status!==I.STATUS_WAITING_FOR_ACK&&this._status!==I.STATUS_CONFIRMED)return!1;var p=new i(this._ua);p.on("confirmed",function(){f.terminate()}),p.init_incoming(s,m)}function d(){R.debug("Replaced INVITE rejected by the user"),s.reply(486)}this.emit("replaces",{request:s,accept:function(f){t.call(c,f)},reject:function(){d.call(c)}})}},{key:"_sendInitialRequest",value:function(s,c,t){var d=this,m=new qf(this._ua,this._request,{onRequestTimeout:function(){d.onRequestTimeout()},onTransportError:function(){d.onTransportError()},onAuthenticated:function(p){d._request=p},onReceiveResponse:function(p){d._receiveInviteResponse(p)}});Promise.resolve().then(function(){if(t)return t;if(s.audio||s.video)return d._localMediaStreamLocallyGenerated=!0,navigator.mediaDevices.getUserMedia(s).catch(function(f){throw d._status===I.STATUS_TERMINATED?new Error("terminated"):(d._failed("local",null,M.causes.USER_DENIED_MEDIA_ACCESS),R.warn('emit "getusermediafailed" [error:%o]',f),d.emit("getusermediafailed",f),f)})}).then(function(f){if(d._status===I.STATUS_TERMINATED)throw new Error("terminated");return d._localMediaStream=f,f&&f.getTracks().forEach(function(p){d._connection.addTrack(p,f)}),d._connecting(d._request),d._createLocalDescription("offer",c).catch(function(p){throw d._failed("local",null,M.causes.WEBRTC_ERROR),p})}).then(function(f){if(d._is_canceled||d._status===I.STATUS_TERMINATED)throw new Error("terminated");d._request.body=f,d._status=I.STATUS_INVITE_SENT,R.debug('emit "sending" [request:%o]',d._request),d.emit("sending",{request:d._request}),m.send()}).catch(function(f){d._status!==I.STATUS_TERMINATED&&R.warn(f)})}},{key:"_getDTMFRTPSender",value:function(){var s=this._connection.getSenders().find(function(c){return c.track&&c.track.kind==="audio"});if(!(s&&s.dtmf)){R.warn("sendDTMF() | no local audio track to send DTMF with");return}return s.dtmf}},{key:"_receiveInviteResponse",value:function(s){var c=this;if(R.debug("receiveInviteResponse()"),this._dialog&&s.status_code>=200&&s.status_code<=299)if(this._dialog.id.call_id===s.call_id&&this._dialog.id.local_tag===s.from_tag&&this._dialog.id.remote_tag===s.to_tag){this.sendRequest(M.ACK);return}else{var t=new mn(this,s,"UAC");if(t.error!==void 0){R.debug(t.error);return}this.sendRequest(M.ACK),this.sendRequest(M.BYE);return}if(this._is_canceled){s.status_code>=100&&s.status_code<200?this._request.cancel(this._cancel_reason):s.status_code>=200&&s.status_code<299&&this._acceptAndTerminate(s);return}if(!(this._status!==I.STATUS_INVITE_SENT&&this._status!==I.STATUS_1XX_RECEIVED))switch(!0){case/^100$/.test(s.status_code):this._status=I.STATUS_1XX_RECEIVED;break;case/^1[0-9]{2}$/.test(s.status_code):{if(!s.to_tag){R.debug("1xx response received without to tag");break}if(s.hasHeader("contact")&&!this._createDialog(s,"UAC",!0))break;if(this._status=I.STATUS_1XX_RECEIVED,!s.body){this._progress("remote",s);break}var d={originator:"remote",type:"answer",sdp:s.body};R.debug('emit "sdp"'),this.emit("sdp",d);var m=new RTCSessionDescription({type:"answer",sdp:d.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return c._connection.setRemoteDescription(m)}).then(function(){return c._progress("remote",s)}).catch(function(g){R.warn('emit "peerconnection:setremotedescriptionfailed" [error:%o]',g),c.emit("peerconnection:setremotedescriptionfailed",g)});break}case/^2[0-9]{2}$/.test(s.status_code):{if(this._status=I.STATUS_CONFIRMED,!s.body){this._acceptAndTerminate(s,400,M.causes.MISSING_SDP),this._failed("remote",s,M.causes.BAD_MEDIA_DESCRIPTION);break}if(!this._createDialog(s,"UAC"))break;var f={originator:"remote",type:"answer",sdp:s.body};R.debug('emit "sdp"'),this.emit("sdp",f);var p=new RTCSessionDescription({type:"answer",sdp:f.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){if(c._connection.signalingState==="stable")return c._connection.createOffer(c._rtcOfferConstraints).then(function(g){return c._connection.setLocalDescription(g)}).catch(function(g){c._acceptAndTerminate(s,500,g.toString()),c._failed("local",s,M.causes.WEBRTC_ERROR)})}).then(function(){c._connection.setRemoteDescription(p).then(function(){c._handleSessionTimersInIncomingResponse(s),c._accepted("remote",s),c.sendRequest(M.ACK),c._confirmed("local",null)}).catch(function(g){c._acceptAndTerminate(s,488,"Not Acceptable Here"),c._failed("remote",s,M.causes.BAD_MEDIA_DESCRIPTION),R.warn('emit "peerconnection:setremotedescriptionfailed" [error:%o]',g),c.emit("peerconnection:setremotedescriptionfailed",g)})});break}default:{var v=ie.sipErrorCause(s.status_code);this._failed("remote",s,v)}}}},{key:"_sendReinvite",value:function(){var s=this,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};R.debug("sendReinvite()");var t=ie.cloneArray(c.extraHeaders),d=ie.cloneObject(c.eventHandlers),m=c.rtcOfferConstraints||this._rtcOfferConstraints||null,f=!1;t.push("Contact: ".concat(this._contact)),t.push("Content-Type: application/sdp"),this._sessionTimers.running&&t.push("Session-Expires: ".concat(this._sessionTimers.currentExpires,";refresher=").concat(this._sessionTimers.refresher?"uac":"uas")),this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return s._createLocalDescription("offer",m)}).then(function(g){g=s._mangleOffer(g);var S={originator:"local",type:"offer",sdp:g};R.debug('emit "sdp"'),s.emit("sdp",S),s.sendRequest(M.INVITE,{extraHeaders:t,body:g,eventHandlers:{onSuccessResponse:function(N){p.call(s,N),f=!0},onErrorResponse:function(N){v.call(s,N)},onTransportError:function(){s.onTransportError()},onRequestTimeout:function(){s.onRequestTimeout()},onDialogError:function(){s.onDialogError()}}})}).catch(function(){v()});function p(g){var S=this;if(this._status!==I.STATUS_TERMINATED&&(this.sendRequest(M.ACK),!f)){if(this._handleSessionTimersInIncomingResponse(g),g.body){if(!g.hasHeader("Content-Type")||g.getHeader("Content-Type").toLowerCase()!=="application/sdp"){v.call(this);return}}else{v.call(this);return}var E={originator:"remote",type:"answer",sdp:g.body};R.debug('emit "sdp"'),this.emit("sdp",E);var N=new RTCSessionDescription({type:"answer",sdp:E.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return S._connection.setRemoteDescription(N)}).then(function(){d.succeeded&&d.succeeded(g)}).catch(function(H){v.call(S),R.warn('emit "peerconnection:setremotedescriptionfailed" [error:%o]',H),S.emit("peerconnection:setremotedescriptionfailed",H)})}}function v(g){d.failed&&d.failed(g)}}},{key:"_sendUpdate",value:function(){var s=this,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};R.debug("sendUpdate()");var t=ie.cloneArray(c.extraHeaders),d=ie.cloneObject(c.eventHandlers),m=c.rtcOfferConstraints||this._rtcOfferConstraints||null,f=c.sdpOffer||!1,p=!1;t.push("Contact: ".concat(this._contact)),this._sessionTimers.running&&t.push("Session-Expires: ".concat(this._sessionTimers.currentExpires,";refresher=").concat(this._sessionTimers.refresher?"uac":"uas")),f?(t.push("Content-Type: application/sdp"),this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return s._createLocalDescription("offer",m)}).then(function(S){S=s._mangleOffer(S);var E={originator:"local",type:"offer",sdp:S};R.debug('emit "sdp"'),s.emit("sdp",E),s.sendRequest(M.UPDATE,{extraHeaders:t,body:S,eventHandlers:{onSuccessResponse:function(H){v.call(s,H),p=!0},onErrorResponse:function(H){g.call(s,H)},onTransportError:function(){s.onTransportError()},onRequestTimeout:function(){s.onRequestTimeout()},onDialogError:function(){s.onDialogError()}}})}).catch(function(){g.call(s)})):this.sendRequest(M.UPDATE,{extraHeaders:t,eventHandlers:{onSuccessResponse:function(E){v.call(s,E)},onErrorResponse:function(E){g.call(s,E)},onTransportError:function(){s.onTransportError()},onRequestTimeout:function(){s.onRequestTimeout()},onDialogError:function(){s.onDialogError()}}});function v(S){var E=this;if(this._status!==I.STATUS_TERMINATED&&!p)if(this._handleSessionTimersInIncomingResponse(S),f){if(S.body){if(!S.hasHeader("Content-Type")||S.getHeader("Content-Type").toLowerCase()!=="application/sdp"){g.call(this);return}}else{g.call(this);return}var N={originator:"remote",type:"answer",sdp:S.body};R.debug('emit "sdp"'),this.emit("sdp",N);var H=new RTCSessionDescription({type:"answer",sdp:N.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return E._connection.setRemoteDescription(H)}).then(function(){d.succeeded&&d.succeeded(S)}).catch(function(U){g.call(E),R.warn('emit "peerconnection:setremotedescriptionfailed" [error:%o]',U),E.emit("peerconnection:setremotedescriptionfailed",U)})}else d.succeeded&&d.succeeded(S)}function g(S){d.failed&&d.failed(S)}}},{key:"_acceptAndTerminate",value:function(s,c,t){R.debug("acceptAndTerminate()");var d=[];c&&(t=t||M.REASON_PHRASE[c]||"",d.push("Reason: SIP ;cause=".concat(c,'; text="').concat(t,'"'))),(this._dialog||this._createDialog(s,"UAC"))&&(this.sendRequest(M.ACK),this.sendRequest(M.BYE,{extraHeaders:d})),this._status=I.STATUS_TERMINATED}},{key:"_mangleOffer",value:function(s){if(!this._localHold&&!this._remoteHold)return s;if(s=Li.parse(s),this._localHold&&!this._remoteHold){R.debug("mangleOffer() | me on hold, mangling offer");var c=Fe(s.media),t;try{for(c.s();!(t=c.n()).done;){var d=t.value;gn.indexOf(d.type)!==-1&&(d.direction?d.direction==="sendrecv"?d.direction="sendonly":d.direction==="recvonly"&&(d.direction="inactive"):d.direction="sendonly")}}catch(E){c.e(E)}finally{c.f()}}else if(this._localHold&&this._remoteHold){R.debug("mangleOffer() | both on hold, mangling offer");var m=Fe(s.media),f;try{for(m.s();!(f=m.n()).done;){var p=f.value;gn.indexOf(p.type)!==-1&&(p.direction="inactive")}}catch(E){m.e(E)}finally{m.f()}}else if(this._remoteHold){R.debug("mangleOffer() | remote on hold, mangling offer");var v=Fe(s.media),g;try{for(v.s();!(g=v.n()).done;){var S=g.value;gn.indexOf(S.type)!==-1&&(S.direction?S.direction==="sendrecv"?S.direction="recvonly":S.direction==="recvonly"&&(S.direction="inactive"):S.direction="recvonly")}}catch(E){v.e(E)}finally{v.f()}}return Li.write(s)}},{key:"_setLocalMediaStatus",value:function(){var s=!0,c=!0;(this._localHold||this._remoteHold)&&(s=!1,c=!1),this._audioMuted&&(s=!1),this._videoMuted&&(c=!1),this._toggleMuteAudio(!s),this._toggleMuteVideo(!c)}},{key:"_handleSessionTimersInIncomingRequest",value:function(s,c){if(this._sessionTimers.enabled){var t;s.session_expires&&s.session_expires>=M.MIN_SESSION_EXPIRES?(this._sessionTimers.currentExpires=s.session_expires,t=s.session_expires_refresher||"uas"):(this._sessionTimers.currentExpires=this._sessionTimers.defaultExpires,t="uas"),c.push("Session-Expires: ".concat(this._sessionTimers.currentExpires,";refresher=").concat(t)),this._sessionTimers.refresher=t==="uas",this._runSessionTimer()}}},{key:"_handleSessionTimersInIncomingResponse",value:function(s){if(this._sessionTimers.enabled){var c;s.session_expires&&s.session_expires>=M.MIN_SESSION_EXPIRES?(this._sessionTimers.currentExpires=s.session_expires,c=s.session_expires_refresher||"uac"):(this._sessionTimers.currentExpires=this._sessionTimers.defaultExpires,c="uac"),this._sessionTimers.refresher=c==="uac",this._runSessionTimer()}}},{key:"_runSessionTimer",value:function(){var s=this,c=this._sessionTimers.currentExpires;this._sessionTimers.running=!0,clearTimeout(this._sessionTimers.timer),this._sessionTimers.refresher?this._sessionTimers.timer=setTimeout(function(){s._status!==I.STATUS_TERMINATED&&s._isReadyToReOffer()&&(R.debug("runSessionTimer() | sending session refresh request"),s._sessionTimers.refreshMethod===M.UPDATE?s._sendUpdate():s._sendReinvite())},c*500):this._sessionTimers.timer=setTimeout(function(){s._status!==I.STATUS_TERMINATED&&(R.warn("runSessionTimer() | timer expired, terminating the session"),s.terminate({cause:M.causes.REQUEST_TIMEOUT,status_code:408,reason_phrase:"Session Timer Expired"}))},c*1100)}},{key:"_toggleMuteAudio",value:function(s){var c=this._connection.getSenders().filter(function(f){return f.track&&f.track.kind==="audio"}),t=Fe(c),d;try{for(t.s();!(d=t.n()).done;){var m=d.value;m.track.enabled=!s}}catch(f){t.e(f)}finally{t.f()}}},{key:"_toggleMuteVideo",value:function(s){var c=this._connection.getSenders().filter(function(f){return f.track&&f.track.kind==="video"}),t=Fe(c),d;try{for(t.s();!(d=t.n()).done;){var m=d.value;m.track.enabled=!s}}catch(f){t.e(f)}finally{t.f()}}},{key:"_newRTCSession",value:function(s,c){R.debug("newRTCSession()"),this._ua.newRTCSession(this,{originator:s,session:this,request:c})}},{key:"_connecting",value:function(s){R.debug("session connecting"),R.debug('emit "connecting"'),this.emit("connecting",{request:s})}},{key:"_progress",value:function(s,c){R.debug("session progress"),R.debug('emit "progress"'),this.emit("progress",{originator:s,response:c||null})}},{key:"_accepted",value:function(s,c){R.debug("session accepted"),this._start_time=new Date,R.debug('emit "accepted"'),this.emit("accepted",{originator:s,response:c||null})}},{key:"_confirmed",value:function(s,c){R.debug("session confirmed"),this._is_confirmed=!0,R.debug('emit "confirmed"'),this.emit("confirmed",{originator:s,ack:c||null})}},{key:"_ended",value:function(s,c,t){R.debug("session ended"),this._end_time=new Date,this._close(),R.debug('emit "ended"'),this.emit("ended",{originator:s,message:c||null,cause:t})}},{key:"_failed",value:function(s,c,t){R.debug("session failed"),R.debug('emit "_failed"'),this.emit("_failed",{originator:s,message:c||null,cause:t}),this._close(),R.debug('emit "failed"'),this.emit("failed",{originator:s,message:c||null,cause:t})}},{key:"_onhold",value:function(s){R.debug("session onhold"),this._setLocalMediaStatus(),R.debug('emit "hold"'),this.emit("hold",{originator:s})}},{key:"_onunhold",value:function(s){R.debug("session onunhold"),this._setLocalMediaStatus(),R.debug('emit "unhold"'),this.emit("unhold",{originator:s})}},{key:"_onmute",value:function(s){var c=s.audio,t=s.video;R.debug("session onmute"),this._setLocalMediaStatus(),R.debug('emit "muted"'),this.emit("muted",{audio:c,video:t})}},{key:"_onunmute",value:function(s){var c=s.audio,t=s.video;R.debug("session onunmute"),this._setLocalMediaStatus(),R.debug('emit "unmuted"'),this.emit("unmuted",{audio:c,video:t})}},{key:"C",get:function(){return I}},{key:"causes",get:function(){return M.causes}},{key:"id",get:function(){return this._id}},{key:"connection",get:function(){return this._connection}},{key:"contact",get:function(){return this._contact}},{key:"direction",get:function(){return this._direction}},{key:"local_identity",get:function(){return this._local_identity}},{key:"remote_identity",get:function(){return this._remote_identity}},{key:"start_time",get:function(){return this._start_time}},{key:"end_time",get:function(){return this._end_time}},{key:"data",get:function(){return this._data},set:function(s){this._data=s}},{key:"status",get:function(){return this._status}}]),i}(Hf);function xn(u){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?xn=function(i){return typeof i}:xn=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},xn(u)}function Wf(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function qi(u,a){for(var i=0;i<a.length;i++){var r=a[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(u,r.key,r)}}function Vf(u,a,i){return a&&qi(u.prototype,a),i&&qi(u,i),u}function Kf(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&Xr(u,a)}function Xr(u,a){return Xr=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},Xr(u,a)}function zf(u){var a=Xf();return function(){var r=Bn(u),s;if(a){var c=Bn(this).constructor;s=Reflect.construct(r,arguments,c)}else s=r.apply(this,arguments);return Yf(this,s)}}function Yf(u,a){return a&&(xn(a)==="object"||typeof a=="function")?a:Jf(u)}function Jf(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}function Xf(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Bn(u){return Bn=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},Bn(u)}var Qf=Ze.EventEmitter,Zf=_e,Ur=he,ec=$e,Pt=ye(),tc=Jt,ji=Xe,nc=Qe(),yn=new Zf("Message"),rc=function(u){Kf(i,u);var a=zf(i);function i(r){var s;return Wf(this,i),s=a.call(this),s._ua=r,s._request=null,s._closed=!1,s._direction=null,s._local_identity=null,s._remote_identity=null,s._is_replied=!1,s._data={},s}return Vf(i,[{key:"send",value:function(s,c){var t=this,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},m=s;if(s===void 0||c===void 0)throw new TypeError("Not enough arguments");if(s=this._ua.normalizeTarget(s),!s)throw new TypeError("Invalid target: ".concat(m));var f=Pt.cloneArray(d.extraHeaders),p=Pt.cloneObject(d.eventHandlers),v=d.contentType||"text/plain",g={};d.fromUserName&&(g.from_uri=new nc("sip",d.fromUserName,this._ua.configuration.uri.host),f.push("P-Preferred-Identity: ".concat(this._ua.configuration.uri.toString()))),d.fromDisplayName&&(g.from_display_name=d.fromDisplayName);for(var S in p)Object.prototype.hasOwnProperty.call(p,S)&&this.on(S,p[S]);f.push("Content-Type: ".concat(v)),this._request=new ec.OutgoingRequest(Ur.MESSAGE,s,this._ua,g,f),c&&(this._request.body=c);var E=new tc(this._ua,this._request,{onRequestTimeout:function(){t._onRequestTimeout()},onTransportError:function(){t._onTransportError()},onReceiveResponse:function(H){t._receiveResponse(H)}});this._newMessage("local",this._request),E.send()}},{key:"init_incoming",value:function(s){this._request=s,this._newMessage("remote",s),this._is_replied||(this._is_replied=!0,s.reply(200)),this._close()}},{key:"accept",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=Pt.cloneArray(s.extraHeaders),t=s.body;if(this._direction!=="incoming")throw new ji.NotSupportedError('"accept" not supported for outgoing Message');if(this._is_replied)throw new Error("incoming Message already replied");this._is_replied=!0,this._request.reply(200,null,c,t)}},{key:"reject",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=s.status_code||480,t=s.reason_phrase,d=Pt.cloneArray(s.extraHeaders),m=s.body;if(this._direction!=="incoming")throw new ji.NotSupportedError('"reject" not supported for outgoing Message');if(this._is_replied)throw new Error("incoming Message already replied");if(c<300||c>=700)throw new TypeError("Invalid status_code: ".concat(c));this._is_replied=!0,this._request.reply(c,t,d,m)}},{key:"_receiveResponse",value:function(s){if(!this._closed)switch(!0){case/^1[0-9]{2}$/.test(s.status_code):break;case/^2[0-9]{2}$/.test(s.status_code):this._succeeded("remote",s);break;default:{var c=Pt.sipErrorCause(s.status_code);this._failed("remote",s,c);break}}}},{key:"_onRequestTimeout",value:function(){this._closed||this._failed("system",null,Ur.causes.REQUEST_TIMEOUT)}},{key:"_onTransportError",value:function(){this._closed||this._failed("system",null,Ur.causes.CONNECTION_ERROR)}},{key:"_close",value:function(){this._closed=!0,this._ua.destroyMessage(this)}},{key:"_newMessage",value:function(s,c){s==="remote"?(this._direction="incoming",this._local_identity=c.to,this._remote_identity=c.from):s==="local"&&(this._direction="outgoing",this._local_identity=c.from,this._remote_identity=c.to),this._ua.newMessage(this,{originator:s,message:this,request:c})}},{key:"_failed",value:function(s,c,t){yn.debug("MESSAGE failed"),this._close(),yn.debug('emit "failed"'),this.emit("failed",{originator:s,response:c||null,cause:t})}},{key:"_succeeded",value:function(s,c){yn.debug("MESSAGE succeeded"),this._close(),yn.debug('emit "succeeded"'),this.emit("succeeded",{originator:s,response:c})}},{key:"direction",get:function(){return this._direction}},{key:"local_identity",get:function(){return this._local_identity}},{key:"remote_identity",get:function(){return this._remote_identity}}]),i}(Qf);function Pn(u){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Pn=function(i){return typeof i}:Pn=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Pn(u)}function sc(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function Bi(u,a){for(var i=0;i<a.length;i++){var r=a[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(u,r.key,r)}}function lc(u,a,i){return a&&Bi(u.prototype,a),i&&Bi(u,i),u}function ic(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&Qr(u,a)}function Qr(u,a){return Qr=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},Qr(u,a)}function ac(u){var a=fc();return function(){var r=Gn(u),s;if(a){var c=Gn(this).constructor;s=Reflect.construct(r,arguments,c)}else s=r.apply(this,arguments);return uc(this,s)}}function uc(u,a){return a&&(Pn(a)==="object"||typeof a=="function")?a:oc(u)}function oc(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}function fc(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Gn(u){return Gn=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},Gn(u)}var cc=Ze.EventEmitter,hc=_e,Mr=he,dc=$e,Ut=ye(),_c=Jt,Gi=Xe,Tn=new hc("Options"),pc=function(u){ic(i,u);var a=ac(i);function i(r){var s;return sc(this,i),s=a.call(this),s._ua=r,s._request=null,s._closed=!1,s._direction=null,s._local_identity=null,s._remote_identity=null,s._is_replied=!1,s._data={},s}return lc(i,[{key:"send",value:function(s,c){var t=this,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},m=s;if(s===void 0)throw new TypeError("A target is required for OPTIONS");if(s=this._ua.normalizeTarget(s),!s)throw new TypeError("Invalid target: ".concat(m));var f=Ut.cloneArray(d.extraHeaders),p=Ut.cloneObject(d.eventHandlers),v=d.contentType||"application/sdp";for(var g in p)Object.prototype.hasOwnProperty.call(p,g)&&this.on(g,p[g]);f.push("Content-Type: ".concat(v)),this._request=new dc.OutgoingRequest(Mr.OPTIONS,s,this._ua,null,f),c&&(this._request.body=c);var S=new _c(this._ua,this._request,{onRequestTimeout:function(){t._onRequestTimeout()},onTransportError:function(){t._onTransportError()},onReceiveResponse:function(N){t._receiveResponse(N)}});this._newOptions("local",this._request),S.send()}},{key:"init_incoming",value:function(s){this._request=s,this._newOptions("remote",s),this._is_replied||(this._is_replied=!0,s.reply(200)),this._close()}},{key:"accept",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=Ut.cloneArray(s.extraHeaders),t=s.body;if(this._direction!=="incoming")throw new Gi.NotSupportedError('"accept" not supported for outgoing Options');if(this._is_replied)throw new Error("incoming Options already replied");this._is_replied=!0,this._request.reply(200,null,c,t)}},{key:"reject",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=s.status_code||480,t=s.reason_phrase,d=Ut.cloneArray(s.extraHeaders),m=s.body;if(this._direction!=="incoming")throw new Gi.NotSupportedError('"reject" not supported for outgoing Options');if(this._is_replied)throw new Error("incoming Options already replied");if(c<300||c>=700)throw new TypeError("Invalid status_code: ".concat(c));this._is_replied=!0,this._request.reply(c,t,d,m)}},{key:"_receiveResponse",value:function(s){if(!this._closed)switch(!0){case/^1[0-9]{2}$/.test(s.status_code):break;case/^2[0-9]{2}$/.test(s.status_code):this._succeeded("remote",s);break;default:{var c=Ut.sipErrorCause(s.status_code);this._failed("remote",s,c);break}}}},{key:"_onRequestTimeout",value:function(){this._closed||this._failed("system",null,Mr.causes.REQUEST_TIMEOUT)}},{key:"_onTransportError",value:function(){this._closed||this._failed("system",null,Mr.causes.CONNECTION_ERROR)}},{key:"_close",value:function(){this._closed=!0,this._ua.destroyMessage(this)}},{key:"_newOptions",value:function(s,c){s==="remote"?(this._direction="incoming",this._local_identity=c.to,this._remote_identity=c.from):s==="local"&&(this._direction="outgoing",this._local_identity=c.from,this._remote_identity=c.to),this._ua.newOptions(this,{originator:s,message:this,request:c})}},{key:"_failed",value:function(s,c,t){Tn.debug("OPTIONS failed"),this._close(),Tn.debug('emit "failed"'),this.emit("failed",{originator:s,response:c||null,cause:t})}},{key:"_succeeded",value:function(s,c){Tn.debug("OPTIONS succeeded"),this._close(),Tn.debug('emit "succeeded"'),this.emit("succeeded",{originator:s,response:c})}},{key:"direction",get:function(){return this._direction}},{key:"local_identity",get:function(){return this._local_identity}},{key:"remote_identity",get:function(){return this._remote_identity}}]),i}(cc),os={},vc=_e,Lr=ye(),mc=xe(),Mt=new vc("Socket");os.isSocket=function(u){if(Array.isArray(u))return!1;if(typeof u>"u")return Mt.warn("undefined JsSIP.Socket instance"),!1;try{if(!Lr.isString(u.url))throw Mt.warn("missing or invalid JsSIP.Socket url property"),new Error("Missing or invalid JsSIP.Socket url property");if(!Lr.isString(u.via_transport))throw Mt.warn("missing or invalid JsSIP.Socket via_transport property"),new Error("Missing or invalid JsSIP.Socket via_transport property");if(mc.parse(u.sip_uri,"SIP_URI")===-1)throw Mt.warn("missing or invalid JsSIP.Socket sip_uri property"),new Error("missing or invalid JsSIP.Socket sip_uri property")}catch{return!1}try{["connect","disconnect","send"].forEach(function(a){if(!Lr.isFunction(u[a]))throw Mt.warn("missing or invalid JsSIP.Socket method: ".concat(a)),new Error("Missing or invalid JsSIP.Socket method: ".concat(a))})}catch{return!1}return!0};function gc(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function Wi(u,a){for(var i=0;i<a.length;i++){var r=a[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(u,r.key,r)}}function yc(u,a,i){return a&&Wi(u.prototype,a),i&&Wi(u,i),u}var Tc=_e,Sc=os,Vi=he,ge=new Tc("Transport"),Ae={STATUS_CONNECTED:0,STATUS_CONNECTING:1,STATUS_DISCONNECTED:2,SOCKET_STATUS_READY:0,SOCKET_STATUS_ERROR:1,recovery_options:{min_interval:Vi.CONNECTION_RECOVERY_MIN_INTERVAL,max_interval:Vi.CONNECTION_RECOVERY_MAX_INTERVAL}},Ec=function(){function u(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ae.recovery_options;gc(this,u),ge.debug("new()"),this.status=Ae.STATUS_DISCONNECTED,this.socket=null,this.sockets=[],this.recovery_options=i,this.recover_attempts=0,this.recovery_timer=null,this.close_requested=!1;try{this.textDecoder=new TextDecoder("utf8")}catch(r){ge.warn("cannot use TextDecoder: ".concat(r))}if(typeof a>"u")throw new TypeError("Invalid argument. undefined 'sockets' argument");a instanceof Array||(a=[a]),a.forEach(function(r){if(!Sc.isSocket(r.socket))throw new TypeError("Invalid argument. invalid 'JsSIP.Socket' instance");if(r.weight&&!Number(r.weight))throw new TypeError("Invalid argument. 'weight' attribute is not a number");this.sockets.push({socket:r.socket,weight:r.weight||0,status:Ae.SOCKET_STATUS_READY})},this),this._getSocket()}return yc(u,[{key:"connect",value:function(){if(ge.debug("connect()"),this.isConnected()){ge.debug("Transport is already connected");return}else if(this.isConnecting()){ge.debug("Transport is connecting");return}this.close_requested=!1,this.status=Ae.STATUS_CONNECTING,this.onconnecting({socket:this.socket,attempts:this.recover_attempts}),this.close_requested||(this.socket.onconnect=this._onConnect.bind(this),this.socket.ondisconnect=this._onDisconnect.bind(this),this.socket.ondata=this._onData.bind(this),this.socket.connect())}},{key:"disconnect",value:function(){ge.debug("close()"),this.close_requested=!0,this.recover_attempts=0,this.status=Ae.STATUS_DISCONNECTED,this.recovery_timer!==null&&(clearTimeout(this.recovery_timer),this.recovery_timer=null),this.socket.onconnect=function(){},this.socket.ondisconnect=function(){},this.socket.ondata=function(){},this.socket.disconnect(),this.ondisconnect({socket:this.socket,error:!1})}},{key:"send",value:function(i){if(ge.debug("send()"),!this.isConnected())return ge.warn("unable to send message, transport is not connected"),!1;var r=i.toString();return ge.debug(`sending message:

`.concat(r,`
`)),this.socket.send(r)}},{key:"isConnected",value:function(){return this.status===Ae.STATUS_CONNECTED}},{key:"isConnecting",value:function(){return this.status===Ae.STATUS_CONNECTING}},{key:"_reconnect",value:function(){var i=this;this.recover_attempts+=1;var r=Math.floor(Math.random()*Math.pow(2,this.recover_attempts)+1);r<this.recovery_options.min_interval?r=this.recovery_options.min_interval:r>this.recovery_options.max_interval&&(r=this.recovery_options.max_interval),ge.debug("reconnection attempt: ".concat(this.recover_attempts,". next connection attempt in ").concat(r," seconds")),this.recovery_timer=setTimeout(function(){!i.close_requested&&!(i.isConnected()||i.isConnecting())&&(i._getSocket(),i.connect())},r*1e3)}},{key:"_getSocket",value:function(){var i=[];if(this.sockets.forEach(function(s){s.status!==Ae.SOCKET_STATUS_ERROR&&(i.length===0?i.push(s):s.weight>i[0].weight?i=[s]:s.weight===i[0].weight&&i.push(s))}),i.length===0){this.sockets.forEach(function(s){s.status=Ae.SOCKET_STATUS_READY}),this._getSocket();return}var r=Math.floor(Math.random()*i.length);this.socket=i[r].socket}},{key:"_onConnect",value:function(){this.recover_attempts=0,this.status=Ae.STATUS_CONNECTED,this.recovery_timer!==null&&(clearTimeout(this.recovery_timer),this.recovery_timer=null),this.onconnect({socket:this})}},{key:"_onDisconnect",value:function(i,r,s){this.status=Ae.STATUS_DISCONNECTED,this.ondisconnect({socket:this.socket,error:i,code:r,reason:s}),!this.close_requested&&(this.sockets.forEach(function(c){this.socket===c.socket&&(c.status=Ae.SOCKET_STATUS_ERROR)},this),this._reconnect(i))}},{key:"_onData",value:function(i){if(i===`\r
\r
`){ge.debug("received message with double-CRLF Keep Alive request");try{this.socket.send(`\r
`)}catch(r){ge.warn("error sending Keep Alive response: ".concat(r))}return}if(i===`\r
`){ge.debug("received message with CRLF Keep Alive response");return}else if(typeof i!="string"){try{this.textDecoder?i=this.textDecoder.decode(i):i=String.fromCharCode.apply(null,new Uint8Array(i))}catch{ge.debug("received binary message failed to be converted into string, message discarded");return}ge.debug(`received binary message:

`.concat(i,`
`))}else ge.debug(`received text message:

`.concat(i,`
`));this.ondata({transport:this,message:i})}},{key:"via_transport",get:function(){return this.socket.via_transport}},{key:"url",get:function(){return this.socket.url}},{key:"sip_uri",get:function(){return this.socket.sip_uri}}]),u}(),Ra={};function Ki(u,a){var i;if(typeof Symbol>"u"||u[Symbol.iterator]==null){if(Array.isArray(u)||(i=Cc(u))||a&&u&&typeof u.length=="number"){i&&(u=i);var r=0,s=function(){};return{s,n:function(){return r>=u.length?{done:!0}:{done:!1,value:u[r++]}},e:function(f){throw f},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c=!0,t=!1,d;return{s:function(){i=u[Symbol.iterator]()},n:function(){var f=i.next();return c=f.done,f},e:function(f){t=!0,d=f},f:function(){try{!c&&i.return!=null&&i.return()}finally{if(t)throw d}}}}function Cc(u,a){if(u){if(typeof u=="string")return zi(u,a);var i=Object.prototype.toString.call(u).slice(8,-1);if(i==="Object"&&u.constructor&&(i=u.constructor.name),i==="Map"||i==="Set")return Array.from(u);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return zi(u,a)}}function zi(u,a){(a==null||a>u.length)&&(a=u.length);for(var i=0,r=new Array(a);i<a;i++)r[i]=u[i];return r}var bc=_e,Zr=xe(),es=$e,Sn=new bc("Parser");Ra.parseMessage=function(u,a){var i,r,s=u.indexOf(`\r
`);if(s===-1){Sn.warn("parseMessage() | no CRLF found, not a SIP message");return}var c=u.substring(0,s),t=Zr.parse(c,"Request_Response");if(t===-1){Sn.warn('parseMessage() | error parsing first line of SIP message: "'.concat(c,'"'));return}else t.status_code?(i=new es.IncomingResponse,i.status_code=t.status_code,i.reason_phrase=t.reason_phrase):(i=new es.IncomingRequest(a),i.method=t.method,i.ruri=t.uri);i.data=u;for(var d=s+2;;){if(s=Ac(u,d),s===-2){r=d+2;break}else if(s===-1){Sn.warn("parseMessage() | malformed message");return}if(t=Rc(i,u,d,s),t!==!0){Sn.warn("parseMessage() |",t.error);return}d=s+2}if(i.hasHeader("content-length")){var m=i.getHeader("content-length");i.body=u.substr(r,m)}else i.body=u.substring(r);return i};function Ac(u,a){var i=a,r=0,s=0;if(u.substring(i,i+2).match(/(^\r\n)/))return-2;for(;r===0;){if(s=u.indexOf(`\r
`,i),s===-1)return s;!u.substring(s+2,s+4).match(/(^\r\n)/)&&u.charAt(s+2).match(/(^\s+)/)?i=s+2:r=s}return r}function Rc(u,a,i,r){var s,c=a.indexOf(":",i),t=a.substring(i,c).trim(),d=a.substring(c+1,r).trim();switch(t.toLowerCase()){case"via":case"v":u.addHeader("via",d),u.getHeaders("via").length===1?(s=u.parseHeader("Via"),s&&(u.via=s,u.via_branch=s.branch)):s=0;break;case"from":case"f":u.setHeader("from",d),s=u.parseHeader("from"),s&&(u.from=s,u.from_tag=s.getParam("tag"));break;case"to":case"t":u.setHeader("to",d),s=u.parseHeader("to"),s&&(u.to=s,u.to_tag=s.getParam("tag"));break;case"record-route":if(s=Zr.parse(d,"Record_Route"),s===-1)s=void 0;else{var m=Ki(s),f;try{for(m.s();!(f=m.n()).done;){var p=f.value;u.addHeader("record-route",d.substring(p.possition,p.offset)),u.headers["Record-Route"][u.getHeaders("record-route").length-1].parsed=p.parsed}}catch(E){m.e(E)}finally{m.f()}}break;case"call-id":case"i":u.setHeader("call-id",d),s=u.parseHeader("call-id"),s&&(u.call_id=d);break;case"contact":case"m":if(s=Zr.parse(d,"Contact"),s===-1)s=void 0;else{var v=Ki(s),g;try{for(v.s();!(g=v.n()).done;){var S=g.value;u.addHeader("contact",d.substring(S.possition,S.offset)),u.headers.Contact[u.getHeaders("contact").length-1].parsed=S.parsed}}catch(E){v.e(E)}finally{v.f()}}break;case"content-length":case"l":u.setHeader("content-length",d),s=u.parseHeader("content-length");break;case"content-type":case"c":u.setHeader("content-type",d),s=u.parseHeader("content-type");break;case"cseq":u.setHeader("cseq",d),s=u.parseHeader("cseq"),s&&(u.cseq=s.value),u instanceof es.IncomingResponse&&(u.method=s.method);break;case"max-forwards":u.setHeader("max-forwards",d),s=u.parseHeader("max-forwards");break;case"www-authenticate":u.setHeader("www-authenticate",d),s=u.parseHeader("www-authenticate");break;case"proxy-authenticate":u.setHeader("proxy-authenticate",d),s=u.parseHeader("proxy-authenticate");break;case"session-expires":case"x":u.setHeader("session-expires",d),s=u.parseHeader("session-expires"),s&&(u.session_expires=s.expires,u.session_expires_refresher=s.refresher);break;case"refer-to":case"r":u.setHeader("refer-to",d),s=u.parseHeader("refer-to"),s&&(u.refer_to=s);break;case"replaces":u.setHeader("replaces",d),s=u.parseHeader("replaces"),s&&(u.replaces=s);break;case"event":case"o":u.setHeader("event",d),s=u.parseHeader("event"),s&&(u.event=s);break;default:u.addHeader(t,d),s=0}return s===void 0?{error:'error parsing header "'.concat(t,'"')}:!0}function Un(u,a){var i;if(typeof Symbol>"u"||u[Symbol.iterator]==null){if(Array.isArray(u)||(i=wc(u))||a&&u&&typeof u.length=="number"){i&&(u=i);var r=0,s=function(){};return{s,n:function(){return r>=u.length?{done:!0}:{done:!1,value:u[r++]}},e:function(f){throw f},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c=!0,t=!1,d;return{s:function(){i=u[Symbol.iterator]()},n:function(){var f=i.next();return c=f.done,f},e:function(f){t=!0,d=f},f:function(){try{!c&&i.return!=null&&i.return()}finally{if(t)throw d}}}}function wc(u,a){if(u){if(typeof u=="string")return Yi(u,a);var i=Object.prototype.toString.call(u).slice(8,-1);if(i==="Object"&&u.constructor&&(i=u.constructor.name),i==="Map"||i==="Set")return Array.from(u);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Yi(u,a)}}function Yi(u,a){(a==null||a>u.length)&&(a=u.length);for(var i=0,r=new Array(a);i<a;i++)r[i]=u[i];return r}var Ic=_e,wa=he,Ji=$e,fs=ye(),cs=new Ic("sanityCheck"),Oc=[Fc],Nc=[xc,Pc,Uc,Mc],kc=[Lc,Hc],ne,ke,Ia,Dc=function(u,a,i){ne=u,ke=a,Ia=i;var r=Un(Oc),s;try{for(r.s();!(s=r.n()).done;){var c=s.value;if(c()===!1)return!1}}catch(g){r.e(g)}finally{r.f()}if(ne instanceof Ji.IncomingRequest){var t=Un(Nc),d;try{for(t.s();!(d=t.n()).done;){var m=d.value;if(m()===!1)return!1}}catch(g){t.e(g)}finally{t.f()}}else if(ne instanceof Ji.IncomingResponse){var f=Un(kc),p;try{for(f.s();!(p=f.n()).done;){var v=p.value;if(v()===!1)return!1}}catch(g){f.e(g)}finally{f.f()}}return!0};function xc(){if(ne.s("to").uri.scheme!=="sip")return $t(416),!1}function Pc(){if(!ne.to_tag&&ne.call_id.substr(0,5)===ke.configuration.jssip_id)return $t(482),!1}function Uc(){var u=fs.str_utf8_length(ne.body),a=ne.getHeader("content-length");if(u<a)return $t(400),!1}function Mc(){var u=ne.from_tag,a=ne.call_id,i=ne.cseq,r;if(!ne.to_tag)if(ne.method===wa.INVITE){if(ke._transactions.ist[ne.via_branch])return!1;for(var s in ke._transactions.ist)if(Object.prototype.hasOwnProperty.call(ke._transactions.ist,s)&&(r=ke._transactions.ist[s],r.request.from_tag===u&&r.request.call_id===a&&r.request.cseq===i))return $t(482),!1}else{if(ke._transactions.nist[ne.via_branch])return!1;for(var c in ke._transactions.nist)if(Object.prototype.hasOwnProperty.call(ke._transactions.nist,c)&&(r=ke._transactions.nist[c],r.request.from_tag===u&&r.request.call_id===a&&r.request.cseq===i))return $t(482),!1}}function Lc(){if(ne.getHeaders("via").length>1)return cs.debug("more than one Via header field present in the response, dropping the response"),!1}function Hc(){var u=fs.str_utf8_length(ne.body),a=ne.getHeader("content-length");if(u<a)return cs.debug("message body length is lower than the value in Content-Length header field, dropping the response"),!1}function Fc(){for(var u=["from","to","call_id","cseq","via"],a=0,i=u;a<i.length;a++){var r=i[a];if(!ne.hasHeader(r))return cs.debug("missing mandatory header field : ".concat(r,", dropping the response")),!1}}function $t(u){var a=ne.getHeaders("via"),i,r="SIP/2.0 ".concat(u," ").concat(wa.REASON_PHRASE[u],`\r
`),s=Un(a),c;try{for(s.s();!(c=s.n()).done;){var t=c.value;r+="Via: ".concat(t,`\r
`)}}catch(d){s.e(d)}finally{s.f()}i=ne.getHeader("To"),ne.to_tag||(i+=";tag=".concat(fs.newTag())),r+="To: ".concat(i,`\r
`),r+="From: ".concat(ne.getHeader("From"),`\r
`),r+="Call-ID: ".concat(ne.call_id,`\r
`),r+="CSeq: ".concat(ne.cseq," ").concat(ne.method,`\r
`),r+=`\r
`,Ia.send(r)}var hs={};function Xi(u,a){var i;if(typeof Symbol>"u"||u[Symbol.iterator]==null){if(Array.isArray(u)||(i=$c(u))||a&&u&&typeof u.length=="number"){i&&(u=i);var r=0,s=function(){};return{s,n:function(){return r>=u.length?{done:!0}:{done:!1,value:u[r++]}},e:function(f){throw f},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c=!0,t=!1,d;return{s:function(){i=u[Symbol.iterator]()},n:function(){var f=i.next();return c=f.done,f},e:function(f){t=!0,d=f},f:function(){try{!c&&i.return!=null&&i.return()}finally{if(t)throw d}}}}function $c(u,a){if(u){if(typeof u=="string")return Qi(u,a);var i=Object.prototype.toString.call(u).slice(8,-1);if(i==="Object"&&u.constructor&&(i=u.constructor.name),i==="Map"||i==="Set")return Array.from(u);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Qi(u,a)}}function Qi(u,a){(a==null||a>u.length)&&(a=u.length);for(var i=0,r=new Array(a);i<a;i++)r[i]=u[i];return r}var mt=ye(),ft=he,Hr=xe(),Zi=Qe(),Fr=os,$r=Xe;hs.settings={authorization_user:null,password:null,realm:null,ha1:null,authorization_jwt:null,display_name:null,uri:null,contact_uri:null,instance_id:null,use_preloaded_route:!1,session_timers:!0,session_timers_refresh_method:ft.UPDATE,session_timers_force_refresher:!1,no_answer_timeout:60,register:!0,register_expires:600,registrar_server:null,sockets:null,connection_recovery_max_interval:ft.CONNECTION_RECOVERY_MAX_INTERVAL,connection_recovery_min_interval:ft.CONNECTION_RECOVERY_MIN_INTERVAL,extra_headers:null,via_host:"".concat(mt.createRandomToken(12),".invalid")};var En={mandatory:{sockets:function(a){var i=[];if(Fr.isSocket(a))i.push({socket:a});else if(Array.isArray(a)&&a.length){var r=Xi(a),s;try{for(r.s();!(s=r.n()).done;){var c=s.value;Object.prototype.hasOwnProperty.call(c,"socket")&&Fr.isSocket(c.socket)?i.push(c):Fr.isSocket(c)&&i.push({socket:c})}}catch(t){r.e(t)}finally{r.f()}}else return;return i},uri:function(a){/^sip:/i.test(a)||(a="".concat(ft.SIP,":").concat(a));var i=Zi.parse(a);if(i)return i.user?i:void 0}},optional:{authorization_user:function(a){if(Hr.parse('"'.concat(a,'"'),"quoted_string")!==-1)return a},authorization_jwt:function(a){if(typeof a=="string")return a},user_agent:function(a){if(typeof a=="string")return a},connection_recovery_max_interval:function(a){if(mt.isDecimal(a)){var i=Number(a);if(i>0)return i}},connection_recovery_min_interval:function(a){if(mt.isDecimal(a)){var i=Number(a);if(i>0)return i}},contact_uri:function(a){if(typeof a=="string"){var i=Hr.parse(a,"SIP_URI");if(i!==-1)return i}},display_name:function(a){return a},instance_id:function(a){if(/^uuid:/i.test(a)&&(a=a.substr(5)),Hr.parse(a,"uuid")!==-1)return a},no_answer_timeout:function(a){if(mt.isDecimal(a)){var i=Number(a);if(i>0)return i}},session_timers:function(a){if(typeof a=="boolean")return a},session_timers_refresh_method:function(a){if(typeof a=="string"&&(a=a.toUpperCase(),a===ft.INVITE||a===ft.UPDATE))return a},session_timers_force_refresher:function(a){if(typeof a=="boolean")return a},password:function(a){return String(a)},realm:function(a){return String(a)},ha1:function(a){return String(a)},register:function(a){if(typeof a=="boolean")return a},register_expires:function(a){if(mt.isDecimal(a)){var i=Number(a);if(i>0)return i}},registrar_server:function(a){/^sip:/i.test(a)||(a="".concat(ft.SIP,":").concat(a));var i=Zi.parse(a);if(i)return i.user?void 0:i},use_preloaded_route:function(a){if(typeof a=="boolean")return a},extra_headers:function(a){var i=[];if(Array.isArray(a)&&a.length){var r=Xi(a),s;try{for(r.s();!(s=r.n()).done;){var c=s.value;typeof c=="string"&&i.push(c)}}catch(t){r.e(t)}finally{r.f()}}else return;return i}}};hs.load=function(u,a){for(var i in En.mandatory)if(a.hasOwnProperty(i)){var r=a[i],s=En.mandatory[i](r);if(s!==void 0)u[i]=s;else throw new $r.ConfigurationError(i,r)}else throw new $r.ConfigurationError(i);for(var c in En.optional)if(a.hasOwnProperty(c)){var t=a[c];if(mt.isEmpty(t))continue;var d=En.optional[c](t);if(d!==void 0)u[c]=d;else throw new $r.ConfigurationError(c,t)}};function Mn(u){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Mn=function(i){return typeof i}:Mn=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Mn(u)}function qc(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function ea(u,a){for(var i=0;i<a.length;i++){var r=a[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(u,r.key,r)}}function ta(u,a,i){return a&&ea(u.prototype,a),i&&ea(u,i),u}function jc(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&ts(u,a)}function ts(u,a){return ts=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},ts(u,a)}function Bc(u){var a=Wc();return function(){var r=Wn(u),s;if(a){var c=Wn(this).constructor;s=Reflect.construct(r,arguments,c)}else s=r.apply(this,arguments);return Gc(this,s)}}function Gc(u,a){return a&&(Mn(a)==="object"||typeof a=="function")?a:Oa(u)}function Oa(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}function Wc(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Wn(u){return Wn=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},Wn(u)}var Vc=Ze.EventEmitter,Kc=_e,pe=he,zc=Po,na=Gf,ra=rc,sa=pc,qr=Yt,Yc=Ec,Cn=ye(),Jc=Xe,Xc=Qe(),Qc=Ra,jr=$e,Zc=Dc,Br=hs,se=new Kc("UA"),ve={STATUS_INIT:0,STATUS_READY:1,STATUS_USER_CLOSED:2,STATUS_NOT_READY:3,CONFIGURATION_ERROR:1,NETWORK_ERROR:2},eh=function(u){jc(i,u);var a=Bc(i);ta(i,null,[{key:"C",get:function(){return ve}}]);function i(r){var s;if(qc(this,i),se.debug("new() [configuration:%o]",r),s=a.call(this),s._cache={credentials:{}},s._configuration=Object.assign({},Br.settings),s._dynConfiguration={},s._dialogs={},s._applicants={},s._sessions={},s._transport=null,s._contact=null,s._status=ve.STATUS_INIT,s._error=null,s._transactions={nist:{},nict:{},ist:{},ict:{}},s._data={},s._closeTimer=null,r===void 0)throw new TypeError("Not enough arguments");try{s._loadConfig(r)}catch(c){throw s._status=ve.STATUS_NOT_READY,s._error=ve.CONFIGURATION_ERROR,c}return s._registrator=new zc(Oa(s)),s}return ta(i,[{key:"start",value:function(){se.debug("start()"),this._status===ve.STATUS_INIT?this._transport.connect():this._status===ve.STATUS_USER_CLOSED?(se.debug("restarting UA"),this._closeTimer!==null&&(clearTimeout(this._closeTimer),this._closeTimer=null,this._transport.disconnect()),this._status=ve.STATUS_INIT,this._transport.connect()):this._status===ve.STATUS_READY?se.debug("UA is in READY status, not restarted"):se.debug("ERROR: connection is down, Auto-Recovery system is trying to reconnect"),this._dynConfiguration.register=this._configuration.register}},{key:"register",value:function(){se.debug("register()"),this._dynConfiguration.register=!0,this._registrator.register()}},{key:"unregister",value:function(s){se.debug("unregister()"),this._dynConfiguration.register=!1,this._registrator.unregister(s)}},{key:"registrator",value:function(){return this._registrator}},{key:"isRegistered",value:function(){return this._registrator.registered}},{key:"isConnected",value:function(){return this._transport.isConnected()}},{key:"call",value:function(s,c){se.debug("call()");var t=new na(this);return t.connect(s,c),t}},{key:"sendMessage",value:function(s,c,t){se.debug("sendMessage()");var d=new ra(this);return d.send(s,c,t),d}},{key:"sendOptions",value:function(s,c,t){se.debug("sendOptions()");var d=new sa(this);return d.send(s,c,t),d}},{key:"terminateSessions",value:function(s){se.debug("terminateSessions()");for(var c in this._sessions)this._sessions[c].isEnded()||this._sessions[c].terminate(s)}},{key:"stop",value:function(){var s=this;if(se.debug("stop()"),this._dynConfiguration={},this._status===ve.STATUS_USER_CLOSED){se.debug("UA already closed");return}this._registrator.close();var c=Object.keys(this._sessions).length;for(var t in this._sessions)if(Object.prototype.hasOwnProperty.call(this._sessions,t)){se.debug("closing session ".concat(t));try{this._sessions[t].terminate()}catch{}}for(var d in this._applicants)if(Object.prototype.hasOwnProperty.call(this._applicants,d))try{this._applicants[d].close()}catch{}this._status=ve.STATUS_USER_CLOSED;var m=Object.keys(this._transactions.nict).length+Object.keys(this._transactions.nist).length+Object.keys(this._transactions.ict).length+Object.keys(this._transactions.ist).length;m===0&&c===0?this._transport.disconnect():this._closeTimer=setTimeout(function(){s._closeTimer=null,s._transport.disconnect()},2e3)}},{key:"normalizeTarget",value:function(s){return Cn.normalizeTarget(s,this._configuration.hostport_params)}},{key:"get",value:function(s){switch(s){case"authorization_user":return this._configuration.authorization_user;case"realm":return this._configuration.realm;case"ha1":return this._configuration.ha1;case"authorization_jwt":return this._configuration.authorization_jwt;default:se.warn('get() | cannot get "%s" parameter in runtime',s);return}}},{key:"set",value:function(s,c){switch(s){case"authorization_user":{this._configuration.authorization_user=String(c);break}case"password":{this._configuration.password=String(c);break}case"realm":{this._configuration.realm=String(c);break}case"ha1":{this._configuration.ha1=String(c),this._configuration.password=null;break}case"authorization_jwt":{this._configuration.authorization_jwt=String(c);break}case"display_name":{this._configuration.display_name=c;break}case"extra_headers":{this._configuration.extra_headers=c;break}default:return se.warn('set() | cannot set "%s" parameter in runtime',s),!1}return!0}},{key:"newTransaction",value:function(s){this._transactions[s.type][s.id]=s,this.emit("newTransaction",{transaction:s})}},{key:"destroyTransaction",value:function(s){delete this._transactions[s.type][s.id],this.emit("transactionDestroyed",{transaction:s})}},{key:"newDialog",value:function(s){this._dialogs[s.id]=s}},{key:"destroyDialog",value:function(s){delete this._dialogs[s.id]}},{key:"newMessage",value:function(s,c){this._applicants[s]=s,this.emit("newMessage",c)}},{key:"newOptions",value:function(s,c){this._applicants[s]=s,this.emit("newOptions",c)}},{key:"destroyMessage",value:function(s){delete this._applicants[s]}},{key:"newRTCSession",value:function(s,c){this._sessions[s.id]=s,this.emit("newRTCSession",c)}},{key:"destroyRTCSession",value:function(s){delete this._sessions[s.id]}},{key:"registered",value:function(s){this.emit("registered",s)}},{key:"unregistered",value:function(s){this.emit("unregistered",s)}},{key:"registrationFailed",value:function(s){this.emit("registrationFailed",s)}},{key:"receiveRequest",value:function(s){var c=s.method;if(s.ruri.user!==this._configuration.uri.user&&s.ruri.user!==this._contact.uri.user){se.debug("Request-URI does not point to us"),s.method!==pe.ACK&&s.reply_sl(404);return}if(s.ruri.scheme===pe.SIPS){s.reply_sl(416);return}if(!qr.checkTransaction(this,s)){if(c===pe.INVITE?new qr.InviteServerTransaction(this,this._transport,s):c!==pe.ACK&&c!==pe.CANCEL&&new qr.NonInviteServerTransaction(this,this._transport,s),c===pe.OPTIONS){if(this.listeners("newOptions").length===0){s.reply(200);return}var t=new sa(this);t.init_incoming(s)}else if(c===pe.MESSAGE){if(this.listeners("newMessage").length===0){s.reply(405);return}var d=new ra(this);d.init_incoming(s)}else if(c===pe.INVITE&&!s.to_tag&&this.listeners("newRTCSession").length===0){s.reply(405);return}var m,f;if(s.to_tag)m=this._findDialog(s.call_id,s.from_tag,s.to_tag),m?m.receiveRequest(s):c===pe.NOTIFY?(f=this._findSession(s),f?f.receiveRequest(s):(se.debug("received NOTIFY request for a non existent subscription"),s.reply(481,"Subscription does not exist"))):c!==pe.ACK&&s.reply(481);else switch(c){case pe.INVITE:if(window.RTCPeerConnection)if(s.hasHeader("replaces")){var p=s.replaces;m=this._findDialog(p.call_id,p.from_tag,p.to_tag),m?(f=m.owner,f.isEnded()?s.reply(603):f.receiveRequest(s)):s.reply(481)}else f=new na(this),f.init_incoming(s);else se.warn("INVITE received but WebRTC is not supported"),s.reply(488);break;case pe.BYE:s.reply(481);break;case pe.CANCEL:f=this._findSession(s),f?f.receiveRequest(s):se.debug("received CANCEL request for a non existent session");break;case pe.ACK:break;case pe.NOTIFY:this.emit("sipEvent",{event:s.event,request:s}),s.reply(200);break;default:s.reply(405);break}}}},{key:"_findSession",value:function(s){var c=s.call_id,t=s.from_tag,d=s.to_tag,m=c+t,f=this._sessions[m],p=c+d,v=this._sessions[p];return f||v||null}},{key:"_findDialog",value:function(s,c,t){var d=s+c+t,m=this._dialogs[d];return m||(d=s+t+c,m=this._dialogs[d],m||null)}},{key:"_loadConfig",value:function(s){try{Br.load(this._configuration,s)}catch(p){throw p}this._configuration.display_name===0&&(this._configuration.display_name="0"),this._configuration.instance_id||(this._configuration.instance_id=Cn.newUUID()),this._configuration.jssip_id=Cn.createRandomToken(5);var c=this._configuration.uri.clone();c.user=null,this._configuration.hostport_params=c.toString().replace(/^sip:/i,"");try{this._transport=new Yc(this._configuration.sockets,{max_interval:this._configuration.connection_recovery_max_interval,min_interval:this._configuration.connection_recovery_min_interval}),this._transport.onconnecting=th.bind(this),this._transport.onconnect=nh.bind(this),this._transport.ondisconnect=rh.bind(this),this._transport.ondata=sh.bind(this)}catch(p){throw se.warn(p),new Jc.ConfigurationError("sockets",this._configuration.sockets)}if(delete this._configuration.sockets,this._configuration.authorization_user||(this._configuration.authorization_user=this._configuration.uri.user),!this._configuration.registrar_server){var t=this._configuration.uri.clone();t.user=null,t.clearParams(),t.clearHeaders(),this._configuration.registrar_server=t}this._configuration.no_answer_timeout*=1e3,this._configuration.contact_uri?this._configuration.via_host=this._configuration.contact_uri.host:this._configuration.contact_uri=new Xc("sip",Cn.createRandomToken(8),this._configuration.via_host,null,{transport:"ws"}),this._contact={pub_gruu:null,temp_gruu:null,uri:this._configuration.contact_uri,toString:function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=v.anonymous||null,S=v.outbound||null,E="<";return g?E+=this.temp_gruu||"sip:anonymous@anonymous.invalid;transport=ws":E+=this.pub_gruu||this.uri.toString(),S&&(g?!this.temp_gruu:!this.pub_gruu)&&(E+=";ob"),E+=">",E}};var d=["authorization_user","password","realm","ha1","authorization_jwt","display_name","register","extra_headers"];for(var m in this._configuration)Object.prototype.hasOwnProperty.call(this._configuration,m)&&(d.indexOf(m)!==-1?Object.defineProperty(this._configuration,m,{writable:!0,configurable:!1}):Object.defineProperty(this._configuration,m,{writable:!1,configurable:!1}));se.debug("configuration parameters after validation:");for(var f in this._configuration)if(Object.prototype.hasOwnProperty.call(Br.settings,f))switch(f){case"uri":case"registrar_server":se.debug("- ".concat(f,": ").concat(this._configuration[f]));break;case"password":case"ha1":case"authorization_jwt":se.debug("- ".concat(f,": NOT SHOWN"));break;default:se.debug("- ".concat(f,": ").concat(JSON.stringify(this._configuration[f])))}}},{key:"C",get:function(){return ve}},{key:"status",get:function(){return this._status}},{key:"contact",get:function(){return this._contact}},{key:"configuration",get:function(){return this._configuration}},{key:"transport",get:function(){return this._transport}}]),i}(Vc);function th(u){this.emit("connecting",u)}function nh(u){this._status!==ve.STATUS_USER_CLOSED&&(this._status=ve.STATUS_READY,this._error=null,this.emit("connected",u),this._dynConfiguration.register&&this._registrator.register())}function rh(u){for(var a=["nict","ict","nist","ist"],i=0,r=a;i<r.length;i++){var s=r[i];for(var c in this._transactions[s])Object.prototype.hasOwnProperty.call(this._transactions[s],c)&&this._transactions[s][c].onTransportError()}this.emit("disconnected",u),this._registrator.onTransportClosed(),this._status!==ve.STATUS_USER_CLOSED&&(this._status=ve.STATUS_NOT_READY,this._error=ve.NETWORK_ERROR)}function sh(u){var a=u.transport,i=u.message;if(i=Qc.parseMessage(i,this),!!i&&!(this._status===ve.STATUS_USER_CLOSED&&i instanceof jr.IncomingRequest)&&Zc(i,this,a)){if(i instanceof jr.IncomingRequest)i.transport=a,this.receiveRequest(i);else if(i instanceof jr.IncomingResponse){var r;switch(i.method){case pe.INVITE:r=this._transactions.ict[i.via_branch],r&&r.receiveResponse(i);break;case pe.ACK:break;default:r=this._transactions.nict[i.via_branch],r&&r.receiveResponse(i);break}}}}function lh(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")}function la(u,a){for(var i=0;i<a.length;i++){var r=a[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(u,r.key,r)}}function ih(u,a,i){return a&&la(u.prototype,a),i&&la(u,i),u}var ah=_e,uh=xe(),Te=new ah("WebSocketInterface"),oh=function(){function u(a){lh(this,u),Te.debug('new() [url:"%s"]',a),this._url=a,this._sip_uri=null,this._via_transport=null,this._ws=null;var i=uh.parse(a,"absoluteURI");if(i===-1)throw Te.warn("invalid WebSocket URI: ".concat(a)),new TypeError("Invalid argument: ".concat(a));if(i.scheme!=="wss"&&i.scheme!=="ws")throw Te.warn("invalid WebSocket URI scheme: ".concat(i.scheme)),new TypeError("Invalid argument: ".concat(a));this._sip_uri="sip:".concat(i.host).concat(i.port?":".concat(i.port):"",";transport=ws"),this._via_transport=i.scheme.toUpperCase()}return ih(u,[{key:"connect",value:function(){if(Te.debug("connect()"),this.isConnected()){Te.debug("WebSocket ".concat(this._url," is already connected"));return}else if(this.isConnecting()){Te.debug("WebSocket ".concat(this._url," is connecting"));return}this._ws&&this.disconnect(),Te.debug("connecting to WebSocket ".concat(this._url));try{this._ws=new WebSocket(this._url,"sip"),this._ws.binaryType="arraybuffer",this._ws.onopen=this._onOpen.bind(this),this._ws.onclose=this._onClose.bind(this),this._ws.onmessage=this._onMessage.bind(this),this._ws.onerror=this._onError.bind(this)}catch(i){this._onError(i)}}},{key:"disconnect",value:function(){Te.debug("disconnect()"),this._ws&&(this._ws.onopen=function(){},this._ws.onclose=function(){},this._ws.onmessage=function(){},this._ws.onerror=function(){},this._ws.close(),this._ws=null)}},{key:"send",value:function(i){return Te.debug("send()"),this.isConnected()?(this._ws.send(i),!0):(Te.warn("unable to send message, WebSocket is not open"),!1)}},{key:"isConnected",value:function(){return this._ws&&this._ws.readyState===this._ws.OPEN}},{key:"isConnecting",value:function(){return this._ws&&this._ws.readyState===this._ws.CONNECTING}},{key:"_onOpen",value:function(){Te.debug("WebSocket ".concat(this._url," connected")),this.onconnect()}},{key:"_onClose",value:function(i){var r=i.wasClean,s=i.code,c=i.reason;Te.debug("WebSocket ".concat(this._url," closed")),r===!1&&Te.debug("WebSocket abrupt disconnection"),this.ondisconnect(!r,s,c)}},{key:"_onMessage",value:function(i){var r=i.data;Te.debug("received WebSocket message"),this.ondata(r)}},{key:"_onError",value:function(i){Te.warn("WebSocket ".concat(this._url," error: "),i)}},{key:"via_transport",get:function(){return this._via_transport},set:function(i){this._via_transport=i.toUpperCase()}},{key:"sip_uri",get:function(){return this._sip_uri}},{key:"url",get:function(){return this._url}}]),u}(),ns=ua,fh=he,ch=Xe,hh=ye(),dh=eh,_h=Qe(),ph=rs(),vh=xe(),mh=oh,gh=ls("JsSIP");gh("version %s",ns.version);var yh={C:fh,Exceptions:ch,Utils:hh,UA:dh,URI:_h,NameAddrHeader:ph,WebSocketInterface:mh,Grammar:vh,debug:ls,get name(){return ns.title},get version(){return ns.version}};const ia=vu(yh),Th=()=>{const u=document.getElementById("registerForm"),a=document.getElementById("username"),i=document.getElementById("password"),r=document.getElementById("server"),s=document.getElementById("status"),c=(t,d,m)=>{let f;const v={sockets:[new ia.WebSocketInterface(`wss://${m}`)],uri:`sip:${t}@${m}`,password:d};f=new ia.UA(v),f.on("registrationFailed",()=>{console.log("Registration failed"),s.innerHTML="Registration failed"}),f.on("connected",()=>{console.log("Connected"),s.innerHTML="Connected"}),f.on("registered",()=>{console.log("Registered"),s.innerHTML="Registered",chrome.storage.session.set({registered:!0}).then(()=>{console.log("Value is set")})}),f.on("disconnected",g=>{console.log("disconnected",g)}),f.on("newRTCSession",g=>{console.log("newRTCSession",g)}),f.start()};u.addEventListener("submit",t=>{t.preventDefault();const d=a.value,m=i.value,f=r.value;d&&m&&f?c(d,m,f):s.innerHTML="Заполните все поля"})};document.getElementById("content");const Sh=document.getElementById("dialerBtn"),Eh=document.getElementById("callHistoryBtn");Sh.addEventListener("click",()=>qt("/dialer.html",aa));Eh.addEventListener("click",()=>qt("/callHistory.html",pu));qt("/login.html",Th);
